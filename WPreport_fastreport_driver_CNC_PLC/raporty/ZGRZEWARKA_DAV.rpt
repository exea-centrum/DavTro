[Record REPORT]
[CODE=ZGRZEWARKA_DAV]
[C]code=ZGRZEWARKA_DAV
[M]design=10154
<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.9" DotMatrixReport="false" EngineOptions.DoublePass="true" IniFile="\Software\Fast Reports" PreviewOptions.AllowEdit="false" PreviewOptions.Buttons="4089" PreviewOptions.Zoom="1" PrintOptions.Printer="Domyœlny" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40694,8395332292" ReportOptions.Description.Text="" ReportOptions.Name="ZGRZEWARKA_DAV" ReportOptions.LastChange="40694,8395332292" ScriptLanguage="PascalScript" ScriptText.Text="begin&#13;&#10;// blok danych ustalaj¹cych zmienne globalne&#13;&#10;linia1 := '';&#13;&#10;IDZlecenia := 0;&#13;&#10;IDPatyka := 0;&#13;&#10;lp := 1;&#13;&#10;GzieSlupek := 0;&#13;&#10;PozycjaSlupek := 0;&#13;&#10;OsSlupek := 0;&#13;&#10;SzerSlupek := 0;&#13;&#10;UstalonySlupek := 0;&#13;&#10;NumerSkrzydla := 0;&#13;&#10;ProfilSlupek := '';&#13;&#10;x := 0;&#13;&#10;y := 0;&#13;&#10;Zgar := 6; //UWAGA! nale¿y pamiêtaæ o zmianie tego wymiaru w przypadklu ustalenia innej wartoœci naddatku na zgrzew&#13;&#10;OsadzenieSlupka := 0; // UWAGA! Ten parametr nale¿y zmieniæ w przypadku innej technoligii osadzenia s³upka&#13;&#10;end&#13;&#10;//////////////////////&#13;&#10;// uzupe³niæ wartoœc linia1:=linia1 + 'KTN' by dodawa³o kolejne rekordy do pilku.&#13;&#10;&#13;&#10;//BLOK G£ÓWNYCH DANYCH&#13;&#10;&#13;&#10;begin &#13;&#10;//zmienne&#13;&#10;&#13;&#10;OsSlupka := 0;&#13;&#10;SzerokoscSlupka := 0;&#13;&#10;i := 1;&#13;&#10;&#13;&#10;//Instrukcja okreœlaj¹ca nr skrzyd³a w oknach wieloskrzyd³owych&#13;&#10;     PozSkrzydla := [AKS.&#34;ouvrant&#34;];&#13;&#10;     if PozSkrzydla = -1 then&#13;&#10;       begin&#13;&#10;         PozSkrzydla := 0&#13;&#10;       end&#13;&#10;     else&#13;&#10;       begin&#13;&#10;         PozSkrzydla := [AKS.&#34;ouvrant&#34;]&#13;&#10;       end;&#13;&#10;&#13;&#10;// Instrukcje okreœlaj¹ce po³o¿enie patyka w oknie&#13;&#10;     if [AKS.&#34;position&#34;] = '1' then PolozenieWOknie := 'LI';&#13;&#10;     if [AKS.&#34;position&#34;] = '2' then PolozenieWOknie := 'RE';&#13;&#10;     if [AKS.&#34;position&#34;] = '3' then PolozenieWOknie := 'OB';&#13;&#10;     if [AKS.&#34;position&#34;] = '4' then PolozenieWOknie := 'UN';&#13;&#10;     if [AKS.&#34;position&#34;] = '5' then PolozenieWOknie := 'Se';&#13;&#10;     if [AKS.&#34;position&#34;] = '6' then PolozenieWOknie := 'WA';&#13;&#10;&#13;&#10;if [AKS.&#34;position&#34;] = '4' then&#13;&#10;begin&#13;&#10;// Instukcja przydzielaj¹ca k¹ty dla skrzyd³a (type=2) i oœce¿nicy (type=1)&#13;&#10;     if [AKS.&#34;type&#34;] = 2 then&#13;&#10;      begin&#13;&#10;       KatOgolny1 := 135;&#13;&#10;       KatOgolny2 := 135;&#13;&#10;      end&#13;&#10;     else if [AKS.&#34;type&#34;] = 1 then&#13;&#10;      begin&#13;&#10;       KatOgolny1 := [AKS.&#34;angle1&#34;];&#13;&#10;       KatOgolny2 := [AKS.&#34;angle2&#34;]&#13;&#10;      end;&#13;&#10;&#13;&#10;// Instukcje dla danych tekstowych uzupe³nianych znakami spacji&#13;&#10;&#13;&#10;//Nazwa Zlecenia&#13;&#10;   Zlecenie := copy([AKS.&#34;commande&#34;],5,7);&#13;&#10;   DlugoscTekstu := length(Zlecenie);&#13;&#10;   for i := DlugoscTekstu + 1 to 7 do Zlecenie := Zlecenie + ' ';&#13;&#10;//Nazwa pozycji w ofercie/zleceniu&#13;&#10;   NazwaPOzycji := copy([AKS.&#34;chassis&#34;],1,5);&#13;&#10;   DlugoscTekstu := length(NazwaPOzycji);&#13;&#10;   for i := DlugoscTekstu + 1 to 5 do NazwaPOzycji := NazwaPOzycji + ' ';&#13;&#10;//Kod profila&#13;&#10;   KodProfila := copy([AKS.&#34;profil&#34;],1,6);&#13;&#10;   //zamiana indeksu profilu&#13;&#10;        //if KodProfila = '616130' then KodProfila := '616100';&#13;&#10;        //if KodProfila = '610130' then KodProfila := '616100';&#13;&#10;        //if KodProfila = '626640' then KodProfila := '626600';&#13;&#10;        //if KodProfila = '626740' then KodProfila := '626700';&#13;&#10;        //if KodProfila = '622140' then KodProfila := '612100';&#13;&#10;        //if KodProfila = '622240' then KodProfila := '612200';&#13;&#10;        //if KodProfila = '622340' then KodProfila := '612300';&#13;&#10;   DlugoscTekstu := length(KodProfila);&#13;&#10;   for i := DlugoscTekstu + 1 to 6 do KodProfila := KodProfila + ' ';&#13;&#10;//Kolor&#13;&#10;   Kolor := copy(str([AKS.&#34;teinteext&#34;]),1,20);&#13;&#10;   DlugoscTekstu := length(Kolor);&#13;&#10;   for i := DlugoscTekstu + 1 to 20 do Kolor := Kolor + ' ';&#13;&#10;//Nazwa stali (wzmocnienia)&#13;&#10;   Wzmocnienie := copy([AKS.&#34;renfort&#34;],1,8);&#13;&#10;   DlugoscTekstu := length(Wzmocnienie);&#13;&#10;   for i := DlugoscTekstu + 1 to 8 do Wzmocnienie := Wzmocnienie + ' ';&#13;&#10;//Naza profila (opis)&#13;&#10;   NazwaPofila := copy([AKS.&#34;descriptio&#34;],1,20);&#13;&#10;   DlugoscTekstu := length(NazwaPofila);&#13;&#10;   for i := DlugoscTekstu + 1 to 20 do NazwaPofila := NazwaPofila + ' ';&#13;&#10;//Producent profila&#13;&#10;   PorducentProfila := copy([AKS.&#34;codefou&#34;],1,20);&#13;&#10;   DlugoscTekstu := length(PorducentProfila);&#13;&#10;   for i := DlugoscTekstu + 1 to 20 do PorducentProfila := PorducentProfila + ' ';&#13;&#10;//Kod kreskowy&#13;&#10;   KodKreskowy := copy([AKS.&#34;codebarre&#34;],1,10);&#13;&#10;   //DlugoscTekstu := length(KodKreskowy);&#13;&#10;   //for i := DlugoscTekstu + 1 to 15 do KodKreskowy := '1' + KodKreskowy;&#13;&#10;//Numer pozycji okna;&#13;&#10;   Pozycja := copy([AKS.&#34;chassis&#34;],1,9);&#13;&#10;   DlugoscTekstu := length(Pozycja);&#13;&#10;   for i := DlugoscTekstu + 1 to 9 do Pozycja := Pozycja + ' ';&#13;&#10;&#13;&#10;IDZlecenia := [AKS.&#34;chassis&#34;];&#13;&#10;IDPatyka := [AKS.&#34;ligne&#34;];&#13;&#10;&#13;&#10;wysokosc := [AKS.&#34;hcadre&#34;];&#13;&#10;szerokosc := [AKS.&#34;lcadre&#34;];&#13;&#10;// zamieniamy szerokoœæ z wysokoœci¹ tak aby dluzszy kawa³ek byl zawsze jako szerokosc&#13;&#10;if wysokosc &#62; szerokosc then&#13;&#10;   begin&#13;&#10;        szerokosc := [AKS.&#34;hcadre&#34;];&#13;&#10;        wysokosc := [AKS.&#34;lcadre&#34;];&#13;&#10;   end;&#13;&#10;&#13;&#10;//BLOK POBIERAJ¥CY DANE DO ZMIENNEJ linia1&#13;&#10;&#13;&#10;linia1 := linia1 + KodKreskowy + formatfloat('0000',szerokosc) + formatfloat('0000',wysokosc) + KodProfila;&#13;&#10;linia1 := linia1 + Zlecenie + ' PO:' + Pozycja + ' ' + CRLF;&#13;&#10;&#13;&#10;end;&#13;&#10;//linia1 := linia1 + 'KTN' + formatfloat('0000', lp) + 'C00F000000K' + Zlecenie + 'P' + NazwaPOzycji + 'E' + formatfloat('00', PozSkrzydla);&#13;&#10;//linia1 := linia1 + 'T' + KodProfila + 'V' + Kolor + 'I' + Wzmocnienie + 'M' + formatfloat('00000', [AKS.&#34;dimrenfort&#34;]*10);&#13;&#10;//linia1 := linia1 + 'D0 ' + 'U' + PolozenieWOknie + 'A00' + 'L'  + formatfloat('00000',[AKS.&#34;dim&#34;]*10);&#13;&#10;//linia1 := linia1 + 'G' + formatfloat('0000',KatOgolny1*10) + formatfloat('0000',KatOgolny2*10) + 'J' + formatfloat('0000',KatOgolny1*10);&#13;&#10;//linia1 := linia1 + formatfloat('0000',KatOgolny2*10) + 'B' + NazwaPofila + 'H' + PorducentProfila + 'O' + KodKreskowy + 'SN+000N+000' + CRLF;&#13;&#10;&#13;&#10;//BLOK DANYCH OBRÓBEK&#13;&#10;&#13;&#10;&#13;&#10; // messagebox(DlugoscTekstu,'tytu³',mb_OK);&#13;&#10;//KONIEC G£ÓWNEGO BLOKU DANYCH&#13;&#10;end&#13;&#10;&#13;&#10;&#13;&#10;/////////////////&#13;&#10;begin&#13;&#10; raport := IniReadString('.\\production.ini', 'Directories:AKS','');&#13;&#10; PlikTxt := raport + Trim([AKS.&#34;code&#34;]) + '.aks';&#13;&#10; SaveToFile(PlikTxt, linia1);&#13;&#10; messagebox('Sterownik AKS gotowy dla partii: ' + Trim([AKS.&#34;code&#34;]),'tytu³',mb_OK);&#13;&#10; //messagebox(test1,'tytu³',mb_OK);&#13;&#10;end&#13;&#10;  &#13;&#10;//begin&#13;&#10;&#13;&#10;//end." StoreInDFM="false" PropData="044C65667403D10203546F70031B0108446174617365747301010C2700000020446174615365743D225F5175657279312220446174615365744E616D653D22517565727931220000095661726961626C657301010C10000000204E616D653D2220436861727365742200010C1E000000204E616D653D22414E53495F43484152534554222056616C75653D22302200010C21000000204E616D653D2244454641554C545F43484152534554222056616C75653D22312200010C20000000204E616D653D2253594D424F4C5F43484152534554222056616C75653D22322200010C1E000000204E616D653D224D41435F43484152534554222056616C75653D2237372200010C23000000204E616D653D2253484946544A495F43484152534554222056616C75653D223132382200010C23000000204E616D653D2248414E4745554C5F43484152534554222056616C75653D223132392200010C22000000204E616D653D2248414E47554C5F43484152534554222056616C75653D223132392200010C21000000204E616D653D224A4F4841425F43484152534554222056616C75653D223133302200010C22000000204E616D653D224742323331325F43484152534554222056616C75653D223133342200010C27000000204E616D653D224348494E455345424947355F43484152534554222056616C75653D223133362200010C21000000204E616D653D22475245454B5F43484152534554222056616C75653D223136312200010C23000000204E616D653D225455524B4953485F43484152534554222056616C75653D223136322200010C26000000204E616D653D22564945544E414D4553455F43484152534554222056616C75653D223136332200010C22000000204E616D653D224845425245575F43484152534554222056616C75653D223137372200010C22000000204E616D653D224152414249435F43484152534554222056616C75653D223137382200010C22000000204E616D653D2242414C5449435F43484152534554222056616C75653D223138362200010C23000000204E616D653D225255535349414E5F43484152534554222056616C75653D223230342200010C20000000204E616D653D22544841495F43484152534554222056616C75653D223232322200010C26000000204E616D653D22454153544555524F50455F43484152534554222056616C75653D223233382200010C1F000000204E616D653D224F454D5F43484152534554222056616C75653D223235352200010C0F000000204E616D653D222057696E50726F2200010C20000000204E616D653D22544F444159222056616C75653D2230322F30362F323031312200010C1C000000204E616D653D224E4F57222056616C75653D2231393A35343A33342200010C15000000204E616D653D22544142222056616C75653D22092200010C25000000204E616D653D22575055534552222056616C75653D2241646D696E6973747261746575722200010C1F000000204E616D653D22575056455253494F4E222056616C75653D22382E312E312200010C22000000204E616D653D2257505256455253494F4E222056616C75653D22382E302E322E372200010C1A000000204E616D653D224D4158504C4953222056616C75653D223130220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
</TfrxReport>

[I]fr3=1
[C]lniptyoc7=A58982ACC24393F565BD7A777F7B61D9
[C]title=david
[End of REPORT]
[Record REPORTQRY]
[REPORT=ZGRZEWARKA_DAV    0]
[C]database=dav
[C]datasource=%SERVER%:%DB%
[C]name=Database1
[M]params=40
USER NAME=%LOGIN%
PASSWORD=%PASSWORD%

[C]report=ZGRZEWARKA_DAV
[C]type=D
[I]typedb=9
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ZGRZEWARKA_DAV    1]
[C]database=dav
[I]line=1
[C]name=Query1
[M]params=798
select detlot.lot, lot.code, detlot.ligne, detlot.lcadre, detlot.hcadre, article.code, detlot.numero, detlot.ouvrant, detlot.position, detlot.type,
detlot.angle1, detlot.angle2, detlot.commande, detlot.chassis, detlot.profil, detlot.teinteext, detlot.renfort, detlot.dimrenfort, detlot.dim,
detlot.article, detlot.descriptio, article.codefou, detlot.codebarre, detlot.dormant, detlot.nouvr, detlot.sens, detlot.vantail, detlot.scie
,left(detlot.codebarre,8) as bardav -- profil
from detlot, article, lot
where detlot.article = article.code and detlot.lot = lot.lot and detlot.lot = '5' and detlot.scie = 1 and detlot.position = '4'
and (detlot.type = 1 or detlot.type = 2) and detlot.instruct = 'C' AND detlot.profil Not Like '%6324%' And detlot.profil Not Like '%6322%'
order by detlot.type
[C]report=ZGRZEWARKA_DAV
[C]type=Q
[End of REPORTQRY]
