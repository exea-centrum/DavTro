[Record REPORT]
[CODE=BUTTEELEC_CHTEC]
[C]CODE=BUTTEELEC_CHTEC
[C]TITLE=Butée Electronique
[X]DESIGN=23203
<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.7.163" DotMatrixReport="false" EngineOptions.DoublePass="true" IniFile="\Software\Fast Reports" PreviewOptions.AllowEdit="false" PreviewOptions.Buttons="4089" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39855,6224593403" ReportOptions.Description.Text="" ReportOptions.Name="BUTTEELEC_CHTEC" ReportOptions.LastChange="39973,6668155556" ScriptLanguage="PascalScript" ScriptText.Text="Var    &#13;&#10;&#13;&#10;fichier, fichierEtk : TFileStream;&#13;&#10;fichierIni, codeLot, nomRepertoire, nomFichier, ligne, ligneEtk, CrLf  : string;&#13;&#10;numeroLot, numscie : integer;&#13;&#10;dim_general, et_position : string;                                            &#13;&#10;i, ietk,j : integer;                                &#13;&#10;                                                                          &#13;&#10;                                 &#13;&#10;Function Right(var cadena : String; c : String; n : integer; m : integer) : String;   &#13;&#10;var&#13;&#10;i, d : integer;&#13;&#10;Begin      &#13;&#10;  If ( n &#62; 0) then        &#13;&#10;    begin              &#13;&#10;      i:=1;             &#13;&#10;      while i &#60;= n  do&#13;&#10;       begin&#13;&#10;          cadena := cadena + c;&#13;&#10;          inc(i,1)                          &#13;&#10;       end;&#13;&#10;     end&#13;&#10;   else&#13;&#10;     begin&#13;&#10;       cadena := Copy(cadena, 1, m);                                             &#13;&#10;     end;                   &#13;&#10;         &#13;&#10;   Result := cadena;     &#13;&#10;End;   &#13;&#10;&#13;&#10;Function Left(var cadena : String; c : String; n : integer) : String;   &#13;&#10;var&#13;&#10;i, d : integer;&#13;&#10;Begin      &#13;&#10;  if ( n &#62; 0) then        &#13;&#10;    begin              &#13;&#10;      i:=1;             &#13;&#10;      while i &#60;= n  do&#13;&#10;       begin&#13;&#10;          cadena := c + cadena;  &#13;&#10;          inc(i,1)                          &#13;&#10;       end;&#13;&#10;     end;               &#13;&#10;       &#13;&#10;   Result := cadena;     &#13;&#10;End;     &#13;&#10;  &#13;&#10;  &#13;&#10;Begin    &#13;&#10;          &#13;&#10;   CrLf := CHR(13) + CHR(10);&#13;&#10;   // Définition du fichier Ini.&#13;&#10;   fichierIni := '.\\Butee.ini';       &#13;&#10;     &#13;&#10;   // Récupération des informations dans detlot.     &#13;&#10;&#13;&#10;   numscie := IniReadInteger(fichierIni, 'Scie:Scie', '1');&#13;&#10;                                                &#13;&#10;   ReplaceParam('detlot:pscie','ftInteger', numscie);         &#13;&#10;     &#13;&#10;   FirstRecord('detlot');&#13;&#10;&#13;&#10;   if QueryEOF('detlot') then&#13;&#10;     begin&#13;&#10;     MessageDlg('La requête ne renvoie rien.  Il y a peut-être un problème avec la table client ?', mtconfirmation, mbok, 0);&#13;&#10;     engine.stopreport;                                            &#13;&#10;     end;               &#13;&#10;     &#13;&#10;   numeroLot := &#60;detlot.&#34;lot&#34;&#62;;&#13;&#10;&#13;&#10;   if &#60;detlot.&#34;lot&#34;&#62; &#60;&#62; '' then&#13;&#10;   begin&#13;&#10;       codeLot := IntToStr(numeroLot);                &#13;&#10;   end&#13;&#10;   else&#13;&#10;   begin&#13;&#10;       codeLot   := 'lot';                       &#13;&#10;   end;       &#13;&#10;   &#13;&#10;   // Constitution du nom du fichier.&#13;&#10;   nomRepertoire := IniReadString(fichierIni, 'Chemin de Base:fichier', '') + codeLot + '\';                                        &#13;&#10;    &#13;&#10;   // Constitution du directory du lot&#13;&#10;   ForceDirectories(nomRepertoire);            &#13;&#10;&#13;&#10;   //Fichier MG                              &#13;&#10;   nomFichier := nomRepertoire + codeLot + '.MG';  &#13;&#10;   fichier := TFileStream.Create(nomFichier, fmCreate);&#13;&#10;&#13;&#10;   //Fichier ET                                         &#13;&#10;   nomFichier := nomRepertoire + codeLot + '.ET';  &#13;&#10;   fichierEtk := TFileStream.Create(nomFichier, fmCreate);       &#13;&#10;&#13;&#10;   i := 1;&#13;&#10;   ietk := 1;                             &#13;&#10;   while not QueryEOF('detlot') do&#13;&#10;    begin&#13;&#10;    case trim(&#60;detlot.&#34;instruct&#34;&#62;) of&#13;&#10;    'P':&#13;&#10;       begin&#13;&#10;               dim_general := formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;);                                                                                       &#13;&#10;       end;&#13;&#10;      &#13;&#10;    'C':&#13;&#10;       begin  &#13;&#10;               ligne := Right(Trim(&#60;detlot.&#34;commande&#34;&#62;) + Trim(&#60;detlot.&#34;client&#34;&#62;), ' ', 20- Length(Trim(&#60;detlot.&#34;commande&#34;&#62;) + Trim(&#60;detlot.&#34;client&#34;&#62;)), 20);&#13;&#10;               ligne := ligne + Right(&#60;detlot.&#34;chassis&#34;&#62;,' ',20-Length(&#60;detlot.&#34;chassis&#34;&#62;), 20);&#13;&#10;               ligne := ligne + Right(&#60;detlot.&#34;teinteext&#34;&#62;,' ',20-Length(&#60;detlot.&#34;teinteext&#34;&#62;), 20);&#13;&#10;               case trim(&#60;detlot.&#34;position&#34;&#62;) of                                                    &#13;&#10;               '1' : &#13;&#10;                   begin                                  &#13;&#10;                       ligne := ligne + Right('GAUCHE',' ',4, 0);&#13;&#10;                       et_position := 'GAUCHE';                                                                           &#13;&#10;                   end;  &#13;&#10;               '2' :&#13;&#10;                   begin&#13;&#10;                       ligne := ligne + Right('DROITE',' ',4, 0);&#13;&#10;                       et_position := 'DROITE';                           &#13;&#10;                   end;  &#13;&#10;               '3' :&#13;&#10;                   begin&#13;&#10;                       ligne := ligne + Right('HAUT',' ',6, 0);&#13;&#10;                       et_position := 'HAUT';                           &#13;&#10;                   end;  &#13;&#10;               '4' :&#13;&#10;                   begin&#13;&#10;                       ligne := ligne + Right('BAS',' ',7, 0);&#13;&#10;                       et_position := 'BAS';                           &#13;&#10;                   end;&#13;&#10;               '0' :&#13;&#10;                   begin&#13;&#10;                       ligne := ligne + Right('BAS',' ', 7, 0);&#13;&#10;                       et_position := 'BAS';                           &#13;&#10;                   end;                          &#13;&#10;               else   &#13;&#10;                   begin&#13;&#10;                       ligne := ligne + Right('BAS',' ',7, 0);&#13;&#10;                       et_position := 'BAS';                           &#13;&#10;                   end;&#13;&#10;               end;                      &#13;&#10;                   &#13;&#10;               ligne := ligne + Right(&#60;detlot.&#34;profil&#34;&#62;,' ',10-Length(&#60;detlot.&#34;profil&#34;&#62;), 10);&#13;&#10;               ligne := ligne + '1   ' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk)));&#13;&#10;               ligne := ligne + Left(IntToStr(&#60;detlot.&#34;dim&#34;&#62;),'0',5-Length(IntToStr(&#60;detlot.&#34;dim&#34;&#62;)));&#13;&#10;               ligne := ligne + Left(IntToStr(&#60;detlot.&#34;qte&#34;&#62;),'0',2-Length(IntToStr(&#60;detlot.&#34;qte&#34;&#62;)));&#13;&#10;               if (&#60;detlot.&#34;angle1&#34;&#62; = 90) then           &#13;&#10;                 begin&#13;&#10;                       ligne := ligne + '000022' + CrLf;             &#13;&#10;                 end&#13;&#10;               else&#13;&#10;                 begin                                                                  &#13;&#10;                       ligne := ligne + '000000' + CrLf;&#13;&#10;                 end;&#13;&#10;                 //Fichier ET&#13;&#10;               //Ligne 1&#13;&#10;               //ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(Trim(&#60;detlot.&#34;profil&#34;&#62;), ' ', 50- Length(Trim(&#60;detlot.&#34;profil&#34;&#62;)), 50) + CrLf;&#13;&#10;               ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right('Lot n° ' + Trim(&#60;detlot.&#34;lot&#34;&#62;) + '-' + trim(&#60;detlot.&#34;article&#34;&#62;), ' ', 50- Length('Lot n° ' + Trim(&#60;detlot.&#34;lot&#34;&#62;) + '-' + trim(&#60;detlot.&#34;article&#34;&#62;)), 50) + CrLf;                   &#13;&#10;               fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;                 &#13;&#10;               ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(Trim(&#60;detlot.&#34;descriptio&#34;&#62;)+' .' + trim(&#60;detlot.&#34;couleur_etiq&#34;&#62;), ' ', 50- Length(Trim(&#60;detlot.&#34;descriptio&#34;&#62;)+' .' + trim(&#60;detlot.&#34;couleur_etiq&#34;&#62;)), 50) + CrLf;&#13;&#10;               fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;                 &#13;&#10;               ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(Trim(&#60;detlot.&#34;commande&#34;&#62;) + ' * ' + Trim(&#60;detlot.&#34;chassis&#34;&#62;) + ' * ' + trim(&#60;detlot.&#34;casierdorm&#34;&#62;) + ' * ' + et_position, ' ', 50- Length(Trim(&#60;detlot.&#34;commande&#34;&#62;) + ' * ' + Trim(&#60;detlot.&#34;chassis&#34;&#62;) + ' * ' + trim(&#60;detlot.&#34;casierdorm&#34;&#62;) + ' * ' + et_position), 50) + CrLf;&#13;&#10;               fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;               ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(Trim(&#60;detlot.&#34;codebarre&#34;&#62;), ' ', 50- Length(Trim(&#60;detlot.&#34;codebarre&#34;&#62;)), 50) + CrLf;&#13;&#10;               fichierEtk.Write(ligneEtk, Length(ligneEtk));                 &#13;&#10;                                                   &#13;&#10;               case trim(&#60;detlot.&#34;position&#34;&#62;) of&#13;&#10;               '1' :      &#13;&#10;                   begin                                                                                                                                                                 &#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' | ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°' , ' ', 50- Length(' | ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°'), 50) + CrLf;&#13;&#10;                   end;  &#13;&#10;               '2' :&#13;&#10;                   begin&#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' | ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' +  '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°' , ' ', 50- Length(' | ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°'), 50) + CrLf;                     &#13;&#10;                   end;  &#13;&#10;               '3' :&#13;&#10;                   begin                              &#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°' , ' ', 50- Length(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°'), 50) + CrLf;&#13;&#10;                   end;  &#13;&#10;               '4' :&#13;&#10;                   begin&#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°' , ' ', 50- Length(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°'), 50) + CrLf;                                      &#13;&#10;                   end;&#13;&#10;               '0' :&#13;&#10;                   begin&#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°' , ' ', 50- Length(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°'), 50) + CrLf;                     &#13;&#10;                   end;                          &#13;&#10;               else   &#13;&#10;                   begin&#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°' , ' ', 50- Length(' -- ' + Trim(formatfloat('0000.0', &#60;detlot.&#34;dim_etiq&#34;&#62;))   &#13;&#10;                                 + 'mm' + '(Renf :' + inttostr(&#60;detlot.&#34;dimrenfort&#34;&#62;) + 'mm) ' + formatfloat('00.0',&#60;detlot.&#34;angle1&#34;&#62;) +'°' &#13;&#10;                                 +  formatfloat('00.0',&#60;detlot.&#34;angle2&#34;&#62;) +'°'), 50) + CrLf;               &#13;&#10;                   end;                     &#13;&#10;               end;           &#13;&#10;               fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;               //Ligne 3                            &#13;&#10;               //ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + &#60;detlot.&#34;teinteext&#34;&#62; + '/' + &#60;detlot.&#34;teinteint&#34;&#62; + '          ' + Left(IntToStr(&#60;detlot.&#34;dim&#34;&#62;),'0',5-Length(IntToStr(&#60;detlot.&#34;dim&#34;&#62;))) + CrLf;&#13;&#10;               //fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;               //Ligne 4&#13;&#10;               //ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + &#60;detlot.&#34;lot&#34;&#62; + '     ' + &#60;detlot.&#34;profil&#34;&#62; + CrLf;&#13;&#10;               //fichierEtk.Write(ligneEtk, Length(ligneEtk));           &#13;&#10;               //Ligne 5&#13;&#10;               //ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(&#60;detlot.&#34;codebarre&#34;&#62;,' ',50-Length(&#60;detlot.&#34;codebarre&#34;&#62;), 50) + CrLf;&#13;&#10;               //fichierEtk.Write(ligneEtk, Length(ligneEtk));           &#13;&#10;                                           &#13;&#10;               inc(i);&#13;&#10;               inc(ietk);                    &#13;&#10;                     &#13;&#10;                                                         &#13;&#10;               fichier.Write(ligne, Length(ligne));                   &#13;&#10;       end;&#13;&#10;    else&#13;&#10;       begin&#13;&#10;               if &#60;detlot.&#34;dim_etiq&#34;&#62; &#60;&#62; 0 then&#13;&#10;               begin                           &#13;&#10;                       // information d'étiquette pour les chutes&#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(Trim(&#60;detlot.&#34;profil&#34;&#62;), ' ', 50- Length(Trim(&#60;detlot.&#34;profil&#34;&#62;)), 50) + CrLf;&#13;&#10;                       fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;                         &#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(Trim(&#60;detlot.&#34;descriptio&#34;&#62;)+' .' + trim(&#60;detlot.&#34;couleur_etiq&#34;&#62;), ' ', 50- Length(Trim(&#60;detlot.&#34;descriptio&#34;&#62;)+' .' + trim(&#60;detlot.&#34;couleur_etiq&#34;&#62;)), 50) + CrLf ;&#13;&#10;                       fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;        &#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + right('Reste', ' ', 50 - length('reste'),50) + Crlf;&#13;&#10;                       fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;                       &#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right('Dim :' + Trim(&#60;detlot.&#34;dim_etiq&#34;&#62;)+' mm', ' ', 50- Length('Dim :' + Trim(&#60;detlot.&#34;dim_etiq&#34;&#62;)+' mm'), 50) + CrLf ;&#13;&#10;                       fichierEtk.Write(ligneEtk, Length(ligneEtk));&#13;&#10;                       if &#60;detlot.&#34;dim_etiq&#34;&#62; &#62; 40 then                                                                                      &#13;&#10;                       ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' ***** STOCKER ***** ', ' ', 50- Length(' ***** STOCKER ***** '), 50) + CrLf &#13;&#10;                       else ligneEtk := 'E1' + Left(IntToStr(ietk),'0',4-Length(IntToStr(ietk))) + Right(' ***** JETER ***** ', ' ', 50- Length(' ***** JETER ***** '), 50) + CrLf;                                         &#13;&#10;                       fichierEtk.Write(ligneEtk, Length(ligneEtk));                           &#13;&#10;&#13;&#10;                       inc(ietk);                           &#13;&#10;               end;                                                  &#13;&#10;                 &#13;&#10;       end;                 &#13;&#10;    end;                         &#13;&#10;                          &#13;&#10;&#13;&#10;                &#13;&#10;       NextRecord ('detlot');&#13;&#10;    end;       &#13;&#10;     &#13;&#10;  fichier.Free;&#13;&#10;  fichierEtk.Free;      &#13;&#10;End." StoreInDFM="false" PropData="044C65667403D10203546F70031B0108446174617365747301010C2700000020446174615365743D225F6465746C6F742220446174615365744E616D653D226465746C6F74220000095661726961626C657301010C10000000204E616D653D2220436861727365742200010C1E000000204E616D653D22414E53495F43484152534554222056616C75653D22302200010C21000000204E616D653D2244454641554C545F43484152534554222056616C75653D22312200010C20000000204E616D653D2253594D424F4C5F43484152534554222056616C75653D22322200010C1E000000204E616D653D224D41435F43484152534554222056616C75653D2237372200010C23000000204E616D653D2253484946544A495F43484152534554222056616C75653D223132382200010C23000000204E616D653D2248414E4745554C5F43484152534554222056616C75653D223132392200010C22000000204E616D653D2248414E47554C5F43484152534554222056616C75653D223132392200010C21000000204E616D653D224A4F4841425F43484152534554222056616C75653D223133302200010C22000000204E616D653D224742323331325F43484152534554222056616C75653D223133342200010C27000000204E616D653D224348494E455345424947355F43484152534554222056616C75653D223133362200010C21000000204E616D653D22475245454B5F43484152534554222056616C75653D223136312200010C23000000204E616D653D225455524B4953485F43484152534554222056616C75653D223136322200010C26000000204E616D653D22564945544E414D4553455F43484152534554222056616C75653D223136332200010C22000000204E616D653D224845425245575F43484152534554222056616C75653D223137372200010C22000000204E616D653D224152414249435F43484152534554222056616C75653D223137382200010C22000000204E616D653D2242414C5449435F43484152534554222056616C75653D223138362200010C23000000204E616D653D225255535349414E5F43484152534554222056616C75653D223230342200010C20000000204E616D653D22544841495F43484152534554222056616C75653D223232322200010C26000000204E616D653D22454153544555524F50455F43484152534554222056616C75653D223233382200010C1F000000204E616D653D224F454D5F43484152534554222056616C75653D223235352200010C0F000000204E616D653D222057696E50726F2200010C20000000204E616D653D22544F444159222056616C75653D2231342F30312F323031302200010C1C000000204E616D653D224E4F57222056616C75653D2231353A30363A34382200010C15000000204E616D653D22544142222056616C75653D22092200010C25000000204E616D653D22575055534552222056616C75653D2241646D696E6973747261746575722200010C1A000000204E616D653D224D4158504C4953222056616C75653D223130220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" Visible="false" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" PrintIfEmpty="false" HGuides.Text="" VGuides.Text=""/>
</TfrxReport>

[N]FR3=1
[End of REPORT]
[Record REPORTQRY]
[REPORT=BUTTEELEC_CHTEC   0]
[C]REPORT=BUTTEELEC_CHTEC
[C]TYPE=D
[C]DATABASE=db
[C]NAME=Database1
[C]DATASOURCE=%DSN%
[M]PARAMS=31
USER NAME=root
PASSWORD=root

[I]TYPEDB=6
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=BUTTEELEC_CHTEC   1]
[C]REPORT=BUTTEELEC_CHTEC
[C]TYPE=Q
[I]LINE=1
[C]DATABASE=db
[C]NAME=detlot
[M]PARAMS=600
select instruct, lot, c.nom as client, chassis, ouvrant, vantail, teinteext, teinteint, position ,profil, dim*10 as dim, qte, commande, casier, 
codebarre, angle1, angle2, lot, p.descriptio, d.dim as dim_etiq, co.descriptio as couleur_etiq, d.article, d.dimrenfort,
iif(casier=casierdrm, alltrim('D'+alltrim(str(casier % 50000))), alltrim('O'+alltrim(str(casier)))) casierdorm
from detlot d left join client c on d.client = c.code
inner join profil p on p.code=d.profil
left join couleur co on d.teinteint = co.code
where d.scie = :pscie and val(trim(d.lot)) = val(trim(:order))
order by ligne
[End of REPORTQRY]
