[Record REPORT]
[CODE=ROTOX_6TETES 2.1]
[C]code=ROTOX_6TETES 2.1
[M]design=953826
<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.7.163" DotMatrixReport="false" IniFile="\Software\Fast Reports" PreviewOptions.AllowEdit="false" PreviewOptions.Buttons="4089" PreviewOptions.Zoom="1" PrintOptions.Printer="Par défaut" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40035,4648048611" ReportOptions.Description.Text="" ReportOptions.Name="ROTOX_6TETES 2.1" ReportOptions.LastChange="40035,4648048611" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;f : tfilestream;                                    &#13;&#10;fichierini, chemin, cheminreseau : string;                                                     &#13;&#10;codelot, numlot : string;&#13;&#10;sql, condition : string;                              &#13;&#10;commande, repere, lot, fichage, p_A, p_B, p_C, p_D, p_E, codebarre, bord_fichage, traverse, profil : string;                                      &#13;&#10;hauteur, largeur, hauteur_trav, axe_traverse, casier, code_couleur, percage, retournement :integer;&#13;&#10;flag, i, cnt, exclusion : integer;&#13;&#10;nb_reduit, nligne : integer;&#13;&#10;prA, prB, prC, prD, prE : string;&#13;&#10;cpts, cptd : integer;&#13;&#10;sqld, sqls : string;                                             &#13;&#10;// Fonction de vérification du chemin encodé dans le fichier ini&#13;&#10;  &#13;&#10;function verif(c : string;) : string;                                                       &#13;&#10;begin&#13;&#10;       if copy(c, length(c), 1) &#60;&#62; '\' then c := c + '\';&#13;&#10;       result := c;                                   &#13;&#10;end;&#13;&#10;&#13;&#10;procedure init_table();&#13;&#10;begin&#13;&#10;       sql := 'drop table if exists `traitement_rotox6_dormant`, `traitement_rotox6_ouvrant`, `rotox6_dormant`, `rotox6_ouvrant`';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;&#13;&#10;       sql := 'truncate imprime_rotox6_dormant';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;         &#13;&#10;       sql := 'truncate imprime_rotox6_ouvrant';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');           &#13;&#10;         &#13;&#10;       sql := 'CREATE TABLE if not exists `traitement_rotox6_ouvrant` ( '&#13;&#10;       + '`ko` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`en` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`po` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fn` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fc` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rb` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rh` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`pe` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`sa` varchar(20) NOT NULL default '''', '                                                                                                      &#13;&#10;       + '`sb` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sc` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sd` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`se` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`eb` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`di` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mo` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mu` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`ea` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fa` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`bc` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rd` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`qt` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`ko2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`en2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`po2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fn2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fc2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rb2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rh2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`pe2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`sa2` varchar(20) NOT NULL default '''', '                                                                                                      &#13;&#10;       + '`sb2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sc2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sd2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`se2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`eb2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`di2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mo2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mu2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`ea2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fa2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`bc2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rd2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`qt2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`traite` int(1) default ''0'', '                                                                                       &#13;&#10;       + '`recno` int(11) NOT NULL auto_increment, '     &#13;&#10;       + 'KEY `recno` (`recno`) '       &#13;&#10;       + ') ENGINE=InnoDB DEFAULT CHARSET=latin1; ';&#13;&#10;                                                                                            &#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;&#13;&#10;       sql := 'CREATE TABLE if not exists `traitement_rotox6_dormant` ( '     &#13;&#10;       + '`ko` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`en` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`po` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fn` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fc` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rb` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rh` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`pe` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`sa` varchar(20) NOT NULL default '''', '                                                                                                      &#13;&#10;       + '`sb` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sc` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sd` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`se` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`eb` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`di` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mo` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mu` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`ea` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fa` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`bc` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rd` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`qt` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`ko2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`en2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`po2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fn2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fc2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rb2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rh2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`pe2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`sa2` varchar(20) NOT NULL default '''', '                                                                                                      &#13;&#10;       + '`sb2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sc2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`sd2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`se2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`eb2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`di2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mo2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`mu2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`ea2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`fa2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`bc2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`rd2` varchar(20) NOT NULL default '''', '     &#13;&#10;       + '`qt2` varchar(20) NOT NULL default '''', '&#13;&#10;       + '`traite` int(1) default ''0'', '                                                                                             &#13;&#10;       + '`recno` int(11) NOT NULL auto_increment, '     &#13;&#10;       + 'KEY `recno` (`recno`) '       &#13;&#10;       + ') ENGINE=InnoDB DEFAULT CHARSET=latin1; ';&#13;&#10;                                                                                            &#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');           &#13;&#10;&#13;&#10;       sql := 'CREATE TABLE if not exists `rotox6_ouvrant` ( '     &#13;&#10;       + '`commande` varchar(6) NOT NULL, '     &#13;&#10;       + '`lot` varchar(4) NOT NULL, '     &#13;&#10;       + '`repere` varchar(3) NOT NULL, '     &#13;&#10;       + '`casier` int(10) unsigned NOT NULL, '     &#13;&#10;       + '`code_couleur` int(10) unsigned NOT NULL, '     &#13;&#10;       + '`largeur` int NOT NULL default ''0'', '     &#13;&#10;       + '`hauteur` int NOT NULL default ''0'', '     &#13;&#10;       + '`hauteur_trav` int NOT NULL default ''0'', '&#13;&#10;       + '`percage` int not null default ''0'', '                                                                                                      &#13;&#10;       + '`prof_A` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_B` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_C` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_D` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_E` varchar(20) NOT NULL, '&#13;&#10;       + '`org_prof_A` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_B` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_C` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_D` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_E` varchar(20) NOT NULL, '&#13;&#10;       + '`reduit_A` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_B` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_C` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_D` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_E` int(1) NOT NULL default ''0'', '           &#13;&#10;       + '`fichage` int(10) unsigned NOT NULL default ''0'', '&#13;&#10;       + '`bord_fichage` varchar(1) NOT NULL default '''', '           &#13;&#10;       + '`codebarre` varchar(45) NOT NULL, '&#13;&#10;       + '`nb_quart_retourn` int(4) not null default ''0'', '                                                                                                                 &#13;&#10;       + '`retournement` int(10) unsigned NOT NULL default ''0'', '&#13;&#10;       + '`traverse` varchar(1) NOT NULL, '&#13;&#10;       + '`axe_trav` int NOT NULL, '&#13;&#10;       + '`SeuilA` int(1) not null default ''0'', '&#13;&#10;       + '`SeuilC` int(1) not null default ''0'', '           &#13;&#10;       + '`Ret_traverse` int(1) NOT null default ''0'', '           &#13;&#10;       + '`Retourn_dim` int(1) NOT null default ''0'', '&#13;&#10;       + '`ver_dim_2` int(1) Not null default ''0'', '&#13;&#10;       + '`ver_dim_axe_trav_2` int(1) Not null default ''0'', '           &#13;&#10;       + '`Ret_seuil` int(1) NOT null default ''0'', '&#13;&#10;       + '`Ret_reduit` int(1) NOT null default ''0'', '&#13;&#10;       + '`Ret_fichage` int(1) NOT null default ''0'', '&#13;&#10;       + '`Ret_tri` int(1) not null default ''0'', '                                                                                                          &#13;&#10;       + '`Excl_dim` int(1) NOT null default ''0'', '&#13;&#10;       + '`Excl_seuil_meneau` int(1) NOT null default ''0'', '           &#13;&#10;       + '`Excl_seuil` int(1) NOT null default ''0'', '&#13;&#10;       + '`Excl_reduit` int(1) NOT null default ''0'', '&#13;&#10;       + '`Excl_fichage` int(1) NOT null default ''0'', '           &#13;&#10;       + '`a_traiter` int NOT NULL default ''1'', '                                                                                                 &#13;&#10;       + '`recno` int(11) NOT NULL auto_increment, '     &#13;&#10;       + 'KEY `recno` (`recno`) '       &#13;&#10;       + ') ENGINE=InnoDB DEFAULT CHARSET=latin1; ';&#13;&#10;                                                                                                            &#13;&#10;        replacesql('tables', sql);&#13;&#10;        execsql('tables');&#13;&#10;  &#13;&#10;        sql := 'CREATE TABLE if not exists `rotox6_dormant` ( '     &#13;&#10;       + '`commande` varchar(6) NOT NULL, '     &#13;&#10;       + '`lot` varchar(4) NOT NULL, '     &#13;&#10;       + '`repere` varchar(3) NOT NULL, '     &#13;&#10;       + '`casier` int(10) unsigned NOT NULL, '     &#13;&#10;       + '`code_couleur` int(10) unsigned NOT NULL, '     &#13;&#10;       + '`largeur` int NOT NULL default ''0'', '     &#13;&#10;       + '`hauteur` int NOT NULL default ''0'', '     &#13;&#10;       + '`hauteur_trav` int NOT NULL default ''0'', '&#13;&#10;       + '`percage` int not null default ''0'', '           &#13;&#10;       + '`prof_A` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_B` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_C` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_D` varchar(20) NOT NULL, '     &#13;&#10;       + '`prof_E` varchar(20) NOT NULL, '&#13;&#10;       + '`org_prof_A` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_B` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_C` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_D` varchar(20) NOT NULL, '     &#13;&#10;       + '`org_prof_E` varchar(20) NOT NULL, '&#13;&#10;       + '`reduit_A` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_B` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_C` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_D` int(1) NOT NULL default ''0'', '     &#13;&#10;       + '`reduit_E` int(1) NOT NULL default ''0'', '           &#13;&#10;       + '`fichage` int(10) unsigned NOT NULL default ''0'', '&#13;&#10;       + '`bord_fichage` varchar(1) NOT NULL default '''', '                                                                                             &#13;&#10;       + '`codebarre` varchar(45) NOT NULL, '&#13;&#10;       + '`nb_quart_retourn` int(4) not null default ''0'', '                    &#13;&#10;       + '`retournement` int(10) unsigned NOT NULL default ''0'', '&#13;&#10;       + '`traverse` varchar(1) NOT NULL, '&#13;&#10;       + '`axe_trav`int NOT NULL, '&#13;&#10;       + '`SeuilA` int(1) not null default ''0'', '&#13;&#10;       + '`SeuilC` int(1) not null default ''0'', '           &#13;&#10;       + '`Ret_traverse` int(1) NOT null default ''0'', '           &#13;&#10;       + '`Retourn_dim` int(1) NOT null default ''0'', '&#13;&#10;       + '`ver_dim_2` int(1) Not null default ''0'', '&#13;&#10;       + '`ver_dim_axe_trav_2` int(1) Not null default ''0'', '           &#13;&#10;       + '`Ret_seuil` int(1) NOT null default ''0'', '&#13;&#10;       + '`Ret_reduit` int(1) NOT null default ''0'', '&#13;&#10;       + '`Ret_fichage` int(1) NOT null default ''0'', '&#13;&#10;       + '`Ret_tri` int(1) not null default ''0'', '           &#13;&#10;       + '`Excl_dim` int(1) NOT null default ''0'', '&#13;&#10;       + '`Excl_seuil_meneau` int(1) NOT null default ''0'', '           &#13;&#10;       + '`Excl_seuil` int(1) NOT null default ''0'', '&#13;&#10;       + '`Excl_reduit` int(1) NOT null default ''0'', '&#13;&#10;       + '`Excl_fichage` int(1) NOT null default ''0'', '           &#13;&#10;       + '`a_traiter` int NOT NULL default ''1'', '           &#13;&#10;       + '`recno` int(11) NOT NULL auto_increment, '&#13;&#10;       + 'KEY `recno` (`recno`) '                    &#13;&#10;       + ') ENGINE=InnoDB DEFAULT CHARSET=latin1; ';               &#13;&#10;          &#13;&#10;      replacesql('tables', sql);&#13;&#10;      execsql('tables');             &#13;&#10;end;          &#13;&#10;// Procédure d'initialisation des variables                                                                                            &#13;&#10;procedure init_var();&#13;&#10;begin  &#13;&#10;       commande := '';&#13;&#10;       lot := '';&#13;&#10;       repere := '';&#13;&#10;       p_A := '';&#13;&#10;       p_B := '';&#13;&#10;       p_C := '';&#13;&#10;       p_D := '';&#13;&#10;       p_E := '';&#13;&#10;       fichage := '0';&#13;&#10;       codebarre := '';&#13;&#10;       bord_fichage := '';&#13;&#10;       casier := 0;&#13;&#10;       code_couleur := 0;  &#13;&#10;       largeur := 0;&#13;&#10;       hauteur := 0;&#13;&#10;       hauteur_trav := 0; &#13;&#10;       retournement := 0 ;&#13;&#10;       traverse := '0';&#13;&#10;       axe_traverse := 0;                                             &#13;&#10;end;&#13;&#10;&#13;&#10;procedure fill_rotox_6(type_cadre: string;);&#13;&#10;begin&#13;&#10;    case type_cadre of&#13;&#10;        'ouvrant' :&#13;&#10;        begin                &#13;&#10;              firstrecord('det_ouvrant');&#13;&#10;              while not queryeof('det_ouvrant') do&#13;&#10;              begin                          &#13;&#10;                      case &#60;det_ouvrant.&#34;position&#34;&#62; of &#13;&#10;                         '1':&#13;&#10;                         begin&#13;&#10;                               if not querybof('det_ouvrant') then &#13;&#10;                               begin                           &#13;&#10;                                        sql := 'insert into rotox6_ouvrant (commande, lot, repere, casier, code_couleur, largeur, hauteur, hauteur_trav, '&#13;&#10;                                               + 'prof_A, prof_B, prof_C, prof_D, prof_E, codebarre, fichage, bord_fichage, traverse, axe_trav, org_prof_A, org_prof_B, org_prof_C, '&#13;&#10;                                               + 'org_prof_D, org_prof_E, percage ) values ('''&#13;&#10;                                               + commande + ''', ''' + lot + ''', ''' + repere + ''', ' + inttostr(casier) + ', ''' + inttostr(code_couleur)&#13;&#10;                                               + ''', ' + floattostr(roundex(largeur, 2)) + ', ' + floattostr(roundex(hauteur, 2)) + ', '&#13;&#10;                                               + floattostr(roundex(hauteur_trav, 2)) + ', ''' + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', '''&#13;&#10;                                               + p_E + ''', ''' + codebarre + ''', ' + fichage + ', ''' + bord_fichage +''', ''' + traverse + ''', ' + floattostr(axe_traverse) + ', '''&#13;&#10;                                               + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', ''' + p_E + ''', ' &#13;&#10;                                               + inttostr(percage) +')';&#13;&#10;                                                                                                                  &#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');                                                                             &#13;&#10;                                                                &#13;&#10;                                       init_var();                                                                                                                                                                                                                                  &#13;&#10;                               end;&#13;&#10;&#13;&#10;                               firstrecord('percage_ouvrant');&#13;&#10;                               if not queryeof('percage_ouvrant') then percage := &#60;percage_ouvrant.&#34;position&#34;&#62; else percage := 0;&#13;&#10;                                         &#13;&#10;                               fichage := '0';                            &#13;&#10;                               bord_fichage := '';&#13;&#10;                               if bord_fichage = '' then&#13;&#10;                               begin                                   &#13;&#10;                                       firstrecord('fichage_ouvrant');&#13;&#10;                                       if not queryeof('fichage_ouvrant') then&#13;&#10;                                       begin&#13;&#10;                                               fichage := '1';&#13;&#10;                                               bord_fichage := &#60;fichage_ouvrant.&#34;sens&#34;&#62;;                                                                                            &#13;&#10;                                       end;&#13;&#10;                               end;                                                                  &#13;&#10;                                 &#13;&#10;                               axe_traverse := 0;                                         &#13;&#10;                               commande := copy(trim(&#60;det_ouvrant.&#34;commande&#34;&#62;), length(trim(&#60;det_ouvrant.&#34;commande&#34;&#62;))-5,6);                                                                                                                                                                                                                       &#13;&#10;                               lot := copy(&#60;det_ouvrant.&#34;lot&#34;&#62;, 1, 4);&#13;&#10;                               repere := copy(&#60;det_ouvrant.&#34;chassis&#34;&#62;, 1, 3);&#13;&#10;                               casier := &#60;det_ouvrant.&#34;casier&#34;&#62;;                                                                                                          &#13;&#10;                               code_couleur := inireadinteger(fichierini, 'correspondance couleur:'+trim(&#60;det_ouvrant.&#34;teinteint&#34;&#62;), '0');                                                                           &#13;&#10;                               hauteur := &#60;det_ouvrant.&#34;hcadre&#34;&#62;;&#13;&#10;                               largeur := &#60;det_ouvrant.&#34;lcadre&#34;&#62;;                           &#13;&#10;                               p_D := trim(&#60;det_ouvrant.&#34;profil&#34;&#62;);&#13;&#10;                                 &#13;&#10;                               codebarre := &#60;det_ouvrant.&#34;codebarre&#34;&#62;;                                                                                         &#13;&#10;                         end;&#13;&#10;                           &#13;&#10;                         '2':&#13;&#10;                         begin                                                                      &#13;&#10;                               p_B := trim(&#60;det_ouvrant.&#34;profil&#34;&#62;);&#13;&#10;                               if bord_fichage = '' then&#13;&#10;                               begin                                   &#13;&#10;                                       firstrecord('fichage_ouvrant');&#13;&#10;                                       if not queryeof('fichage_ouvrant') then&#13;&#10;                                       begin&#13;&#10;                                               fichage := '1';&#13;&#10;                                               bord_fichage := &#60;fichage_ouvrant.&#34;sens&#34;&#62;;                                                                                            &#13;&#10;                                       end;&#13;&#10;                               end;                           &#13;&#10;                         end;&#13;&#10;                           &#13;&#10;                         '3':&#13;&#10;                         begin                                                                                                                                    &#13;&#10;                               p_C := trim(&#60;det_ouvrant.&#34;profil&#34;&#62;);&#13;&#10;                               if bord_fichage = '' then&#13;&#10;                               begin                                   &#13;&#10;                                       firstrecord('fichage_ouvrant');&#13;&#10;                                       if not queryeof('fichage_ouvrant') then&#13;&#10;                                       begin&#13;&#10;                                               fichage := '1';&#13;&#10;                                               bord_fichage := &#60;fichage_ouvrant.&#34;sens&#34;&#62;;                                                                                            &#13;&#10;                                       end;&#13;&#10;                               end;                           &#13;&#10;                         end;&#13;&#10;                           &#13;&#10;                         '4':&#13;&#10;                         begin&#13;&#10;                               p_A := trim(&#60;det_ouvrant.&#34;profil&#34;&#62;);&#13;&#10;                               if bord_fichage = '' then&#13;&#10;                               begin                                   &#13;&#10;                                       firstrecord('fichage_ouvrant');&#13;&#10;                                       if not queryeof('fichage_ouvrant') then&#13;&#10;                                       begin&#13;&#10;                                               fichage := '1';&#13;&#10;                                               bord_fichage := &#60;fichage_ouvrant.&#34;sens&#34;&#62;;                                                                                            &#13;&#10;                                       end;&#13;&#10;                               end;                           &#13;&#10;                         end;&#13;&#10;                           &#13;&#10;                         '5':&#13;&#10;                         begin&#13;&#10;                              &#13;&#10;                               hauteur_trav := &#60;det_ouvrant.&#34;dim&#34;&#62;;                                                                                                                               &#13;&#10;                               p_E := trim(&#60;det_ouvrant.&#34;profil&#34;&#62;);                                                       &#13;&#10;                               traverse := 'V';&#13;&#10;                               axe_traverse := &#60;det_ouvrant.&#34;axetrav&#34;&#62;;&#13;&#10;                               if bord_fichage = '' then&#13;&#10;                               begin                                   &#13;&#10;                                       firstrecord('fichage_ouvrant');&#13;&#10;                                       if not queryeof('fichage_ouvrant') then&#13;&#10;                                       begin&#13;&#10;                                               fichage := '1';&#13;&#10;                                               bord_fichage := &#60;fichage_ouvrant.&#34;sens&#34;&#62;;                                                                                            &#13;&#10;                                       end;&#13;&#10;                               end;                           &#13;&#10;                         end;&#13;&#10;                           &#13;&#10;                         '6':&#13;&#10;                         begin&#13;&#10;                               hauteur_trav := &#60;det_ouvrant.&#34;dim&#34;&#62;;                                                                                                                &#13;&#10;                               p_E := trim(&#60;det_ouvrant.&#34;profil&#34;&#62;);                                                                                   &#13;&#10;                               traverse := 'H';&#13;&#10;                               axe_traverse := &#60;det_ouvrant.&#34;axetrav&#34;&#62;;&#13;&#10;                               if bord_fichage = '' then&#13;&#10;                               begin                                   &#13;&#10;                                       firstrecord('fichage_ouvrant');&#13;&#10;                                       if not queryeof('fichage_ouvrant') then&#13;&#10;                                       begin&#13;&#10;                                               fichage := '1';&#13;&#10;                                               bord_fichage := &#60;fichage_ouvrant.&#34;sens&#34;&#62;;                                                                                            &#13;&#10;                                       end;&#13;&#10;                               end;                           &#13;&#10;                         end;&#13;&#10;                      end;&#13;&#10;                        &#13;&#10;                      nextrecord('det_ouvrant');                                                                            &#13;&#10;              end;&#13;&#10;                &#13;&#10;              if queryeof('det_ouvrant') then &#13;&#10;              begin                                                         &#13;&#10;                        sql := 'insert into rotox6_ouvrant (commande, lot, repere, casier, code_couleur, largeur, hauteur, hauteur_trav, '&#13;&#10;                               + 'prof_A, prof_B, prof_C, prof_D, prof_E, codebarre, fichage, bord_fichage, traverse, axe_trav, org_prof_A, org_prof_B, org_prof_C, '&#13;&#10;                               + 'org_prof_D, org_prof_E, percage ) values ('''&#13;&#10;                               + commande + ''', ''' + lot + ''', ''' + repere + ''', ' + inttostr(casier) + ', ''' + inttostr(code_couleur)&#13;&#10;                               + ''', ' + floattostr(roundex(largeur, 2)) + ', ' + floattostr(roundex(hauteur, 2)) + ', '&#13;&#10;                               + floattostr(roundex(hauteur_trav, 2)) + ', ''' + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', '''&#13;&#10;                               + p_E + ''', ''' + codebarre + ''', ' + fichage + ', ''' + bord_fichage +''', ''' + traverse + ''', ' + floattostr(axe_traverse) + ', '''&#13;&#10;                               + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', ''' + p_E + ''', ' &#13;&#10;                               + inttostr(percage) +')';&#13;&#10;                                                                                                            &#13;&#10;                       replacesql('tables', sql);&#13;&#10;                       execsql('tables');                                                                             &#13;&#10;                                                          &#13;&#10;                       init_var();                                                                                                                                                                                                                                  &#13;&#10;              end;                  &#13;&#10;        end;&#13;&#10;    &#13;&#10;        'dormant':&#13;&#10;        begin                                &#13;&#10;              firstrecord('det_dormant');&#13;&#10;              while not queryeof('det_dormant') do&#13;&#10;              begin&#13;&#10;                     if &#60;det_dormant.&#34;casier_1&#34;&#62; = &#60;det_dormant.&#34;casierdrm&#34;&#62; then                   &#13;&#10;                         begin&#13;&#10;                     &#13;&#10;                           case &#60;det_dormant.&#34;position&#34;&#62; of &#13;&#10;                             '1':&#13;&#10;                             begin &#13;&#10;                                   if not querybof('det_dormant') then &#13;&#10;                                   begin                                                                                                                                        &#13;&#10;                                       sql := 'insert into rotox6_dormant (commande, lot, repere, casier, code_couleur, largeur, hauteur, hauteur_trav, '&#13;&#10;                                               + 'prof_A, prof_B, prof_C, prof_D, prof_E, codebarre, fichage, bord_fichage, traverse, axe_trav, org_prof_A, org_prof_B, org_prof_C, '&#13;&#10;                                               + 'org_prof_D, org_prof_E, percage ) values ('''&#13;&#10;                                               + commande + ''', ''' + lot + ''', ''' + repere + ''', ' + inttostr(casier) + ', ''' + inttostr(code_couleur)&#13;&#10;                                               + ''', ' + inttostr(largeur) + ', ' + inttostr(hauteur) + ', '&#13;&#10;                                               + inttostr(hauteur_trav) + ', ''' + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', '''&#13;&#10;                                               + p_E + ''', ''' + codebarre + ''', ' + fichage + ', ''' + bord_fichage +''', ''' + traverse + ''', ' + inttostr(axe_traverse) + ', '''&#13;&#10;                                               + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', ''' + p_E + ''', ' + inttostr(percage) +')';&#13;&#10;                                                                                                            &#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');                                                                             &#13;&#10;                  &#13;&#10;                                       init_var();                                                               &#13;&#10;                                   end;&#13;&#10;                                   firstrecord('percage_dormant');&#13;&#10;                                   if not queryeof('percage_dormant') then percage := &#60;percage_dormant.&#34;position&#34;&#62; else percage := 0;&#13;&#10;                                                           &#13;&#10;                                   fichage := '0';&#13;&#10;                                     &#13;&#10;                                   traverse := '0';                                                             &#13;&#10;                                   axe_traverse := 0;                                                                 &#13;&#10;                                   commande := copy(trim(&#60;det_dormant.&#34;commande&#34;&#62;), length(trim(&#60;det_dormant.&#34;commande&#34;&#62;))-5,6);                                                          &#13;&#10;                                   lot := copy(&#60;det_dormant.&#34;lot&#34;&#62;, 1, 4);                                                &#13;&#10;                                   repere := copy(&#60;det_dormant.&#34;chassis&#34;&#62;, 1, 3);                                                      &#13;&#10;                                   casier := &#60;det_dormant.&#34;casier&#34;&#62;;                                                        &#13;&#10;                                   code_couleur := inireadinteger(fichierini, 'correspondance couleur:'+trim(&#60;det_dormant.&#34;teinteint&#34;&#62;), '0');                                                                                 &#13;&#10;                                   hauteur := &#60;det_dormant.&#34;hcadre&#34;&#62;;&#13;&#10;                                   largeur := &#60;det_dormant.&#34;lcadre&#34;&#62;;                             &#13;&#10;                                   p_D := trim(&#60;det_dormant.&#34;profil&#34;&#62;);                                                         &#13;&#10;                                   codebarre := &#60;det_dormant.&#34;codebarre&#34;&#62;;                                 &#13;&#10;                             end;&#13;&#10;                               &#13;&#10;                             '2':&#13;&#10;                             begin                                                                                             &#13;&#10;                                   p_B := trim(&#60;det_dormant.&#34;profil&#34;&#62;);                                                                                                                                    &#13;&#10;                             end;&#13;&#10;                               &#13;&#10;                             '3':&#13;&#10;                             begin                                                                                                                                                       &#13;&#10;                                   p_C := trim(&#60;det_dormant.&#34;profil&#34;&#62;);                                                                                                                                    &#13;&#10;                             end;&#13;&#10;                               &#13;&#10;                             '4':&#13;&#10;                             begin&#13;&#10;                                   p_A := trim(&#60;det_dormant.&#34;profil&#34;&#62;);                                                                                                                                    &#13;&#10;                             end;&#13;&#10;                               &#13;&#10;                             '5':&#13;&#10;                             begin&#13;&#10;                                   hauteur_trav := &#60;det_dormant.&#34;dim&#34;&#62;;                                                                    &#13;&#10;                                   p_E := trim(&#60;det_dormant.&#34;profil&#34;&#62;);&#13;&#10;                                   traverse := 'V';&#13;&#10;                                   axe_traverse := &#60;det_dormant.&#34;axetrav&#34;&#62;;                                                                                                                                    &#13;&#10;                             end;&#13;&#10;                               &#13;&#10;                             '6':&#13;&#10;                             begin&#13;&#10;                                   hauteur_trav := &#60;det_dormant.&#34;dim&#34;&#62;;                                                                    &#13;&#10;                                   p_E := trim(&#60;det_dormant.&#34;profil&#34;&#62;);&#13;&#10;                                   traverse := 'H';&#13;&#10;                                   axe_traverse := &#60;det_dormant.&#34;axetrav&#34;&#62;;                                                                                                                                    &#13;&#10;                             end;&#13;&#10;                               &#13;&#10;                           end;&#13;&#10;                         end;      &#13;&#10;                     nextrecord('det_dormant');                                                                 &#13;&#10;              end;&#13;&#10;              if queryeof('det_dormant') then &#13;&#10;              begin &#13;&#10;                   fichage := '0';                            &#13;&#10;                                                                                                                                                                                                                                                                               &#13;&#10;                   sql := 'insert into rotox6_dormant (commande, lot, repere, casier, code_couleur, largeur, hauteur, hauteur_trav, '&#13;&#10;                           + 'prof_A, prof_B, prof_C, prof_D, prof_E, codebarre, fichage, bord_fichage, traverse, axe_trav, org_prof_A, org_prof_B, org_prof_C, '&#13;&#10;                           + 'org_prof_D, org_prof_E, percage ) values ('''&#13;&#10;                           + commande + ''', ''' + lot + ''', ''' + repere + ''', ' + inttostr(casier) + ', ''' + inttostr(code_couleur)&#13;&#10;                           + ''', ' + inttostr(largeur) + ', ' + inttostr(hauteur) + ', '&#13;&#10;                           + inttostr(hauteur_trav) + ', ''' + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', '''&#13;&#10;                           + p_E + ''', ''' + codebarre + ''', ' + fichage + ', ''' + bord_fichage +''', ''' + traverse + ''', ' + inttostr(axe_traverse) + ', '''&#13;&#10;                           + p_A + ''', ''' + p_B + ''', ''' + p_C + ''', ''' + p_D + ''', ''' + p_E + ''', ' + inttostr(percage) +')';&#13;&#10;                                                                                                              &#13;&#10;                   replacesql('tables', sql);&#13;&#10;                   execsql('tables');                                                                             &#13;&#10;                    &#13;&#10;                   init_var();                                                               &#13;&#10;               end;                  &#13;&#10;        end;&#13;&#10;    end;                &#13;&#10;end;&#13;&#10;  &#13;&#10;function seuil_meneau(type_cadre : string;): integer;                     &#13;&#10;begin                                                                       &#13;&#10;       // SEUILS&#13;&#10;       // vérification si seuil en bas avec traverse verticale soudée --&#62; exclusion&#13;&#10;                                                                                       &#13;&#10;       i := 1;&#13;&#10;       profil := '';                                   &#13;&#10;       cnt := inireadinteger(fichierini, 'Seuils A:count', '0');&#13;&#10;&#13;&#10;       if cnt &#60;&#62; 0 then&#13;&#10;       begin&#13;&#10;               while (i &#60;= cnt) and (trim(profil) &#60;&#62; trim(vartostr(report.getdataset(type_cadre).value('prof_A')))) do&#13;&#10;               begin&#13;&#10;                       profil := inireadstring(fichierini, 'Seuils A:'+inttostr(i), '');&#13;&#10;                       inc(i,1);                                           &#13;&#10;               end;                         &#13;&#10;       end;                 &#13;&#10;       &#13;&#10;       cnt := 0;&#13;&#10;       i := 1;                         &#13;&#10;       &#13;&#10;       if profil = '' then&#13;&#10;       begin&#13;&#10;               cnt := inireadinteger(fichierini, 'Seuils C:count', '0');&#13;&#10;&#13;&#10;               if cnt &#60;&#62; 0 then&#13;&#10;               begin&#13;&#10;                       while (i &#60;= cnt) and (trim(profil) &#60;&#62; trim(vartostr(report.getdataset(type_cadre).value('prof_A')))) do&#13;&#10;                       begin&#13;&#10;                               profil := inireadstring(fichierini, 'Seuils C:'+inttostr(i), '');&#13;&#10;                               inc(i,1);                                           &#13;&#10;                       end;                         &#13;&#10;               end;                   &#13;&#10;       end;                 &#13;&#10;         &#13;&#10;       if (trim(profil) = trim(vartostr(report.getdataset(type_cadre).value('prof_A')))) and (trim(vartostr(report.getdataset(type_cadre).value('traverse'))) = 'V') then&#13;&#10;       begin&#13;&#10;               //Exclusion                                               &#13;&#10;               exclusion := 1;                                                 &#13;&#10;       end&#13;&#10;       else exclusion := 0;&#13;&#10;&#13;&#10;       result := exclusion;                                                   &#13;&#10;end;&#13;&#10;&#13;&#10;// Fonction de vérification du type de seuil et retournement s'il s'agit d'un Seuil C                                                                                                                                                                                           &#13;&#10;  &#13;&#10;function verif_seuil(type_cadre : string; type_seuil : string;) : integer;&#13;&#10;var&#13;&#10;code_seuil : string;                                      &#13;&#10;begin&#13;&#10;       i := 1;&#13;&#10;       profil := '';                                   &#13;&#10;       cnt := inireadinteger(fichierini, 'Seuils ' + type_seuil + ':count', '0');&#13;&#10;                    &#13;&#10;       if cnt &#60;&#62; 0 then&#13;&#10;       begin&#13;&#10;               while (i &#60;= cnt) and (trim(profil) &#60;&#62; trim(vartostr(report.getdataset(type_cadre).value('prof_A')))) do&#13;&#10;               begin&#13;&#10;                       profil := inireadstring(fichierini, 'Seuils ' + type_seuil + ':'+inttostr(i), '');&#13;&#10;                       inc(i,1);                                           &#13;&#10;               end;                         &#13;&#10;       end;&#13;&#10;                    &#13;&#10;       if (trim(profil) = trim(vartostr(report.getdataset(type_cadre).value('prof_A')))) then result := 1 else result :=0;         &#13;&#10;end;          &#13;&#10;&#13;&#10;// Fonction de vérification des profiles réduits                                                                                                      &#13;&#10;  &#13;&#10;procedure verif_prof_reduit(type_cadre : string; n_ligne : integer;);&#13;&#10;begin&#13;&#10;       cnt := inireadinteger(fichierini, 'Profils Réduits:count', '0');&#13;&#10;       i := 1;&#13;&#10;       nb_reduit := 0;&#13;&#10;       &#13;&#10;       prA := '';&#13;&#10;       prB := '';&#13;&#10;       prC := '';&#13;&#10;       prD := '';&#13;&#10;       prE := '';&#13;&#10;                &#13;&#10;       while (i &#60;= cnt) and ((prA = '') or (prB = '') or (prC = '') or (prD = '') or (prE = '')) do&#13;&#10;       begin&#13;&#10;               if inireadstring(fichierini, 'Profils Réduits:'+inttostr(i), '') = trim(vartostr(report.getdataset(type_cadre).value('org_prof_A'))) then&#13;&#10;               begin&#13;&#10;                       if prA='' then&#13;&#10;                       begin                                   &#13;&#10;                               prA := trim(vartostr(report.getdataset(type_cadre).value('org_prof_A')));                                                &#13;&#10;                               inc(nb_reduit,1);&#13;&#10;                       end;                                                                  &#13;&#10;               end;&#13;&#10;               &#13;&#10;               if inireadstring(fichierini, 'Profils Réduits:'+inttostr(i), '') = trim(vartostr(report.getdataset(type_cadre).value('org_prof_B'))) then&#13;&#10;               begin&#13;&#10;                       if prB='' then&#13;&#10;                       begin                                            &#13;&#10;                               prB := trim(vartostr(report.getdataset(type_cadre).value('org_prof_B')));                                            &#13;&#10;                               inc(nb_reduit,1);&#13;&#10;                       end;                                                                  &#13;&#10;               end;&#13;&#10;                 &#13;&#10;               if inireadstring(fichierini, 'Profils Réduits:'+inttostr(i), '') = trim(vartostr(report.getdataset(type_cadre).value('org_prof_C'))) then&#13;&#10;               begin&#13;&#10;                       if prC='' then&#13;&#10;                       begin                                            &#13;&#10;                               prC := trim(vartostr(report.getdataset(type_cadre).value('org_prof_C')));                                            &#13;&#10;                               inc(nb_reduit,1);&#13;&#10;                       end;                                                                  &#13;&#10;               end;&#13;&#10;                 &#13;&#10;               if inireadstring(fichierini, 'Profils Réduits:'+inttostr(i), '') = trim(vartostr(report.getdataset(type_cadre).value('org_prof_D'))) then&#13;&#10;               begin&#13;&#10;                       if prD='' then&#13;&#10;                       begin                                            &#13;&#10;                               prD := trim(vartostr(report.getdataset(type_cadre).value('org_prof_D')));                                            &#13;&#10;                               inc(nb_reduit,1);&#13;&#10;                       end;                                                                      &#13;&#10;               end;&#13;&#10;                 &#13;&#10;               if inireadstring(fichierini, 'Profils Réduits:'+inttostr(i), '') = trim(vartostr(report.getdataset(type_cadre).value('org_prof_E'))) then&#13;&#10;               begin&#13;&#10;                       if prE='' then&#13;&#10;                       begin                                            &#13;&#10;                               prE := trim(vartostr(report.getdataset(type_cadre).value('org_prof_E')));                                            &#13;&#10;                               inc(nb_reduit,1);&#13;&#10;                       end;                                                                  &#13;&#10;               end;                                          &#13;&#10;               inc(i,1);&#13;&#10;       end;&#13;&#10;         &#13;&#10;       if nb_reduit &#60;&#62; 0 then&#13;&#10;       begin&#13;&#10;&#13;&#10;               sql := 'update `rotox6_' + type_cadre + '` set ';&#13;&#10;&#13;&#10;               if prA &#60;&#62; '' then sql := sql + '`reduit_A` = 1, ';&#13;&#10;               if prB &#60;&#62; '' then sql := sql + '`reduit_B` = 1, ';&#13;&#10;               if prC &#60;&#62; '' then sql := sql + '`reduit_C` = 1, ';&#13;&#10;               if prD &#60;&#62; '' then sql := sql + '`reduit_D` = 1, ';&#13;&#10;               if prE &#60;&#62; '' then sql := sql + '`reduit_E` = 1, ';&#13;&#10;        &#13;&#10;               sql := copy(sql, 1, length(sql)-2);&#13;&#10;        &#13;&#10;               sql := sql + ' where `recno` = ' + inttostr(n_ligne);                                               &#13;&#10;        &#13;&#10;               replacesql('tables', sql);&#13;&#10;               execsql('tables');                 &#13;&#10;       end;&#13;&#10;         &#13;&#10;       if ((type_cadre = 'dormant') and (nb_reduit &#62; 2)) or ((type_cadre = 'ouvrant') and (nb_reduit &#62; 1)) then              &#13;&#10;       begin                             &#13;&#10;               sql := 'delete from rotox6_' + type_cadre + ' where recno = ' + trim(vartostr(report.getdataset(type_cadre).value('recno')));&#13;&#10;               replacesql('tables', sql);&#13;&#10;               execsql('tables');                         &#13;&#10;       end;                                         &#13;&#10;end;    &#13;&#10;// Vérification des dimensions du cadre et s'il est possible de les retourner                                                                                                                                                                          &#13;&#10;procedure verif_dimension(req, type_cadre : string);&#13;&#10;var&#13;&#10;mini_L, mini_H, maxi_L, maxi_H, mini_T, maxi_T, haut, larg : integer;                                                                                                        &#13;&#10;L, H, T, L2, H2, T2 : integer;&#13;&#10;axe_T : integer;&#13;&#10;ret_trav_larg, ret_trav_axe : integer;                                                                                   &#13;&#10;begin&#13;&#10;       T := 0;&#13;&#10;       T2 := 0;&#13;&#10;         &#13;&#10;       haut := strtoint(vartostr(report.getdataset(req).value('hauteur')));&#13;&#10;       larg := strtoint(vartostr(report.getdataset(req).value('largeur')));&#13;&#10;         &#13;&#10;       mini_L := inireadinteger(fichierini, 'largeur:mini', '0');&#13;&#10;       maxi_L := inireadinteger(fichierini, 'largeur:maxi', '0');&#13;&#10;         &#13;&#10;       mini_H := inireadinteger(fichierini, 'hauteur:mini', '0');&#13;&#10;       maxi_H := inireadinteger(fichierini, 'hauteur:maxi', '0');                              &#13;&#10;&#13;&#10;       if trim(vartostr(report.getdataset(req).value('traverse'))) &#60;&#62; '0' then&#13;&#10;       begin&#13;&#10;               axe_T := strtoint(vartostr(report.getdataset(req).value('traverse')));  &#13;&#10;                 &#13;&#10;               mini_T := inireadinteger(fichierini, 'axe traverse:mini', '0');&#13;&#10;               maxi_T := inireadinteger(fichierini, 'axe traverse:maxi', '0');&#13;&#10;                 &#13;&#10;               if (axe_T &#62; mini_T) and (axe_T &#60; maxi_T) then T := 0 else T := 1;&#13;&#10;&#13;&#10;               case trim(vartostr(report.getdataset(req).value('traverse'))) of&#13;&#10;                 'H':&#13;&#10;                 begin&#13;&#10;                       if ((haut-axe_T) &#62; mini_T) and ((haut-axe_T) &#60; maxi_T) then T2 := 0 else T2 := 1;                                                                       &#13;&#10;                 end;&#13;&#10;                   &#13;&#10;                 'V':&#13;&#10;                 begin&#13;&#10;                       if ((larg-axe_T) &#62; mini_T) and ((larg-axe_T) &#60; maxi_T) then T2 := 0 else T2 := 1;                                              &#13;&#10;                 end;&#13;&#10;               end;                                            &#13;&#10;                 &#13;&#10;       end;  &#13;&#10;         &#13;&#10;       if (larg &#62; mini_L) and (larg &#60; maxi_L) then L := 0 else L := 1;  &#13;&#10;         &#13;&#10;       if (haut &#62; mini_H) and (haut &#60; maxi_H) then H := 0 else H := 1;&#13;&#10;&#13;&#10;       //Dans le cas d'un retournement ou la hauteur devient la largeur et la largeur devient la hauteur;                                                                                                                                                                                                                               &#13;&#10;&#13;&#10;       if (haut &#62; mini_L) and (haut &#60; maxi_L) then L2 := 0 else L2 := 1;  &#13;&#10;         &#13;&#10;       if (larg &#62; mini_H) and (larg &#60; maxi_H) then H2 := 0 else H2 := 1;&#13;&#10;&#13;&#10;       //le cadre ne pourra pas être retourné d'1/2 ou de 3/4 de tour si traverse                                                                                                                                                                                                                                                                   &#13;&#10;       if T2 = 1 then&#13;&#10;       begin&#13;&#10;               sql := 'update `' + req + '` set `ver_dim_axe_trav_2` = 1 where `recno` = ' + trim(vartostr(report.getdataset(req).value('recno')));&#13;&#10;               replacesql('tables', sql);&#13;&#10;               execsql('tables');                            &#13;&#10;       end;&#13;&#10;&#13;&#10;       //le cadre ne pourra pas être retourné d'1/4 ou de 3/4 de tour                                                                                                                                                 &#13;&#10;       if (L2 = 1) or (H2 = 1) then&#13;&#10;       begin&#13;&#10;               sql := 'update `' + req + '` set `ver_dim_2` = 1 where `recno` = ' + trim(vartostr(report.getdataset(req).value('recno')));&#13;&#10;               replacesql('tables', sql);&#13;&#10;               execsql('tables');                   &#13;&#10;       end;                 &#13;&#10;&#13;&#10;       if T = 1 then flag := 2   &#13;&#10;       else&#13;&#10;       begin&#13;&#10;               if (L = 1) and (H = 1) and (H2 = 1) and (L2 = 1) then flag := 2   &#13;&#10;               else&#13;&#10;               begin&#13;&#10;                       if ((L = 1) and (H2 = 1)) or ((H = 1) and (L2 = 1)) then flag := 2&#13;&#10;                       else&#13;&#10;                       begin                                   &#13;&#10;                               if (L = 1) or (H = 1) then&#13;&#10;                               begin&#13;&#10;                                       if (trim(vartostr(report.getdataset(req).value('SeuilA'))) = '1') &#13;&#10;                                       or (trim(vartostr(report.getdataset(req).value('SeuilC'))) = '1') &#13;&#10;                                       or (trim(vartostr(report.getdataset(req).value('traverse'))) = 'H') then&#13;&#10;                                       begin&#13;&#10;                                               // si seuil A ou seuil C et traverse horizontale (ne peut pas être verticale) et retournement --&#62; exclusion&#13;&#10;                                               sql := 'delete from ' + req + ' where recno = ' + trim(vartostr(report.getdataset(req).value('recno')));&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');                                                   &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               //retournement d'1/4 de tour&#13;&#10;                                               // A va dans D&#13;&#10;                                               // B va dans A&#13;&#10;                                               // C va dans B&#13;&#10;                                               // D va dans C                                                                         &#13;&#10;                                               sql := 'update `' + req + '` set `prof_A` = ''' + trim(vartostr(report.getdataset(req).value('prof_B')))&#13;&#10;                                                       + ''', `prof_B`= ''' + trim(vartostr(report.getdataset(req).value('prof_C')))&#13;&#10;                                                       + ''', `prof_C`= ''' + trim(vartostr(report.getdataset(req).value('prof_D')))&#13;&#10;                                                       + ''', `prof_D`= ''' + trim(vartostr(report.getdataset(req).value('prof_A')))                                                                                                                                                                                                                                              &#13;&#10;                                                       + ''', `Retourn_dim` = 1 '&#13;&#10;                                                       + ', largeur = ' + trim(vartostr(report.getdataset(req).value('hauteur')))&#13;&#10;                                                       + ', hauteur = ' + trim(vartostr(report.getdataset(req).value('largeur')));&#13;&#10;&#13;&#10;                                               if trim(vartostr(report.getdataset(req).value('traverse'))) = 'V' then&#13;&#10;                                               begin&#13;&#10;                                                       ret_trav_larg := strtoint(vartostr(report.getdataset(req).value('largeur')));  &#13;&#10;                                                       ret_trav_axe := strtoint(vartostr(report.getdataset(req).value('axe_trav')));&#13;&#10;                                                       sql := sql + ', axe_trav = ' + trim(vartostr(abs(ret_trav_axe - ret_trav_larg)));                                                                                                                                                     &#13;&#10;                                                       sql := sql + ', traverse = ''H''';&#13;&#10;                                               end;                                                                                                                  &#13;&#10;                                                       &#13;&#10;                                               sql := sql + ' where `recno` = ' + trim(vartostr(report.getdataset(req).value('recno')));&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');                 &#13;&#10;                                        &#13;&#10;                                               flag := 1;                                                                                            &#13;&#10;                                       end;                                                 &#13;&#10;                               end&#13;&#10;                               else flag := 0;&#13;&#10;                       end;                                                                  &#13;&#10;               end;&#13;&#10;       end;&#13;&#10;&#13;&#10;       if flag = 2 then                     &#13;&#10;       begin&#13;&#10;               sql := 'delete from `' + req + '` where `recno` = ' + trim(vartostr(report.getdataset(req).value('recno')));&#13;&#10;               replacesql('tables', sql);&#13;&#10;               execsql('tables');                   &#13;&#10;       end;                                                              &#13;&#10;end;           &#13;&#10;&#13;&#10;  &#13;&#10;procedure simple_cadre(type_cadre: string;);&#13;&#10;begin&#13;&#10;       case type_cadre of&#13;&#10;         'dormant':&#13;&#10;         begin&#13;&#10;               sql := 'select * from simple_dormant';&#13;&#10;               replacesql('simple_dormant', sql);&#13;&#10;               execsql('simple_dormant');&#13;&#10;               firstrecord('simple_dormant');&#13;&#10;&#13;&#10;               while not queryeof('simple_dormant') do&#13;&#10;               begin&#13;&#10;                       ajout_traitement('dormant', 'simple', '', &#60;simple_dormant.&#34;recno&#34;&#62;, 0);                                            &#13;&#10;                       nextrecord('simple_dormant');                                                                                                    &#13;&#10;               end;                         &#13;&#10;         end;&#13;&#10;         'ouvrant':&#13;&#10;         begin&#13;&#10;               sql := 'select * from simple_ouvrant';&#13;&#10;               replacesql('simple_ouvrant', sql);&#13;&#10;               execsql('simple_ouvrant');&#13;&#10;               firstrecord('simple_ouvrant');&#13;&#10;&#13;&#10;               while not queryeof('simple_ouvrant') do&#13;&#10;               begin&#13;&#10;                       ajout_traitement('ouvrant', 'simple', '', &#60;simple_ouvrant.&#34;recno&#34;&#62;, 0);                                            &#13;&#10;                       nextrecord('simple_ouvrant');                                                                                                    &#13;&#10;               end;                                                                                                                                                    &#13;&#10;         end;                   &#13;&#10;       end;             &#13;&#10;end;&#13;&#10;&#13;&#10;procedure double_cadre(type_cadre : string;);&#13;&#10;var&#13;&#10;assemble, prem_cadre_reduit, n_cadre : integer;&#13;&#10;profilA, profilB, profilC, profilD : string;&#13;&#10;cadre_deja_passe : string;                                                        &#13;&#10;begin&#13;&#10;       assemble := 0;                                         &#13;&#10;       case type_cadre of&#13;&#10;         'dormant':&#13;&#10;         begin&#13;&#10;               {il faut respecter pour les deux cadres à assembler&#13;&#10;                que les montants des 2 cadres soient de même ref.&#13;&#10;                que les traverses hautes des 2 cadres soient de même ref.&#13;&#10;                que les traverses basses des 2 cadres soient de même ref.&#13;&#10;                que les hauteurs ou les largeurs des 2 cadres sont identiques}                       &#13;&#10;               // tester si les H sont égales&#13;&#10;               // tester si les L sont égales&#13;&#10;&#13;&#10;               // si pas possibilité d'assembler le cadre --&#62; envoi en simple cadre&#13;&#10;&#13;&#10;               // 2 cas&#13;&#10;               // soit le cadre a été retourné par dépassement de dimension --&#62; dans ce cas groupé seulement si (L =) &#13;&#10;               // pas si (H =) car un retournement est nécessaire (tete beche)                         &#13;&#10;&#13;&#10;               // soit le cadre n'a pas été retourné&#13;&#10;               // vérifier si le 2e cadre n'a pas été retourné  si c'est le cas pas en H =&#13;&#10;               // si pas ok pour  L =                                                                                           &#13;&#10;               // si pas possibilité d'assembler le cadre --&#62; envoi en simple cadre&#13;&#10;                 &#13;&#10;               // sont en double cadres dormant, les cadres n'ayant ni traverse, ni seuil et ni profile réduit&#13;&#10;&#13;&#10;               // vérifier les dimensions, retourner les cadres si un dépassement est présent,&#13;&#10;               // si le cadre est en dépassement dans les 2 sens --&#62; exclure&#13;&#10;               sql := 'select * from double_dormant';&#13;&#10;               replacesql('double_dormant', sql);&#13;&#10;               execsql('double_dormant');&#13;&#10;               firstrecord('double_dormant');&#13;&#10;                 &#13;&#10;               while not queryeof('double_dormant') do&#13;&#10;               begin                           &#13;&#10;                       verif_dimension('double_dormant', 'dormant');&#13;&#10;                       nextrecord('double_dormant');                                                                     &#13;&#10;               end;&#13;&#10;               firstrecord('double_dormant');&#13;&#10;                 &#13;&#10;               while not queryeof('double_dormant') do&#13;&#10;               begin                                                                     &#13;&#10;                       sql := 'select * from double_dormant where `prof_A` = ''' + trim(&#60;double_dormant.&#34;prof_A&#34;&#62;)&#13;&#10;                               + ''' and `prof_C`=''' +trim(&#60;double_dormant.&#34;prof_C&#34;&#62;) + ''' and `prof_B`= '''&#13;&#10;                               + trim(&#60;double_dormant.&#34;prof_B&#34;&#62;) + ''' and `prof_D` = ''' + trim(&#60;double_dormant.&#34;prof_D&#34;&#62;) &#13;&#10;                               + ''' and hauteur = '+ inttostr(&#60;double_dormant.&#34;hauteur&#34;&#62;) + ' and recno &#60;&#62; ' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;);                                                              &#13;&#10;                       replacesql('h_egales', sql);&#13;&#10;                       execsql('h_egales');&#13;&#10;&#13;&#10;                       firstrecord('h_egales');&#13;&#10;&#13;&#10;                       if not queryeof('h_egales') then&#13;&#10;                       begin&#13;&#10;                               //bord bas en D des 2 cadres&#13;&#10;                               while (not queryeof('h_egales')) and (assemble = 0) do&#13;&#10;                               begin&#13;&#10;                                       if (&#60;double_dormant.&#34;retourn_dim&#34;&#62; &#60;&#62; 1) and (&#60;h_egales.&#34;retourn_dim&#34;&#62; &#60;&#62;  1) then&#13;&#10;                                       begin&#13;&#10;                                               ajout_traitement('dormant', 'double', 'BD', &#60;double_dormant.&#34;recno&#34;&#62;, &#60;h_egales.&#34;recno&#34;&#62;);&#13;&#10;                                               assemble := 1;&#13;&#10;                                               sql := 'delete from double_dormant where recno in (' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;h_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');&#13;&#10;                                               sql := 'update rotox6_dormant set a_traiter = 0 where recno in (' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;h_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');                                                   &#13;&#10;                                               report.getdataset('double_dormant').close;&#13;&#10;                                               report.getdataset('double_dormant').open;                                                   &#13;&#10;                                               firstrecord('double_dormant');                                                                                                             &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               if &#60;h_egales.&#34;retourn_dim&#34;&#62; = 1 then&#13;&#10;                                               begin&#13;&#10;                                                       nextrecord('h_egales');                                                                                                            &#13;&#10;                                               end;                                                         &#13;&#10;                                       end;                                                 &#13;&#10;                                                                                                                                                                 &#13;&#10;                               end;&#13;&#10;                               if (queryeof('h_egales')) or (assemble =1) then&#13;&#10;                               begin&#13;&#10;                                       assemble := 0;&#13;&#10;                               end;                                         &#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin&#13;&#10;                               sql := 'select * from double_dormant where `prof_A` = ''' + trim(&#60;double_dormant.&#34;prof_A&#34;&#62;)&#13;&#10;                               + ''' and `prof_C`=''' +trim(&#60;double_dormant.&#34;prof_C&#34;&#62;) + ''' and `prof_B`= '''&#13;&#10;                               + trim(&#60;double_dormant.&#34;prof_B&#34;&#62;) + ''' and `prof_D` = ''' + trim(&#60;double_dormant.&#34;prof_D&#34;&#62;) &#13;&#10;                               + ''' and largeur = '+ inttostr(&#60;double_dormant.&#34;largeur&#34;&#62;) + ' and recno &#60;&#62; ' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;);&#13;&#10;                               replacesql('l_egales', sql);&#13;&#10;                               execsql('l_egales');&#13;&#10;        &#13;&#10;                               firstrecord('l_egales');&#13;&#10;&#13;&#10;                               if not queryeof('l_egales') then&#13;&#10;                               begin&#13;&#10;                                       //bord bas du 1er cadre en A&#13;&#10;                                       // bord bas du 2e cadre en C (tete beche)&#13;&#10;                                       ajout_traitement('dormant', 'double', 'tetebeche', &#60;double_dormant.&#34;recno&#34;&#62;, &#60;l_egales.&#34;recno&#34;&#62;);&#13;&#10;                                       assemble := 1;&#13;&#10;                                       sql := 'delete from double_dormant where recno in (' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;h_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;                                       sql := 'update rotox6_dormant set a_traiter = 0 where recno in (' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;h_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');                                           &#13;&#10;                                       report.getdataset('double_dormant').close;&#13;&#10;                                       report.getdataset('double_dormant').open;                                                   &#13;&#10;                                       firstrecord('double_dormant');                                           &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       // envoyer en simple cadre, aucune correspondance par rapport à la largeur ou à la hauteur&#13;&#10;                                       sql := 'insert into simple_dormant select * from double_dormant where recno = ' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;);&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;&#13;&#10;                                       sql := 'delete from double_dormant where recno = ' + inttostr(&#60;double_dormant.&#34;recno&#34;&#62;) ;&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;&#13;&#10;                                       sql := 'select * from `rotox6_dormant` where `recno` not in (select recno from `simple_dormant`) and a_traiter =1';&#13;&#10;                                       replacesql('double_dormant', sql);&#13;&#10;                                       execsql('double_dormant');               &#13;&#10;                                       firstrecord('double_dormant');                                                                                                     &#13;&#10;                               end;&#13;&#10;                       end;                                 &#13;&#10;                                                                                                                                                                            &#13;&#10;                                                                                                          &#13;&#10;               end;                                                        &#13;&#10;         end;&#13;&#10;         'ouvrant':&#13;&#10;         begin&#13;&#10;               {sont exclu les cadres avec traverse soudée (valeur d angle=300)&#13;&#10;                Rappel&#13;&#10;                les profils réduits doivent être positionnés en C éventuellement en D jamais en E&#13;&#10;                le montant fiché toujours en A (retournement du cadre) ou B&#13;&#10;                les 4 cotés du cadre doivent avoir la même référence de profil&#13;&#10;                les hauteurs ou les largeurs des 2 cadres doivent être identique&#13;&#10;                privilegier le test sur les hauteurs&#13;&#10;                remarque&#13;&#10;                privilegier l assemblage de cadres de même chassis&#13;&#10;                tous les vantaux d un même chassis ayant le même n° de casier on peut procéder de la maniere&#13;&#10;                suivante&#13;&#10;                un premier passage sur l ensemble du lot ou l on assemble les cadres par casier (suivant les&#13;&#10;                règles ci-dessus)&#13;&#10;                puis un second passage ou on test l ensemble des cadres entre eux sans distinction de chassis&#13;&#10;                editer un document récapitulatif des cadres dans l ordre du fichier (voir l onglet doc&#13;&#10;                ouvrant)}               &#13;&#10;               // Sont en double cadre ouvrant les cadres n'ayant pas de traverses &#13;&#10;               // (profiles réduits ok et montant fiché)&#13;&#10;                 &#13;&#10;               // vérifier le dépassement de la dimension&#13;&#10;               // vérifier le positionnement des profiles réduits (ouvrant maximum 1) le retourner si besoin&#13;&#10;               // si + de 1 --&#62; exclure (Déja fait dans procédure verif_profile_reduit)                                                                                                                                                                                    &#13;&#10;               // vérifier la position du profile fiché le retourner si besoin si possible par rapport au profile réduit (parralèle)                         &#13;&#10;               // prioriser le montant fiché pour le double cadre en A&#13;&#10;               // si pas possible placer en A --&#62; simple cadre et montant fiché en B                                                                                                                                                        &#13;&#10;                 &#13;&#10;               // vérifier les conditions d'assemblage &#13;&#10;               // 2 cadres avec profile fichés peuvent être ensemble (position en A pour le profile fiché)&#13;&#10;               // 1 assemblage ne peut avoir qu'un cadre avec profile reduit tout en haut position en C (montant fiché en A)                                              &#13;&#10;&#13;&#10;               // 1ere recherche par rapport aux cadres d'une mm commande&#13;&#10;               // puis passer en revue les autres cadres&#13;&#10;                 &#13;&#10;               sql := 'select * from double_ouvrant where a_traiter=1';&#13;&#10;               replacesql('double_ouvrant', sql);&#13;&#10;               execsql('double_ouvrant');&#13;&#10;               firstrecord('double_ouvrant');&#13;&#10;               &#13;&#10;               cadre_deja_passe := '';&#13;&#10;                 &#13;&#10;               while not queryeof('double_ouvrant') do&#13;&#10;               begin&#13;&#10;                       sql := 'select * from `double_ouvrant` where trim(left(codebarre,7)) = ''' + copy(trim(&#60;double_ouvrant.&#34;codebarre&#34;&#62;), 1, 7) &#13;&#10;                               + ''' and `recno` &#60;&#62; ' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;);                         &#13;&#10;                       replacesql('menuis_egales', sql);&#13;&#10;                       execsql('menuis_egales');  &#13;&#10;&#13;&#10;                       firstrecord('menuis_egales');&#13;&#10;                       n_cadre := &#60;double_ouvrant.&#34;recno&#34;&#62;;&#13;&#10;                         &#13;&#10;                       flag := 0;                                               &#13;&#10;                       while (not queryeof('menuis_egales')) and (flag = 0) do          &#13;&#10;                       begin&#13;&#10;                               if (((&#60;double_ouvrant.&#34;reduit_A&#34;&#62; = 1) or (&#60;double_ouvrant.&#34;reduit_B&#34;&#62; = 1) or (&#60;double_ouvrant.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                               or (&#60;double_ouvrant.&#34;reduit_D&#34;&#62; = 1)) and ((&#60;menuis_egales.&#34;reduit_A&#34;&#62; = 0) and (&#60;menuis_egales.&#34;reduit_B&#34;&#62; = 0) &#13;&#10;                               and (&#60;menuis_egales.&#34;reduit_C&#34;&#62; = 0) and (&#60;menuis_egales.&#34;reduit_D&#34;&#62; = 0))) OR&#13;&#10;                               (((&#60;double_ouvrant.&#34;reduit_A&#34;&#62; = 0) and (&#60;double_ouvrant.&#34;reduit_B&#34;&#62; = 0) and (&#60;double_ouvrant.&#34;reduit_C&#34;&#62; = 0)&#13;&#10;                               and (&#60;double_ouvrant.&#34;reduit_D&#34;&#62; = 0)) and ((&#60;menuis_egales.&#34;reduit_A&#34;&#62; = 1) or (&#60;menuis_egales.&#34;reduit_B&#34;&#62; = 1) &#13;&#10;                               or (&#60;menuis_egales.&#34;reduit_C&#34;&#62; = 1) or (&#60;menuis_egales.&#34;reduit_D&#34;&#62; = 1))) then&#13;&#10;                               begin                                                                                                                                                                                                                                                     &#13;&#10;                                       // test si au moins un des cadre a un profile réduit                                                                                                                                                    &#13;&#10;                                       if &#60;double_ouvrant.&#34;hauteur&#34;&#62; = &#60;menuis_egales.&#34;hauteur&#34;&#62; then&#13;&#10;                                       begin&#13;&#10;                                               // le réduit du 1er cadre doit être en haut en C donc montant fiché en A&#13;&#10;                                               // pas de réduit en 2e cadre et position du montant fiché en A&#13;&#10;                                               // Attention retourner d'1/4 de tour ou de 3/4 de tour                                      &#13;&#10;                                                                                                          &#13;&#10;                                               if ajout_traitement('ouvrant', 'double', 'H=', &#60;double_ouvrant.&#34;recno&#34;&#62;, &#60;menuis_egales.&#34;recno&#34;&#62;) = 1 then  &#13;&#10;                                               begin&#13;&#10;                                                       flag := 1;                                                                                                                                &#13;&#10;                                                       sql := 'update rotox6_ouvrant set `a_traiter`= 0 where recno in ('&#13;&#10;                                                                       + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;menuis_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                                 &#13;&#10;                                                       sql := 'delete from `double_ouvrant` where `recno` in (' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;)  &#13;&#10;                                                               + ', ' + inttostr(&#60;menuis_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                       replacesql('tables', sql);&#13;&#10;                                                       execsql('tables');&#13;&#10;                                                       &#13;&#10;                                                       report.getdataset('double_ouvrant').close;&#13;&#10;                                                       report.getdataset('double_ouvrant').open;                                                           &#13;&#10;                                                       sql := 'select * from double_ouvrant where a_traiter=1';&#13;&#10;                                                       replacesql('double_ouvrant', sql);&#13;&#10;                                                       execsql('double_ouvrant');&#13;&#10;                                                       firstrecord('double_ouvrant');                                                           &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       nextrecord('menuis_egales');                                                                                                                                                                &#13;&#10;                                               end;                                                                                                                                                          &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               if &#60;double_ouvrant.&#34;largeur&#34;&#62; = &#60;menuis_egales.&#34;largeur&#34;&#62; then&#13;&#10;                                               begin&#13;&#10;                                                       //la position est correcte vérifier qu'un des cadre a son réduit en C&#13;&#10;                                                       // ou faire 1/2 tour                                                                                                     &#13;&#10;                                                       if ajout_traitement('ouvrant', 'double', 'L=', &#60;double_ouvrant.&#34;recno&#34;&#62;, &#60;menuis_egales.&#34;recno&#34;&#62;) = 1 then                     &#13;&#10;                                                       begin&#13;&#10;                                                               flag := 1;                                                                                                                                                &#13;&#10;                                                               sql := 'update rotox6_ouvrant set `a_traiter`= 0 where recno in ('&#13;&#10;                                                                       + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;menuis_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                                 &#13;&#10;                                                               sql := 'delete from `double_ouvrant` where `recno` in (' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;)&#13;&#10;                                                                       + ', ' + inttostr(&#60;menuis_egales.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                                 &#13;&#10;                                                               report.getdataset('double_ouvrant').close;&#13;&#10;                                                               report.getdataset('double_ouvrant').open;                                                           &#13;&#10;                                                               sql := 'select * from double_ouvrant where a_traiter = 1';&#13;&#10;                                                               replacesql('double_ouvrant', sql);&#13;&#10;                                                               execsql('double_ouvrant');&#13;&#10;                                                               firstrecord('double_ouvrant');&#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               nextrecord('menuis_egales');                                                                                                                            &#13;&#10;                                                       end;                                                         &#13;&#10;                                                                                                                        &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       nextrecord('menuis_egales');                                                                                                            &#13;&#10;                                               end;                                                                                                                                                                                                                                                         &#13;&#10;                                       end;                                                                                                                                                                                                                                                          &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       nextrecord('menuis_egales');                                                                                                                            &#13;&#10;                               end;&#13;&#10;                       end;&#13;&#10;                       if queryeof('menuis_egales') then                                                              &#13;&#10;                       begin&#13;&#10;                               sql := 'update double_ouvrant set a_traiter = 0 where recno = ' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;);                                                                                                                                                                                                                                 &#13;&#10;                               replacesql('tables', sql);&#13;&#10;                               execsql('tables');&#13;&#10;                               report.getdataset('double_ouvrant').close;&#13;&#10;                               report.getdataset('double_ouvrant').open;                                                           &#13;&#10;                               sql := 'select * from double_ouvrant where a_traiter = 1';&#13;&#10;                               replacesql('double_ouvrant', sql);&#13;&#10;                               execsql('double_ouvrant');&#13;&#10;                               firstrecord('double_ouvrant');                                                                                   &#13;&#10;                       end;                         &#13;&#10;                       //nextrecord('double_ouvrant');                                            &#13;&#10;                                                                                                                                                        &#13;&#10;               end;  &#13;&#10;               &#13;&#10;               sql := 'select * from double_ouvrant';&#13;&#10;               replacesql('double_ouvrant', sql);&#13;&#10;               execsql('double_ouvrant');&#13;&#10;               firstrecord('double_ouvrant');&#13;&#10;&#13;&#10;               while not queryeof('double_ouvrant') do&#13;&#10;               begin&#13;&#10;                       flag := 0;                                                                &#13;&#10;                       sql := 'select * from double_ouvrant where hauteur=' + inttostr(&#60;double_ouvrant.&#34;hauteur&#34;&#62;) +' and recno &#60;&#62; ' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;);&#13;&#10;                       replacesql('menuis_diff', sql);&#13;&#10;                       execsql('menuis_diff');&#13;&#10;                       if not queryeof('menuis_diff') then&#13;&#10;                       begin                                   &#13;&#10;                               while (not queryeof('menuis_diff')) and (flag = 0) do&#13;&#10;                               begin&#13;&#10;                                       {if (((&#60;double_ouvrant.&#34;reduit_A&#34;&#62; = 1) or (&#60;double_ouvrant.&#34;reduit_B&#34;&#62; = 1) or (&#60;double_ouvrant.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                       or (&#60;double_ouvrant.&#34;reduit_D&#34;&#62; = 1)) and ((&#60;menuis_diff.&#34;reduit_A&#34;&#62; = 0) and (&#60;menuis_diff.&#34;reduit_B&#34;&#62; = 0) &#13;&#10;                                       and (&#60;menuis_diff.&#34;reduit_C&#34;&#62; = 0) and (&#60;menuis_diff.&#34;reduit_D&#34;&#62; = 0))) OR&#13;&#10;                                       (((&#60;double_ouvrant.&#34;reduit_A&#34;&#62; = 0) and (&#60;double_ouvrant.&#34;reduit_B&#34;&#62; = 0) and (&#60;double_ouvrant.&#34;reduit_C&#34;&#62; = 0)&#13;&#10;                                       and (&#60;double_ouvrant.&#34;reduit_D&#34;&#62; = 0)) and ((&#60;menuis_diff.&#34;reduit_A&#34;&#62; = 1) or (&#60;menuis_diff.&#34;reduit_B&#34;&#62; = 1) &#13;&#10;                                       or (&#60;menuis_diff.&#34;reduit_C&#34;&#62; = 1) or (&#60;menuis_diff.&#34;reduit_D&#34;&#62; = 1))) then&#13;&#10;                                       begin}  &#13;&#10;                                               if ajout_traitement('ouvrant', 'double', 'H=', &#60;double_ouvrant.&#34;recno&#34;&#62;, &#60;menuis_diff.&#34;recno&#34;&#62;) = 1 then                     &#13;&#10;                                               begin&#13;&#10;                                                       flag := 1;                                                                                                                                                &#13;&#10;                                                       sql := 'update rotox6_ouvrant set `a_traiter`= 0 where recno in ('&#13;&#10;                                                               + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;menuis_diff.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                       replacesql('tables', sql);&#13;&#10;                                                       execsql('tables');&#13;&#10;                                                                 &#13;&#10;                                                       sql := 'delete from `double_ouvrant` where `recno` in (' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;)&#13;&#10;                                                               + ', ' + inttostr(&#60;menuis_diff.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                       replacesql('tables', sql);&#13;&#10;                                                       execsql('tables');&#13;&#10;                                                         &#13;&#10;                                                       report.getdataset('double_ouvrant').close;&#13;&#10;                                                       report.getdataset('double_ouvrant').open;                                                           &#13;&#10;                                                       sql := 'select * from double_ouvrant';&#13;&#10;                                                       replacesql('double_ouvrant', sql);&#13;&#10;                                                       execsql('double_ouvrant');&#13;&#10;                                                       firstrecord('double_ouvrant');&#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       nextrecord('menuis_diff');                                                                                                                            &#13;&#10;                                               end;                                                                                            &#13;&#10;                                       {end&#13;&#10;                                       else&#13;&#10;                                       begin                                                   &#13;&#10;                                               nextrecord('menuis_diff');&#13;&#10;                                       end;}                                                                                                    &#13;&#10;                               end;&#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin&#13;&#10;                               sql := 'select * from double_ouvrant where largeur=' + inttostr(&#60;double_ouvrant.&#34;largeur&#34;&#62;) + ' and recno &#60;&#62; ' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;);&#13;&#10;                               replacesql('menuis_diff', sql);&#13;&#10;                               execsql('menuis_diff');&#13;&#10;&#13;&#10;                               if not queryeof('menuis_diff') then&#13;&#10;                               begin                                   &#13;&#10;                                       while not queryeof('menuis_diff') do&#13;&#10;                                       begin&#13;&#10;                                               if (((&#60;double_ouvrant.&#34;reduit_A&#34;&#62; = 1) or (&#60;double_ouvrant.&#34;reduit_B&#34;&#62; = 1) or (&#60;double_ouvrant.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                               or (&#60;double_ouvrant.&#34;reduit_D&#34;&#62; = 1)) and ((&#60;menuis_diff.&#34;reduit_A&#34;&#62; = 0) and (&#60;menuis_diff.&#34;reduit_B&#34;&#62; = 0) &#13;&#10;                                               and (&#60;menuis_diff.&#34;reduit_C&#34;&#62; = 0) and (&#60;menuis_diff.&#34;reduit_D&#34;&#62; = 0))) OR&#13;&#10;                                               (((&#60;double_ouvrant.&#34;reduit_A&#34;&#62; = 0) and (&#60;double_ouvrant.&#34;reduit_B&#34;&#62; = 0) and (&#60;double_ouvrant.&#34;reduit_C&#34;&#62; = 0)&#13;&#10;                                               and (&#60;double_ouvrant.&#34;reduit_D&#34;&#62; = 0)) and ((&#60;menuis_diff.&#34;reduit_A&#34;&#62; = 1) or (&#60;menuis_diff.&#34;reduit_B&#34;&#62; = 1) &#13;&#10;                                               or (&#60;menuis_diff.&#34;reduit_C&#34;&#62; = 1) or (&#60;menuis_diff.&#34;reduit_D&#34;&#62; = 1))) then&#13;&#10;                                               begin&#13;&#10;                                                       if ajout_traitement('ouvrant', 'double', 'L=', &#60;double_ouvrant.&#34;recno&#34;&#62;, &#60;menuis_diff.&#34;recno&#34;&#62;) = 1 then                     &#13;&#10;                                                       begin&#13;&#10;                                                               flag := 1;                                                                                                                                                &#13;&#10;                                                               sql := 'update rotox6_ouvrant set `a_traiter`= 0 where recno in ('&#13;&#10;                                                                       + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;) + ', ' + inttostr(&#60;menuis_diff.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                                 &#13;&#10;                                                               sql := 'delete from `double_ouvrant` where `recno` in (' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;)&#13;&#10;                                                                       + ', ' + inttostr(&#60;menuis_diff.&#34;recno&#34;&#62;) + ')';&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                               report.getdataset('double_ouvrant').close;&#13;&#10;                                                               report.getdataset('double_ouvrant').open;                                                           &#13;&#10;                                                               sql := 'select * from double_ouvrant';&#13;&#10;                                                               replacesql('double_ouvrant', sql);&#13;&#10;                                                               execsql('double_ouvrant');&#13;&#10;                                                               firstrecord('double_ouvrant');&#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               nextrecord('menuis_diff');                                                                                                                            &#13;&#10;                                                       end;                                                                                                            &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin                                                           &#13;&#10;                                                       nextrecord('menuis_diff');&#13;&#10;                                               end;                                                                                                                  &#13;&#10;                                       end;&#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin                                           &#13;&#10;                                       sql := 'insert into simple_ouvrant select * from double_ouvrant where recno = ' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;);&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;        &#13;&#10;                                       sql := 'delete from double_ouvrant where recno = ' + inttostr(&#60;double_ouvrant.&#34;recno&#34;&#62;) ;&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;        &#13;&#10;                                       sql := 'select * from `rotox6_ouvrant` where `recno` not in (select recno from `simple_ouvrant`) and a_traiter =1';&#13;&#10;                                       replacesql('double_ouvrant', sql);&#13;&#10;                                       execsql('double_ouvrant');               &#13;&#10;                                       firstrecord('double_ouvrant');&#13;&#10;                               end;                                                                                  &#13;&#10;                       end;                                 &#13;&#10;               end;                                          &#13;&#10;         end;                   &#13;&#10;       end;                 &#13;&#10;end;&#13;&#10;  &#13;&#10;function ajout_traitement(type_cadre, assemblage, type_assemblage : string; cadre1, cadre2 : integer;):integer;&#13;&#10;var&#13;&#10;res1, res2, preduit, hauteur1, hauteur2, largeur1, largeur2, axe_traverse : integer;&#13;&#10;sqlred : string;                                    &#13;&#10;begin&#13;&#10;       case type_cadre of&#13;&#10;         'dormant':&#13;&#10;         begin&#13;&#10;               hauteur1 := 0;&#13;&#10;               hauteur2 := 0;&#13;&#10;               largeur1 := 0;&#13;&#10;               largeur2 := 0;&#13;&#10;               res1 := 0;&#13;&#10;               res2 := 0;                                       &#13;&#10;               case assemblage of&#13;&#10;//DOUBLE DORMANT                                       &#13;&#10;                 'double':&#13;&#10;                 begin&#13;&#10;                       sqld := 'insert into traitement_rotox6_' + type_cadre + '(`ko`, `en`, `po`, `fn`, `fc`, `rb`, `rh`, `pe`, `sa`, `sb`, `sc`, `sd`, '&#13;&#10;                               + '`se`, `eb`, `di`, `mo`, `mu`, `ea`, `fa`, `bc`, `rd`, `qt`, `ko2`, `en2`, `po2`, `fn2`, `fc2`, `rb2`, `rh2`, `pe2`, `sa2`, '&#13;&#10;                               + '`sb2`, `sc2`, `sd2`, `se2`, `eb2`, `di2`, `mo2`, `mu2`, `ea2`, `fa2`, `bc2`, `rd2`, `qt2`) values (';&#13;&#10;                                 &#13;&#10;                       sql := 'select * from double_dormant where recno in (' + inttostr(cadre1) + ', ' + inttostr(cadre2) +')';&#13;&#10;                       replacesql('traitement', sql);&#13;&#10;                       execsql('traitement');&#13;&#10;                       report.getdataset('traitement').close;&#13;&#10;                       report.getdataset('traitement').open;                                                                                       &#13;&#10;                       case type_assemblage of&#13;&#10;                         'BD':&#13;&#10;                         begin&#13;&#10;                               //bord bas va en D&#13;&#10;                               //1/4 de tour à faire donc changer la hauteur en largeur et la largeur en hauteur                                                                                                                                                                                                                  &#13;&#10;                               firstrecord('traitement');&#13;&#10;                                 &#13;&#10;                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                               // largeur                                                   &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                               // hauteur                                                   &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                               // profile A                                                             &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                               // profile B                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                               // profile C                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                               // profile D                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                               // profile E                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                               + ''', ''' + '0' + ''', ''' + '0';                      &#13;&#10;&#13;&#10;                               // 1/4 de tour : &#13;&#10;                               // vérifier si le cadre n'a pas déja été retourné à cause de dépasement de dimension d'un des coté&#13;&#10;                               // vérifier si les dimensions retournées sont comprises dans les dimensions mini et maxi&#13;&#10;                                 &#13;&#10;                               if (trim(vartostr(report.getdataset('traitement').value('retourn_dim'))) = '0') &#13;&#10;                               and (trim(vartostr(report.getdataset('traitement').value('ver_dim_2'))) = '0') then res1 := 1;&#13;&#10;                                 &#13;&#10;                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));       &#13;&#10;                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                  &#13;&#10;                                 &#13;&#10;                               nextrecord('traitement');&#13;&#10;&#13;&#10;                               sql := sql + ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                               // largeur                                   &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                               // hauteur                                   &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                               // profile A                                   &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                               // profile B                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                               // profile C                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                               // profile D                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                               // profile E                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                               + ''', ''' + '0' + ''', ''' + '0' + ''' )';&#13;&#10;&#13;&#10;                               if (trim(vartostr(report.getdataset('traitement').value('retourn_dim'))) = '0') &#13;&#10;                               and (trim(vartostr(report.getdataset('traitement').value('ver_dim_2'))) = '0') then res2 := 1;&#13;&#10;                                 &#13;&#10;                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));       &#13;&#10;                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                  &#13;&#10;  &#13;&#10;                               if (res1 = 1) and (res2 = 1) then&#13;&#10;                               begin                                           &#13;&#10;                                       sql := sqld + sql;&#13;&#10;&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;                                       result := 1;                                                                   &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       // un des 2 cadres ne peut pas être retourné&#13;&#10;                                       result := 0;                                                                   &#13;&#10;                               end;                                         &#13;&#10;                         end;&#13;&#10;&#13;&#10;                         'tetebeche':&#13;&#10;                         begin&#13;&#10;                               // 1/2 tour à faire                                                                                                         &#13;&#10;                               firstrecord('traitement');&#13;&#10;                                 &#13;&#10;                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                               // profile A                                                             &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                               // profile B                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                               // profile C                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                               // profile D                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                               // profile E                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                               + ''', ''' + '0' + ''', ''' + '0';                      &#13;&#10;&#13;&#10;                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));  &#13;&#10;                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                  &#13;&#10;                                 &#13;&#10;                               nextrecord('traitement');&#13;&#10;&#13;&#10;                               sql := sql + ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                               // profile A                                   &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                               // profile B                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                               // profile C                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                               // profile D                                         &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                               // profile E                                      &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                               + ''', ''' + '0' + ''', ''' + '0' + ''' )';&#13;&#10;&#13;&#10;                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));       &#13;&#10;                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                  &#13;&#10;                                   &#13;&#10;                               sql := sqld + sql;&#13;&#10;&#13;&#10;                               replacesql('tables', sql);&#13;&#10;                               execsql('tables');&#13;&#10;                               result := 1;                                                           &#13;&#10;                         end;                                   &#13;&#10;                       end;                                 &#13;&#10;                 end;&#13;&#10;&#13;&#10;                 'simple':&#13;&#10;//SIMPLE DORMANT                       &#13;&#10;                 begin&#13;&#10;                       sql := 'select * from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                       replacesql('traitement', sql);&#13;&#10;                       execsql('traitement');&#13;&#10;                       report.getdataset('traitement').close;&#13;&#10;                       report.getdataset('traitement').open;                                                                                                   &#13;&#10;                       firstrecord('traitement');&#13;&#10;                         &#13;&#10;                       sqls := 'insert into traitement_rotox6_' + type_cadre + ' (`ko`, `en`, `po`, `fn`, `fc`, `rb`, `rh`, `pe`, `sa`, `sb`, `sc`, `sd`, '&#13;&#10;                               +'`se`, `eb`, `di`, `mo`, `mu`, `ea`, `fa`, `bc`, `rd`, `qt`) values (';&#13;&#10;                       &#13;&#10;                       // vérifier si seuil A ou C , si traverse et si profil réduit&#13;&#10;&#13;&#10;                       if &#60;traitement.&#34;seuilA&#34;&#62; = 1 then&#13;&#10;                       begin&#13;&#10;                               //le cadre doit rester tel qu'il est il ne peut être retourné sinon exclusion&#13;&#10;                               //tester si réduit si retournement à cause d'un réduit --&#62; exclusion&#13;&#10;                               // vérifier les profiles réduits, s'il y en a, s'ils sont bien positionnés&#13;&#10;                               // si réduit, vérifier sa position si le cadre doit être retourné --&#62; exclusion                                   &#13;&#10;                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                               or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                               begin&#13;&#10;                                       if (((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))&#13;&#10;                                       or ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))   &#13;&#10;                                       or ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)))&#13;&#10;                                       AND (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                       begin&#13;&#10;                                               // les reduit ne peuvent être que dans cette position C ou D&#13;&#10;                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                       // profile A                                                             &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                       // profile B                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                       // profile C                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                       // profile D                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                       // profile E                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';&#13;&#10;                                                       &#13;&#10;                                               sql := sqls + sql;&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');&#13;&#10;                                               result := 1;                                                                                   &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               //exclusion le ou les réduits nécéssitent un retournement du cadre mais seuil en A donc exclusion&#13;&#10;                                               // ou le Cadre avec Seuil a été retourné au préalable pour cause de dépassement de dimension                                                                                                                                                                                                                                                              &#13;&#10;                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');                                                                                                          &#13;&#10;                                       end;                                                 &#13;&#10;                                                                                                                                                                                                                                                                                            &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       // pas de réduit et seuil en A pas de retournement&#13;&#10;                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                       begin                                                   &#13;&#10;                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                       // profile A                                                             &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                       // profile B                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                       // profile C                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                       // profile D                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                       // profile E                                      &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';&#13;&#10;                                               sql := sqls + sql;&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');&#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               // le Cadre avec Seuil a été retourné au préalable pour cause de dépassement de dimension                                                                                                                                                                                                                                                              &#13;&#10;                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                               replacesql('tables', sql);&#13;&#10;                                               execsql('tables');                                                                                            &#13;&#10;                                       end;                                                 &#13;&#10;                               end;                                                                          &#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin&#13;&#10;                               if &#60;traitement.&#34;seuilC&#34;&#62; = 1 then&#13;&#10;                               begin&#13;&#10;                                       if &#60;traitement.&#34;traverse&#34;&#62; &#60;&#62; '0' then&#13;&#10;                                       begin&#13;&#10;                                               // traverse horizontale obligatoire car pas de traverse verticale avec un seuil&#13;&#10;                                               if (&#60;traitement.&#34;ver_dim_axe_trav_2&#34;&#62; = 1) or (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1) then&#13;&#10;                                               begin&#13;&#10;                                                       //exclusion l'axe de la traverse retournée n'entre pas dans les dimensions maxi et mini&#13;&#10;                                                       // ou le cadre a été retourné pour cause de dépassement de dimension                                                                                                                                                                                                                     &#13;&#10;                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                       replacesql('tables', sql);&#13;&#10;                                                       execsql('tables');&#13;&#10;&#13;&#10;                                                       // voir si autre traitement à faire                                                                                                                                     &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       // vérifier les profiles réduits, s'il y en a, s'ils sont bien positionnés&#13;&#10;                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                                       begin&#13;&#10;                                                               // le seul réduit qui peut suivre le seuil C doit être en bord B car quand demi tour Bord B va en D&#13;&#10;                                                               // le bord C est réservé au seuil donc s'il y a un réduit ailleurs qu'en B --&#62; exclusion&#13;&#10;                                                               if (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0)&#13;&#10;                                                               and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_E&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_axe_trav_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       // calculer la rotation de l'axe traverse&#13;&#10;                                                                       // avec un seuil, traverse horiz obligatoire&#13;&#10;                                                                       // hauteur1 := inttostr(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       // axe_traverse := inttostr(vartostr(report.getdataset('traitement').value('hauteur_trav')));&#13;&#10;                                                                       // + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))                                                                                                                                            &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               &#13;&#10;                                                                                 &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                            &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion un ou plusieurs profiles réduits ne sont pas bien positionnés&#13;&#10;                                                                       // ou alors les profiles sont bien positionnés mais l'axe traverse n'est plus dans les dimensiosn mini et maxi                                                                                                                                                                                                                                                                                                                             &#13;&#10;                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                                                                                                     &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               // pas de réduit avec seuil en C et traverse horizontale (pas de fichage car dormant)                                                            &#13;&#10;                                                               // faire un demi tour et (qt = 0) pas de retournement&#13;&#10;                                                               // calculer la rotation de l'axe traverse&#13;&#10;                                                               // avec un seuil, traverse horiz obligatoire&#13;&#10;                                                               // hauteur1 := inttostr(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                               // axe_traverse := inttostr(vartostr(report.getdataset('traitement').value('hauteur_trav')));&#13;&#10;                                                                                                                                  &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       // + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))                                                                         &#13;&#10;                                                                         &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                           &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               // si Seuil C et pas de traverse faire un demi tour obligatoirement pour positionner le seuil C en bord C&#13;&#10;                                               // si un autre retournement doit être fait (profile réduit) --&#62; exclusion&#13;&#10;                                               // vérifier les profiles réduits, s'il y en a, s'ils sont bien positionnés&#13;&#10;                                               // seul un profile réduit en B peut être utilisé dans ce cas                                                                                                                                                                                                  &#13;&#10;                                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                               or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                               begin&#13;&#10;                                                       // le seul réduit qui peut suivre le seuil C doit être en bord B car uand demi tour Bord B va en D&#13;&#10;                                                       // le bord C est réservé au seuil donc s'il y a un réduit ailleurs qu'en B --&#62; exclusion&#13;&#10;                                                       if (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0)&#13;&#10;                                                       and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_E&#34;&#62; = 0) and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                       begin&#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                                            &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //exclusion un ou plusieurs profiles réduits ne sont pas bien positionnés&#13;&#10;                                                               // ou alors le cadre a été retourné pour cause de dépassement de dimension                                                                                                                                                                                                                                  &#13;&#10;                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                                                                                                                     &#13;&#10;                                                       end;                                                                                                            &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       // pas de réduit avec seuil en C (pas de fichage car dormant)                                                            &#13;&#10;                                                       // faire un demi tour et (qt = 0) pas de retournement&#13;&#10;                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then           &#13;&#10;                                                       begin                                                                                                                                                                                                                                        &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //exclusion si le cadre a été retourné pour cause de dépassement de dimension                                                                                                                                                                                                                                                                                                  &#13;&#10;                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                            &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;  &#13;&#10;                                                 &#13;&#10;                                       end;                                                 &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       // PAS DE SEUILS                        &#13;&#10;                                       //vérifier si traverse puis vérifier si réduit&#13;&#10;                                       if &#60;traitement.&#34;traverse&#34;&#62; &#60;&#62; '0' then&#13;&#10;                                       begin&#13;&#10;                                               // traverse horizontale ou verticale &#13;&#10;                                               if &#60;traitement.&#34;ver_dim_axe_trav_2&#34;&#62; = 1 then&#13;&#10;                                               begin&#13;&#10;                                                       // axe traverse retournée pas dans dimension mini et maxi                                                                                                                                                                                                                                        &#13;&#10;                                                       // soit les réduits sont bien positionnés soit 1/4 de tour possible si pas excl_dim                                                                                                                                                                                                                                               &#13;&#10;                                                       // les réduits sont soit en (C et D) soit en (D et A) soit en A, D, C&#13;&#10;                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                                       begin&#13;&#10;                                                               if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))&#13;&#10;                                                               or ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))   &#13;&#10;                                                               or ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'V' then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // on est dans le cas ou on a un réduit en C ou en D avec une traverse verticale&#13;&#10;                                                                               // si reduit en C avec traverse verticale -- 3/4 de tour verifier ver_dim_2                                                                                        &#13;&#10;                                                                               // si reduit en D avec traverse verticale -- exclusion car 1/4 de tour et ver_dim_axe_trav2 = 1&#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // exclusion&#13;&#10;                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                           &#13;&#10;                                                                               end;&#13;&#10;                                                                                 &#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                                       begin                                                                                                   &#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                       //changement rapport hauteur largeur                                                                                                                                                                                                                                                                                                       &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       //pas de changement d'axe traverse position ok                                                                                                                                                                                                   &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');&#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // exclusion plus possible de retourner le cadre&#13;&#10;                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // exclusion plus possible de retourner le cadre&#13;&#10;                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                                                                                                            &#13;&#10;                                                                               end;&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               // traverse horizontale&#13;&#10;                                                                               // les réduit sont bien positionnés                                                                                                                                                                                                                       &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');&#13;&#10;                                                                       end;                                                                                                                                                                  &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) &#13;&#10;                                                                       or ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0))) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // exclusion pas retournable ou axe traverse pas dans les dimensions maxi et mini&#13;&#10;                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                           &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                               &#13;&#10;                                                                               if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;traverse&#34;&#62; = 'H') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1)) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // 1/2 tour à faire position de l'axe ok car redevient comme d'origine&#13;&#10;                                                                                       // changer l'axe traverse&#13;&#10;                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                           &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                                                                                                                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                                               //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');&#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin   &#13;&#10;                                                                                       //exclusion tous les autres cas qu'on soit en retourn_dim = 1 ou = 0 sont impossibles à gérer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &#13;&#10;                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');&#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0))&#13;&#10;                                                                               or ((&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0)) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0) and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1) and (&#60;traitement.&#34;traverse&#34;&#62; = 'V') then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // 3/4 tour à faire position de l'axe ok car redevient comme d'origine&#13;&#10;                                                                                               // changer l'axe traverse&#13;&#10;                                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                   &#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                       //changer rapport largeur / hauteur                                                                                                                                                                                   &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                                                       //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                                                                                                                                                                                                             &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               //exclusion&#13;&#10;                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0)) then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // 3/4 de tour changer rapport largeur / hauteur&#13;&#10;                                                                                                       // changer l'axe traverse&#13;&#10;                                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                           &#13;&#10;                                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                               //changer rapport largeur / hauteur                                                                                                                                                                                   &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                                                               //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                               // profile A                                                             &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                               // profile B                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                               // profile C                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                               // profile D                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                               // profile E                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                       sql := sqls + sql;&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                           &#13;&#10;                                                                                               end&#13;&#10;                                                                                               else&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       //exclusion plus d'un quart de tour à faire et axe traverse retrounée dont dimension dépasse mini et maxi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &#13;&#10;                                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                                                                                                                            &#13;&#10;                                                                                               end;                                                                                                             &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               //exclusion plus d'un quart de tour à faire et axe traverse retrounée dont dimension dépasse mini et maxi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &#13;&#10;                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                                                                                                            &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                                                                                                          &#13;&#10;                                                                                                                                                                  &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //si pas de réduit positionner normalement en fonction de la traverse&#13;&#10;                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') &#13;&#10;                                                               or ((&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0)) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // si la traverse est horizontale et qu'elle n'a pas été retournée par cause de dépassement de dimension positionner le cadre tel quel&#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables'); &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // repositionner la traverse&#13;&#10;                                                                                       //hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                       //axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                                                                                            &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               &#13;&#10;                                                                                               //+ ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))	&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables'); &#13;&#10;                                                                               end;&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                                // si la traverse est verticale faire 3/4 de tour pour éviter les problèmes de dépassement axe traverse                                                                                                                                                                                  &#13;&#10;                                                                                sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       // changer le rapport hauteur/largeur                                                                                                                                                                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion traverse non retournable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &#13;&#10;                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                            &#13;&#10;                                                               end;&#13;&#10;                                                                                                                                 &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       // traverse mais pas de prob de retournement ATTENTION traverse toujours en horizontal                                                                                                                                                                                                                                                                                   &#13;&#10;                                                       // vérifier les profiles réduits, s'il y en a, s'ils sont bien positionnés&#13;&#10;                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                                       begin   &#13;&#10;                                                               // Si C et D ou C ou D -- positionnement ok pas de retournement&#13;&#10;                                                               // Si A et D ou A et traverse V -- 1/4 de tour changer hauteur et largeur                                                          &#13;&#10;                                                               // si B et A ou B -- 1/2 tour&#13;&#10;                                                               // si C et B ou C et traverse V -- 3/4 de tour changer hauteur et largeur                                                                                                                                          &#13;&#10;                                                               if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) &#13;&#10;                                                               or ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))        &#13;&#10;                                                               or ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                                               begin                                                                                                                                                                            &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');&#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // exclusion car cadre par retournable et traverse verticale&#13;&#10;                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                           &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if (&#60;traitement.&#34;traverse&#34;&#62; = 'V') then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // réduit en C et traverse verticale:&#13;&#10;                                                                                               // seul cas possible si retourn_dim = 0 faire 3/4 de tour verifier ver_dim_2&#13;&#10;                                                                                               if (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                               // changer rapport largeur / hauteur                                                                                                                                                                                              &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))                                                                                                                                                  &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                               // profile A                                                             &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                               // profile B                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                               // profile C                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                               // profile D                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                               // profile E                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                       sql := sqls + sql;&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                                                                                                                                                                                                                                     &#13;&#10;                                                                                               end&#13;&#10;                                                                                               else&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // exclusion impossible de retourner car déspassement de dimension&#13;&#10;                                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                             &#13;&#10;                                                                                               end;                                                                                                         &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // traverse horizontale et profile réduit en C&#13;&#10;                                                                                               // position ok&#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                              &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))                                                                                                                                                  &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'V' then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // reduit en D et traverse verticale&#13;&#10;                                                                                               // 1/4 de tour et changer position axe traverse&#13;&#10;                                                                                               if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       //changer position axe traverse&#13;&#10;                                                                                                       // largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur'));&#13;&#10;                                                                                                       // axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav'));                                                                                                                                                                                                            &#13;&#10;                                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                               // changer rapport largeur / hauteur                                                                                                                                                                                              &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                               &#13;&#10;                                                                                                               // + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))                                                                                                                  &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                               // profile A                                                             &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                               // profile B                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                               // profile C                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                               // profile D                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                               // profile E                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                       sql := sqls + sql;&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');&#13;&#10;                                                                                               end&#13;&#10;                                                                                               else&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // exclusion pas possible de retourner un cadre déja retourné&#13;&#10;                                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                           &#13;&#10;                                                                                               end;                                                                                                         &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // reduit en D et traverse horizontale&#13;&#10;                                                                                               //position ok&#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                              &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))                                                                                                                  &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end                                                                       &#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))&#13;&#10;                                                                       or ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if (&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // 1/4 de tour et changer rapport largeur / hauteur et axe traverse&#13;&#10;                                                                                               //changer axe traverse&#13;&#10;                                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));                                                                                                   &#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                       // 1/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                               &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))                                                                                                           &#13;&#10;                                                                                                       //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                                                                                                                                                                                                             &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               //exclusion&#13;&#10;                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end;&#13;&#10;&#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // 1/2 tour à faire et change rapport axe traverse&#13;&#10;                                                                                               //changer axe traverse&#13;&#10;                                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));                                                                                                   &#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))                                                                                                           &#13;&#10;                                                                                                       //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                                                                                                                                                                                                                             &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else    &#13;&#10;                                                                                       begin&#13;&#10;                                                                                               if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // Si A et D ou A et traverse V -- 1/4 de tour changer hauteur et largeur&#13;&#10;                                                                                                       //changer axe traverse&#13;&#10;                                                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));                                                                                                           &#13;&#10;                                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                               // 1/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))                                                                                                                   &#13;&#10;                                                                                                               //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur_trav')))&#13;&#10;                                                                                                               // profile A                                                             &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                               // profile B                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                               // profile C                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                               // profile D                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                               // profile E                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                       sql := sqls + sql;&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                                                                                                                            &#13;&#10;                                                                                               end&#13;&#10;                                                                                               else&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // exclusion&#13;&#10;                                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                           &#13;&#10;                                                                                               end;                                                                                                         &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0))&#13;&#10;                                                                               or ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0))) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // si B et A 1/2 tour&#13;&#10;                                                                                                       //changer axe traverse&#13;&#10;                                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));                                                                                                           &#13;&#10;                                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))                                                                                                                   &#13;&#10;                                                                                                               //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                               // profile A                                                             &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                               // profile B                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                               // profile C                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                               // profile D                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                               // profile E                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                       sql := sqls + sql;&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                                                                                                                            &#13;&#10;                                                                                               end&#13;&#10;                                                                                               else&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // exclusion si traverse verticale&#13;&#10;                                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                           &#13;&#10;                                                                                               end;                                                                                                         &#13;&#10;                                                                                       end;&#13;&#10;&#13;&#10;                                                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       // 1/2 tour a faire&#13;&#10;                                                                                                       //changer axe traverse&#13;&#10;                                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));                                                                                                           &#13;&#10;                                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                               &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))                                                                                                                   &#13;&#10;                                                                                                               //+ ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                               // profile A                                                             &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                               // profile B                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                               // profile C                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                               // profile D                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                               // profile E                                      &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                       sql := sqls + sql;&#13;&#10;                                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                                       execsql('tables');                                                                                                           &#13;&#10;                                                                                               end&#13;&#10;                                                                                               else&#13;&#10;                                                                                               begin&#13;&#10;                                                                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                                                       begin&#13;&#10;                                                                                                               // 3/4 de tour a faire&#13;&#10;                                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                                       // changer rapport largeur / hauteur                                                                                                                                                                                                      &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                                       // profile A                                                             &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                                       // profile B                                      &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                                       // profile C                                      &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                                       // profile D                                      &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                                       // profile E                                      &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                               sql := sqls + sql;&#13;&#10;                                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                                               execsql('tables');                                                                                                                                                                                                                            &#13;&#10;                                                                                                       end&#13;&#10;                                                                                                       else&#13;&#10;                                                                                                       begin&#13;&#10;                                                                                                               // exclusion&#13;&#10;                                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                                               execsql('tables');                                                                                                                   &#13;&#10;                                                                                                       end;                                                                                                                 &#13;&#10;                                                                                               end;                                                                                                         &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0)&#13;&#10;                                                                                       and (&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;retourn_dim&#34;&#62;=0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                       begin                                                                                                                                                                            &#13;&#10;                                                                                               // si C et B ou C et traverse V -- 3/4 de tour changer hauteur et largeur&#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                       // 3/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                                               &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               //exclusion mauvaise position des réduits ou traverse horizontale retournée&#13;&#10;                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               // pas de reduit verifier par rapport aux traverses                                                                                                                                                                                                                                        &#13;&#10;                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') &#13;&#10;                                                               or ((&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0)) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // si la traverse est horizontale et qu'elle n'a pas été retournée par cause de dépassement de dimension positionner le cadre tel quel&#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables'); &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // repositionner la traverse&#13;&#10;                                                                                       //hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                       //axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                                                                                            &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               &#13;&#10;                                                                                               //+ ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))	&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables'); &#13;&#10;                                                                               end;&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                                // si la traverse est verticale faire 3/4 de tour pour éviter les problèmes de dépassement axe traverse                                                                                                                                                                                  &#13;&#10;                                                                                sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       // changer le rapport hauteur/largeur                                                                                                                                                                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion traverse non retournable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &#13;&#10;                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                            &#13;&#10;                                                               end;                                                                           &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               //PAS DE TRAVERSE                                    &#13;&#10;                                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                               or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                               begin   &#13;&#10;                                                       // Si C et D ou C ou D -- positionnement ok pas de retournement&#13;&#10;                                                       // Si A et D ou A et traverse V -- 1/4 de tour changer hauteur et largeur                                                          &#13;&#10;                                                       // si B et A ou B -- 1/2 tour&#13;&#10;                                                       // si C et B ou C et traverse V -- 3/4 de tour changer hauteur et largeur                                                                                                                                          &#13;&#10;                                                       if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) &#13;&#10;                                                       or ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))        &#13;&#10;                                                       or ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                       begin&#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                                            &#13;&#10;                                                       end                                                                       &#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               if (((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))&#13;&#10;                                                               or ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)))&#13;&#10;                                                               and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // Si A et D ou A et traverse V -- 1/4 de tour changer hauteur et largeur&#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       // 1/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                               &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                                                                                                             &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // 1/2 tour&#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                                                                                                                                                                                                                                              &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                           &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       //exclusion&#13;&#10;                                                                                               sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                                                                                                            &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0))&#13;&#10;                                                                       or ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0))) then&#13;&#10;                                                                       begin                                                                                                                                                            &#13;&#10;                                                                               // si B et A ou B -- 1/2 tour&#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                           &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               if ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0)) &#13;&#10;                                                                               and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                                               begin                                                                                                                                                                            &#13;&#10;                                                                                       // si C et B ou C et traverse V -- 3/4 de tour changer hauteur et largeur&#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               // 3/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                                               &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                                   &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       //exclusion mauvaise position des réduits ou traverse horizontale retournée&#13;&#10;                                                                                       sql := 'delete from simple_dormant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                                   &#13;&#10;                                                                               end;                                                                                                 &#13;&#10;                                                                       end;                                                                                         &#13;&#10;                                                               end;                                                                                 &#13;&#10;                                                       end;                                                                         &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       //pas de réduits                                                                                                                                                                                 &#13;&#10;                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                               // profile A                                                             &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                               // profile B                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                               // profile C                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                               // profile D                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                               // profile E                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                       sql := sqls + sql;&#13;&#10;                                                       replacesql('tables', sql);&#13;&#10;                                                       execsql('tables');                                                                           &#13;&#10;                                               end;                                                                                                  &#13;&#10;                                       end;                                           &#13;&#10;                                                                                                                                                                                                               &#13;&#10;                                                                                     &#13;&#10;                               end;&#13;&#10;                       end;                                 &#13;&#10;                 end;                                 &#13;&#10;               end;                         &#13;&#10;         end;           &#13;&#10;           &#13;&#10;// OUVRANTS&#13;&#10;  &#13;&#10;         'ouvrant':&#13;&#10;         begin&#13;&#10;               case assemblage of&#13;&#10;//DOUBLE OUVRANT                                                               &#13;&#10;                 'double':&#13;&#10;                 begin&#13;&#10;                       // pas de seuil ni traverses&#13;&#10;                       // profile reduit + fichage&#13;&#10;                       // cadre du bas sans réduit et cadre du haut avec réduit&#13;&#10;                       sqld := 'insert into traitement_rotox6_' + type_cadre + '(`ko`, `en`, `po`, `fn`, `fc`, `rb`, `rh`, `pe`, `sa`, `sb`, `sc`, `sd`, '&#13;&#10;                               + '`se`, `eb`, `di`, `mo`, `mu`, `ea`, `fa`, `bc`, `rd`, `qt`, `ko2`, `en2`, `po2`, `fn2`, `fc2`, `rb2`, `rh2`, `pe2`, `sa2`, '&#13;&#10;                               + '`sb2`, `sc2`, `sd2`, `se2`, `eb2`, `di2`, `mo2`, `mu2`, `ea2`, `fa2`, `bc2`, `rd2`, `qt2`) values (';&#13;&#10;                                 &#13;&#10;                       sql := 'select * from `double_ouvrant` where `recno` in (' + inttostr(cadre1) + ', ' + inttostr(cadre2) + ')';&#13;&#10;                       replacesql('traitement', sql);&#13;&#10;                       execsql('traitement');&#13;&#10;                       report.getdataset('traitement').close;&#13;&#10;                       report.getdataset('traitement').open;                                                                                                   &#13;&#10;                       firstrecord('traitement');&#13;&#10;                       res1 := 0;&#13;&#10;                       res2 := 0;&#13;&#10;                       hauteur1 := 0;&#13;&#10;                       hauteur2 := 0;&#13;&#10;                       largeur1 := 0;&#13;&#10;                       largeur2 := 0;&#13;&#10;&#13;&#10;                       sqlred := '';&#13;&#10;                       sql := '';&#13;&#10;                         &#13;&#10;                       case type_assemblage of&#13;&#10;                         'H=' :&#13;&#10;                         begin&#13;&#10;//HAUTEURS EGALES&#13;&#10;                               while not queryeof('traitement') do&#13;&#10;                               begin                                           &#13;&#10;                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then preduit := 1 else preduit := 0;&#13;&#10;&#13;&#10;                                       case preduit of&#13;&#10;                                               // traitement du cadre avec profile réduit (cadre du haut) profile réduit en C montant fiché en A&#13;&#10;                                               // Hauteurs égales seulement 1/4 ou 3/4 de tour autorisé -- la hauteur va en largeur !!!                                                                                                                                                                                                                                                                &#13;&#10;                                         1:                                             &#13;&#10;                                         begin   &#13;&#10;                                                 // Si D -- positionnement ok pas de retournement&#13;&#10;                                                 // Si A -- 1/4 de tour changer hauteur et largeur                                                          &#13;&#10;                                                 // si B -- 1/2 tour&#13;&#10;                                                 // si C -- 3/4 de tour changer hauteur et largeur                                                                                                                                          &#13;&#10;                                                 if ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                 begin&#13;&#10;                                                       // hauteurs égales 1/4 de tour à faire d'office, le réduit en D va en C                                                                                                                                                                                                                                                                           &#13;&#10;                                                         if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                         begin&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               // changer rapport hauteur / largeur                                                                                                                                                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       &#13;&#10;                                                                       // le cadre avec profile réduit est traité&#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                    &#13;&#10;                                                                       res1 := 1;&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       res1 := 0;                                                                                                                                                                   &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end&#13;&#10;                                                         else&#13;&#10;                                                         begin&#13;&#10;                                                                 case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                   'B':&#13;&#10;                                                                   begin &#13;&#10;                                                                         // 1/4 de tour à faire&#13;&#10;                                                                         // vérifier si le cadre n'a pas déja été retourné par dépassement de dimension&#13;&#10;                                                                         // vérifier si le cadre une fois retourné ne dépasse pas les dimensions mini et maxi&#13;&#10;&#13;&#10;                                                                         if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                         begin                                                                                     &#13;&#10;                                                                               sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                         //1/4 de tour la hauteur devient largeur                                                                                                                                                                           &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                         // profile A                                                             &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                         // profile B                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                         // profile C                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                         // profile D                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                         // profile E                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                 &#13;&#10;                                                                                 &#13;&#10;                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                 res1 := 1;&#13;&#10;                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                     &#13;&#10;                                                                         end&#13;&#10;                                                                         else&#13;&#10;                                                                         begin&#13;&#10;                                                                               //le cadre ne peut être retourné pour cause de dépassement de dimension&#13;&#10;                                                                               res1 := 0;                                                                                                       &#13;&#10;                                                                         end;                                                                                   &#13;&#10;                                                                   end;&#13;&#10;                                                                   else&#13;&#10;                                                                   begin&#13;&#10;                                                                         //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                                         // le cadre avec profile réduit n'est pas traité                                                                                                                                                                                                                                     &#13;&#10;                                                                         res1 := 0;                                                                                                                                              &#13;&#10;                                                                   end;                                                                   &#13;&#10;                                                                 end;                                                                 &#13;&#10;                                                         end;                                                         &#13;&#10;                                                 end                                                                       &#13;&#10;                                                 else&#13;&#10;                                                 begin&#13;&#10;                                                         if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))&#13;&#10;                                                         and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                         begin&#13;&#10;                                                                 if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                                 begin&#13;&#10;                                                                         if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                         begin                                                                                                                                                                                                                                                                                                   &#13;&#10;                                                                                 // Si  A -- 1/4 de tour changer hauteur et largeur&#13;&#10;                                                                                 sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                         // 1/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                               &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                         // profile A                                                             &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                         // profile B                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                         // profile C                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                         // profile D                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                         // profile E                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                &#13;&#10;        &#13;&#10;                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                 res1 := 1;&#13;&#10;                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                     &#13;&#10;                                                                         end&#13;&#10;                                                                         else&#13;&#10;                                                                         begin&#13;&#10;                                                                               //le cadre ne peut être retourné pour cause de dépassement de dimension&#13;&#10;                                                                               res1 := 0;                                                                                                                                                              &#13;&#10;                                                                         end;                                                                                   &#13;&#10;                                                                 end&#13;&#10;                                                                 else&#13;&#10;                                                                 begin                     &#13;&#10;                                                                         case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                           'C':&#13;&#10;                                                                           begin &#13;&#10;                                                                                 // 1/4 de tour à faire et qt=0        &#13;&#10;                                                                                 // vérifier si le cadre n'a pas déja été retourné par dépassement de dimension&#13;&#10;                                                                                 // vérifier si le cadre une fois retourné ne dépasse pas les dimensions mini et maxi&#13;&#10;        &#13;&#10;                                                                                 if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                 begin                                                                                     &#13;&#10;                                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                 //1/4 de tour la hauteur devient largeur                                                                                                                                                                           &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                 // profile A                                                             &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                 // profile B                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                 // profile C                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                 // profile D                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                 // profile E                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                         &#13;&#10;                                                                                         &#13;&#10;                                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                                         res1 := 1;&#13;&#10;                                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                     &#13;&#10;                                                                                 end&#13;&#10;                                                                                 else&#13;&#10;                                                                                 begin&#13;&#10;                                                                                       //le cadre ne peut être retourné pour cause de dépassement de dimension&#13;&#10;                                                                                       res1 := 0;                                                                                                       &#13;&#10;                                                                                 end;                                                                                   &#13;&#10;                                                                           end;&#13;&#10;                                                                           else&#13;&#10;                                                                           begin&#13;&#10;                                                                                 //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                                                 // le cadre avec profile réduit n'est pas traité                                                                                                                                                                                                                                     &#13;&#10;                                                                                 res1 := 0;                                                                                                                                              &#13;&#10;                                                                           end;                                                                   &#13;&#10;                                                                       end;                                                                           &#13;&#10;                                                                 end;                                                                 &#13;&#10;                                                         end&#13;&#10;                                                         else&#13;&#10;                                                         begin&#13;&#10;                                                                 if ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) then  &#13;&#10;                                                                 begin&#13;&#10;                                                                         if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                                         begin&#13;&#10;                                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                               begin                                                                                           &#13;&#10;                                                                                       // si reduit en B et pas de fichage -- 3/4 tour&#13;&#10;                                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               //changement rapport largeur / hauteur                                                                                                                                                                                 &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       &#13;&#10;                                                                                           &#13;&#10;                                                                                       // le cadre avec profile réduit est traité&#13;&#10;                                                                                       res1 := 1;&#13;&#10;                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       //exclusion car dépassement de dimensions                                                                                                                                                                                                                                                                &#13;&#10;                                                                                       res1 := 0;                                                                                                                                                                                                &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                         end&#13;&#10;                                                                         else&#13;&#10;                                                                         begin&#13;&#10;                                                                                 case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                                   'D':&#13;&#10;                                                                                   begin&#13;&#10;                                                                                         // si reduit en B et fichage en D obligatoirement -- 3/4 tour&#13;&#10;                                                                                         // vérifier si le cadre n'a pas déja été retourné par dépassement de dimension&#13;&#10;                                                                                         // vérifier si le cadre une fois retourné ne dépasse pas les dimensions mini et maxi&#13;&#10;                &#13;&#10;                                                                                         if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                         begin                                                                                             &#13;&#10;                                                                                                 sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                         // 3/4 de tour changer les rapports hauteur/largeur                                                                                                                                                                                                                  &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                         // profile A                                                             &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                         // profile B                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                         // profile C                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                         // profile D                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                         // profile E                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                         + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                                 &#13;&#10;        &#13;&#10;                                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                                 res1 := 1;&#13;&#10;                                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                                     &#13;&#10;                                                                                         end&#13;&#10;                                                                                         else&#13;&#10;                                                                                         begin&#13;&#10;                                                                                               // le cadre ne peut pas être retourné pour cause de dépassement de dimension&#13;&#10;                                                                                               res1 := 0;                                                                                                                       &#13;&#10;                                                                                         end;                                                                                                   &#13;&#10;                                                                                   end;&#13;&#10;                                                                                   else&#13;&#10;                                                                                   begin&#13;&#10;                                                                                         // exclusion montant fiché pas parallèle au profile réduit&#13;&#10;                                                                                         // le cadre avec profile réduit n'est pas traité&#13;&#10;                                                                                         res1 := 0;                                                                                                                                                                                                                                               &#13;&#10;                                                                                   end;                                                                                   &#13;&#10;                                                                                 end;                                                                                 &#13;&#10;                                                                         end;                                                                         &#13;&#10;                                                                 end&#13;&#10;                                                                 else&#13;&#10;                                                                 begin&#13;&#10;                                                                         if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) &#13;&#10;                                                                         and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                         begin&#13;&#10;                                                                               //profile réduit en C 3/4 de tour à faire si pas de fichage                                                                                                                                                                                                                                                                                                                                      &#13;&#10;                                                                                 if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                                                 begin&#13;&#10;                                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                       begin                                                                                                   &#13;&#10;                                                                                               sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                       // 3/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                                               &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               &#13;&#10;                &#13;&#10;                                                                                               // le cadre avec profile réduit est traité&#13;&#10;                                                                                               res1 := 1;&#13;&#10;                                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               //exclusion car dépassement de dimension                                                                                                                                                                                                                                                                              &#13;&#10;                                                                                               res1 := 0;                                                                                                                                                                                                                &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                                 end&#13;&#10;                                                                                 else&#13;&#10;                                                                                 begin   &#13;&#10;                                                                                         case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                                           'A':&#13;&#10;                                                                                           begin &#13;&#10;                                                                                                 // 3/4 de tour à faire et qt = 0                     &#13;&#10;                                                                                                 // vérifier si le cadre n'a pas déja été retourné par dépassement de dimension&#13;&#10;                                                                                                 // vérifier si le cadre une fois retourné ne dépasse pas les dimensions mini et maxi&#13;&#10;                        &#13;&#10;                                                                                                 if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                                 begin                                                                                     &#13;&#10;                                                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                                 //1/4 de tour la hauteur devient largeur                                                                                                                                                                           &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                                 // profile A                                                             &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                                 // profile B                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                                 // profile C                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                                 // profile D                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                                 // profile E                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                                 + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                         &#13;&#10;                                                                                                         &#13;&#10;                                                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                                                         res1 := 1;&#13;&#10;                                                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                     &#13;&#10;                                                                                                 end&#13;&#10;                                                                                                 else&#13;&#10;                                                                                                 begin&#13;&#10;                                                                                                       //le cadre ne peut être retourné pour cause de dépassement de dimension&#13;&#10;                                                                                                       res1 := 0;                                                                                                       &#13;&#10;                                                                                                 end;                                                                                   &#13;&#10;                                                                                           end;&#13;&#10;                                                                                           else&#13;&#10;                                                                                           begin&#13;&#10;                                                                                                 //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                                                                 // le cadre avec profile réduit n'est pas traité                                                                                                                                                                                                                                     &#13;&#10;                                                                                                 res1 := 0;                                                                                                                                              &#13;&#10;                                                                                           end;                                                                   &#13;&#10;                                                                                         end;                                                                           &#13;&#10;                                                                                 end;                                                                                 &#13;&#10;                                                                         end&#13;&#10;                                                                         else&#13;&#10;                                                                         begin&#13;&#10;                                                                                 //exclusion mauvaise position des réduits ou traverse horizontale retournée&#13;&#10;                                                                                 // le cadre avec profile réduit n'est pas traité&#13;&#10;                                                                                 res1 := 0;                                                                                                   &#13;&#10;                                                                         end;                                                                                                 &#13;&#10;                                                                 end;                                                                                         &#13;&#10;                                                         end;                                                                                 &#13;&#10;                                                 end;                                                                         &#13;&#10;                                         &#13;&#10;                                                                                                                            &#13;&#10;                                         end;&#13;&#10;&#13;&#10;                                         0:&#13;&#10;                                         begin&#13;&#10;                                               if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                               begin                                                                                              &#13;&#10;                                                       //pas de fichage ni réduit -- 1/4 de tour à faire&#13;&#10;                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                       begin&#13;&#10;                                                               //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                               if res2 = 1 then &#13;&#10;                                                               begin&#13;&#10;                                                                       res1 := 1;&#13;&#10;                                                                       sqlred := ''', ' + sql + ''')';                                                                                                       &#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                                                                                                                             &#13;&#10;                                                               end                                                                                                                                  &#13;&#10;                                                               else &#13;&#10;                                                               begin&#13;&#10;                                                                       res2 := 1;&#13;&#10;                                                                       hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                       largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                   &#13;&#10;                                                               end;&#13;&#10;                                                                 &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       //changer rapport hauteur/largeur                                                                                                                                     &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' ;   &#13;&#10;                                                               &#13;&#10;                                                               &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //exclusion car dépassement de dimensions                                                                                                                                                                                                            &#13;&#10;                                                               res1 := 0;                                                                                                                                                &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end&#13;&#10;                                               else                                                         &#13;&#10;                                               begin&#13;&#10;                                                       case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                         'A':&#13;&#10;                                                         begin&#13;&#10;                                                               //pas de réduits et fichage en A -- 3/4 de tour&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                        //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                       if res2 = 1 then&#13;&#10;                                                                       begin&#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               sqlred := ''', ' + sql + ''')';                                                                                                               &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       end                                                                                                                                                &#13;&#10;                                                                       else &#13;&#10;                                                                       begin&#13;&#10;                                                                               res2 := 1;&#13;&#10;                                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       end;                                                                                                                                            &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               // changer rapport largeur/ hauteur                                                                                                                                                           &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0';   &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       res1 := 0;                                                                                                                                                                &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'B':&#13;&#10;                                                         begin&#13;&#10;                                                               //pas de réduits et fichage en B -- 1/4 de tour&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                       if res2 = 1 then&#13;&#10;                                                                       begin&#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               sqlred := ''', ' + sql + ''')';                                                                                   &#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                       end                                                                                                                                                &#13;&#10;                                                                       else &#13;&#10;                                                                       begin&#13;&#10;                                                                               res2 := 1;&#13;&#10;                                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                       end;&#13;&#10;                                                                         &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                         &#13;&#10;                                                                               //changement rapport hauteur/largeur                                                                          &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1';   &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion car dépassement de dimension&#13;&#10;                                                                       res1 := 0;                                                                                               &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'C':&#13;&#10;                                                         begin&#13;&#10;                                                               // fichage en C et pas de réduit -- 1/4 tour et qt=0&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                       if res2 = 1 then&#13;&#10;                                                                       begin&#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               sqlred := ''', ' + sql + ''')';                                                                                   &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       end                                                                                                                                                &#13;&#10;                                                                       else &#13;&#10;                                                                       begin&#13;&#10;                                                                               res2 := 1;&#13;&#10;                                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       end;&#13;&#10;                                                                         &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               // changer rapport largeur / hauteur                                                                                                                                                          &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0';   &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //Exclusion car dépassement de dimensions&#13;&#10;                                                                       res1 := 0;&#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'D':&#13;&#10;                                                         begin&#13;&#10;                                                               // fichage en D et pas de réduit -- 3/4 de tour&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                       if res2 = 1 then&#13;&#10;                                                                       begin&#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               sqlred := ''', ' + sql + ''')';                                                                                   &#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                       end                                                                                                                                                &#13;&#10;                                                                       else &#13;&#10;                                                                       begin&#13;&#10;                                                                               res2 := 1;&#13;&#10;                                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                       end;&#13;&#10;                                                                         &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               //changement rapport hauteur/largeur                                                                                                                                                   &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1';   &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //Exclusion car dépassement de dimensions&#13;&#10;                                                                       res1 := 0;                                                                                            &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;                                                                   &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                         end;&#13;&#10;                                       end;                                                                                            &#13;&#10;                                       nextrecord('traitement');                                                                                           &#13;&#10;                               end;                                                 &#13;&#10;                               &#13;&#10;// FIN HAUTEURS EGALES                                                                                  &#13;&#10;                         end;                                                                                                         &#13;&#10;                         'L=':&#13;&#10;                         begin&#13;&#10;// LARGEURS EGALES             &#13;&#10;                               while not queryeof('traitement') do&#13;&#10;                               begin                                           &#13;&#10;                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then preduit := 1 else preduit := 0;&#13;&#10;&#13;&#10;                                       case preduit of&#13;&#10;                                         // traitement du cadre avec profile réduit (cadre du haut) profile réduit en C montant fiché en A                                                                                                                                                                                                                                                                                                                                                          &#13;&#10;                                         1:                                             &#13;&#10;                                         begin   &#13;&#10;                                                 // Si D -- 1/4 de tour changer hauteur et largeur                                                                       &#13;&#10;                                                 // Si A -- 1/2 tour                                                           &#13;&#10;                                                 // si B -- 3/4 de tour changer hauteur et largeur     &#13;&#10;                                                 // si C -- position ok                                                                                                                                                               &#13;&#10;                                                 if ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                 begin&#13;&#10;                                                         if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                         begin&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               // changer rapport hauteur et largeur                                                                                                                                                         &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                      &#13;&#10;                                                                       // le cadre avec profile réduit est traité                                                                                                                                                                                                                                     &#13;&#10;                                                                       res1 := 1;&#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       // le cadre peut rester tel quel&#13;&#10;                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                         &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       &#13;&#10;                                                                       // le cadre avec profile réduit est traité                                                                                                                                                                                                                                     &#13;&#10;                                                                       res1 := 1;&#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                           &#13;&#10;                                                                                                                                                                                                                                       &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end&#13;&#10;                                                         else&#13;&#10;                                                         begin&#13;&#10;                                                                 case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                   'B':&#13;&#10;                                                                   begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin                                                                                                                                                &#13;&#10;                                                                                 // 1/4 de tour à faire&#13;&#10;                                                                                 sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                         //1/4 de tour la hauteur devient largeur                                                                                                                                                                           &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                         // profile A                                                             &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                         // profile B                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                         // profile C                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                         // profile D                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                         // profile E                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                 &#13;&#10;                                                                                 &#13;&#10;                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                 res1 := 1;&#13;&#10;                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                             &#13;&#10;                                                                          &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               // le cadre peut rester tel quel&#13;&#10;                                                                               sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                         &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                              &#13;&#10;                                                                               // le cadre avec profile réduit est traité                                                                                                                                                                                                                                     &#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                                                                                                                                                             &#13;&#10;                                                                       end;&#13;&#10;                                                                   end;&#13;&#10;                                                                     &#13;&#10;                                                                   else&#13;&#10;                                                                   begin&#13;&#10;                                                                         //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                                         // le cadre avec profile réduit n'est pas traité                                                                                                                                                                                                                                     &#13;&#10;                                                                         res1 := 0;                                                                                                                                              &#13;&#10;                                                                   end;                                                                   &#13;&#10;                                                                 end;                                                                 &#13;&#10;                                                         end;                                                         &#13;&#10;                                                 end                                                                       &#13;&#10;                                                 else&#13;&#10;                                                 begin&#13;&#10;                                                         if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                         begin&#13;&#10;                                                                 if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                                 begin                                                                                                            &#13;&#10;                                                                         // Si  A -- 1/2 de tour&#13;&#10;                                                                         sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                 // profile A                                                             &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                 // profile B                                      &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                 // profile C                                      &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                 // profile D                                      &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                 // profile E                                      &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                 + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;&#13;&#10;                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                         res1 := 1;&#13;&#10;                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                             &#13;&#10;                                                                 end&#13;&#10;                                                                 else&#13;&#10;                                                                 begin&#13;&#10;                                                                         case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                           'C':&#13;&#10;                                                                           begin&#13;&#10;                                                                               //si réduit en A -- bord fiché en C obligatoirement -- 1/2 tour                                                                                                                                                                                                                                                                                                        &#13;&#10;                                                                               sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                         // profile A                                                             &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                         // profile B                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                         // profile C                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                         // profile D                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                         // profile E                                      &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                         + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                 &#13;&#10;                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                 res1 := 1;&#13;&#10;                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                     &#13;&#10;                                                                           end;&#13;&#10;                                                                           else&#13;&#10;                                                                           begin&#13;&#10;                                                                                 // exclusion montant fiché pas parallèle au profile réduit&#13;&#10;                                                                                 // le cadre avec profile réduit n'est pas traité&#13;&#10;                                                                                 res1 := 0;                                                                           &#13;&#10;                                                                           end;                                                                           &#13;&#10;                                                                         end;                                                                         &#13;&#10;                                                                 end;                                                                 &#13;&#10;                                                         end&#13;&#10;                                                         else&#13;&#10;                                                         begin&#13;&#10;                                                                 if ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) then  &#13;&#10;                                                                 begin&#13;&#10;                                                                         if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                                         begin                                                                                                                            &#13;&#10;                                                                                 // si reduit en B et pas de fichage -- 3/4 tour ou 1/2             &#13;&#10;                                                                                 if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                 begin                                                                                     &#13;&#10;                                                                                         sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                 // 3/4 de tour changer les rapports hauteur/largeur                                                                                                                                                                                                                  &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                 // profile A                                                             &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                 // profile B                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                 // profile C                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                 // profile D                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                 // profile E                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                                                                                                  &#13;&#10;                                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                                         res1 := 1;&#13;&#10;                                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                 end&#13;&#10;                                                                                 else&#13;&#10;                                                                                 begin&#13;&#10;                                                                                       // 1/2 tour à faire si le cadre ne peut pas être retourné d'un quart de tour                                                                                                                                                                                                                                                                                                                                                               &#13;&#10;                                                                                       sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                  &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                 // profile A                                                             &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                 // profile B                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                 // profile C                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                 // profile D                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                 // profile E                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                         &#13;&#10;                                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                                         res1 := 1;&#13;&#10;                                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                                                                                                              &#13;&#10;                                                                                 end;                                                                                           &#13;&#10;                                                                         end&#13;&#10;                                                                         else&#13;&#10;                                                                         begin&#13;&#10;                                                                                 case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                                   'D':&#13;&#10;                                                                                   begin&#13;&#10;                                                                                         if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                                         begin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   &#13;&#10;                                                                                                 // si reduit en B et fichage en D obligatoirement -- 3/4 tour&#13;&#10;                                                                                                 sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                         // 3/4 de tour changer les rapports hauteur/largeur                                                                                                                                                                                                                  &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                         // profile A                                                             &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                         // profile B                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                         // profile C                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                         // profile D                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                         // profile E                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                         + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                                         &#13;&#10;                                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                                 res1 := 1;&#13;&#10;                                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                         end&#13;&#10;                                                                                         else&#13;&#10;                                                                                         begin&#13;&#10;                                                                                               // 1/2 tour à faire si le cadre ne peut pas être retourné d'un quart de tour                                                                                                                                                                                                                                                                                                                                                               &#13;&#10;                                                                                               sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                  &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                         // profile A                                                             &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                         // profile B                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                         // profile C                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                         // profile D                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                         // profile E                                      &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                         + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                         + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                         + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                         + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                                                                                                                                  &#13;&#10;                                                                                                 // le cadre avec profile réduit est traité&#13;&#10;                                                                                                 res1 := 1;&#13;&#10;                                                                                                 largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                                                 hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                                                                                                                                  &#13;&#10;                                                                                         end;                                                                                                   &#13;&#10;                                                                                   end;&#13;&#10;                                                                                   else&#13;&#10;                                                                                   begin&#13;&#10;                                                                                         // exclusion montant fiché pas parallèle au profile réduit&#13;&#10;                                                                                         // le cadre avec profile réduit n'est pas traité&#13;&#10;                                                                                         res1 := 0;                                                                                                                                                                                                                                                                                                                                                                         &#13;&#10;                                                                                   end;                                                                                   &#13;&#10;                                                                                 end;                                                                                 &#13;&#10;                                                                         end;                                                                         &#13;&#10;                                                                 end&#13;&#10;                                                                 else&#13;&#10;                                                                 begin&#13;&#10;                                                                         if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) then&#13;&#10;                                                                         begin&#13;&#10;                                                                                 if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                                                 begin                                                                                                                                            &#13;&#10;                                                                                         // positionnement ok&#13;&#10;                                                                                         sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                 // profile A                                                             &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                 // profile B                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                 // profile C                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                 // profile D                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                 // profile E                                      &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                 + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                         &#13;&#10;                                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                                         res1 := 1;&#13;&#10;                                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                             &#13;&#10;                                                                                 end&#13;&#10;                                                                                 else&#13;&#10;                                                                                 begin&#13;&#10;                                                                                         case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                                           'A':&#13;&#10;                                                                                           begin&#13;&#10;                                                                                                 if (&#60;traitement.&#34;reduit_C&#34;&#62; = 1) then&#13;&#10;                                                                                                 begin&#13;&#10;                                                                                                         // positionnement ok&#13;&#10;                                                                                                         sqlred := ''', ''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                                 // profile A                                                             &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                                 // profile B                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                                 // profile C                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                                 // profile D                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                                 // profile E                                      &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                                 + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                                 + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                                 + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                                 + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                                                                                                                                                  &#13;&#10;                                                                                                         // le cadre avec profile réduit est traité&#13;&#10;                                                                                                         res1 := 1;&#13;&#10;                                                                                                         hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                                         largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                                                             &#13;&#10;                                                                                                 end&#13;&#10;                                                                                                 else&#13;&#10;                                                                                                 begin&#13;&#10;                                                                                                         //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                                                                         // le cadre avec profile réduit n'est pas traité&#13;&#10;                                                                                                         res1 := 0;                                                                           &#13;&#10;                                                                                                 end;                                                                         &#13;&#10;                                                                                           end;                                                                                                                                                                                                                                                            &#13;&#10;                                                                                         end;                                                                                         &#13;&#10;                                                                                 end;                                                                                 &#13;&#10;                                                                         end&#13;&#10;                                                                         else&#13;&#10;                                                                         begin&#13;&#10;                                                                                 //exclusion mauvaise position des réduits ou traverse horizontale retournée&#13;&#10;                                                                                 // le cadre avec profile réduit n'est pas traité&#13;&#10;                                                                                 res1 := 0;                                                                                                   &#13;&#10;                                                                         end;                                                                                                 &#13;&#10;                                                                 end;                                                                                         &#13;&#10;                                                         end;                                                                                 &#13;&#10;                                                 end;                                                                         &#13;&#10;                                         &#13;&#10;                                                                                                                            &#13;&#10;                                         end;&#13;&#10;&#13;&#10;                                         0:&#13;&#10;                                         begin&#13;&#10;                                               if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                               begin&#13;&#10;                                                       //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                       if res2 = 1 then &#13;&#10;                                                       begin&#13;&#10;                                                               res1 := 1;&#13;&#10;                                                               sqlred := ''', ' + sql + ''')';                                                                                                                                      &#13;&#10;                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                       end&#13;&#10;                                                       else &#13;&#10;                                                       begin&#13;&#10;                                                               res2 := 1;&#13;&#10;                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                       end;&#13;&#10;                                                         &#13;&#10;                                                       //pas de fichage ni réduit                                                                                                                                                                                                                   &#13;&#10;                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                               // profile A                                                             &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                               // profile B                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                               // profile C                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                               // profile D                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                               // profile E                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                               + ''', ''' + '0' + ''', ''' + '0';   &#13;&#10;                                               end&#13;&#10;                                               else                                                         &#13;&#10;                                               begin&#13;&#10;                                                       case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                         'A':&#13;&#10;                                                         begin&#13;&#10;                                                               //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                               if res2 = 1 then &#13;&#10;                                                               begin&#13;&#10;                                                                       res1 := 1;&#13;&#10;                                                                       sqlred := ''', ' + sql + ''')';                                                                           &#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                               end&#13;&#10;                                                               else &#13;&#10;                                                               begin&#13;&#10;                                                                       res2 := 1;&#13;&#10;                                                                       hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       largeur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                               end;&#13;&#10;                                                                 &#13;&#10;                                                               //pas de réduits et fichage en a -- position ok                                                                                                                                                                                                                                                   &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '1';   &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'B':&#13;&#10;                                                         begin&#13;&#10;                                                               //pas de réduits et fichage en B -- 1/4 de tour&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                               if res2 = 1 then &#13;&#10;                                                                               begin&#13;&#10;                                                                                       res1 := 1;&#13;&#10;                                                                                       sqlred := ''', ' + sql + ''')';                                                                                           &#13;&#10;                                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                                               end&#13;&#10;                                                                               else &#13;&#10;                                                                               begin&#13;&#10;                                                                                       res2 := 1;&#13;&#10;                                                                                       largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                                       hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                                               end;&#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                         &#13;&#10;                                                                                       //changement rapport hauteur/largeur                                                                          &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1';   &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                               if res2 = 1 then &#13;&#10;                                                                               begin&#13;&#10;                                                                                       res1 := 1;&#13;&#10;                                                                                       sqlred := ''', ' + sql + ''')';                                                                                           &#13;&#10;                                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                   &#13;&#10;                                                                               end&#13;&#10;                                                                               else &#13;&#10;                                                                               begin&#13;&#10;                                                                                       res2 := 1;&#13;&#10;                                                                                       largeur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                       hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                   &#13;&#10;                                                                               end;&#13;&#10;                                                                                 &#13;&#10;                                                                               //le cadre ne peut pas être retourné car dépassement de dimension mais est bien placé et Qt = 0                                                                                                                                                                                                                                                                                                                                                                          &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                          &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0';   &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //le cadre ne peut pas être retourné pour cause de dépassement de dimensions                                                                                                                                                                               &#13;&#10;                                                                       res1 := 0;                                                                                               &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'C':&#13;&#10;                                                         begin&#13;&#10;                                                               //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                               if res2 = 1 then &#13;&#10;                                                               begin&#13;&#10;                                                                       res1 := 1;&#13;&#10;                                                                       sqlred := ''', ' + sql + ''')';                                                                           &#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                               end&#13;&#10;                                                               else &#13;&#10;                                                               begin&#13;&#10;                                                                       res2 := 1;&#13;&#10;                                                                       hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       largeur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                               end;&#13;&#10;                                                                 &#13;&#10;                                                               // fichage en C et pas de réduit -- 1/2 tour                                                                                                                                                                                                                                           &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '1';   &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'D':&#13;&#10;                                                         begin&#13;&#10;                                                               // fichage en D et pas de réduit -- 3/4 de tour ou 1/2 et qt=0                               &#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                       if res2 = 1 then &#13;&#10;                                                                       begin&#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               sqlred := ''', ' + sql + ''')';                                                                                   &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));     &#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                   &#13;&#10;                                                                       end&#13;&#10;                                                                       else &#13;&#10;                                                                       begin&#13;&#10;                                                                               res2 := 1;&#13;&#10;                                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                   &#13;&#10;                                                                       end;&#13;&#10;                                                                         &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               //changement rapport hauteur/largeur                                                                                                                                                   &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1';   &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //Dans le cas ou on aurait 2 cadres sans profiles réduits                                                                                                                                                                                     &#13;&#10;                                                                       if res2 = 1 then &#13;&#10;                                                                       begin&#13;&#10;                                                                               res1 := 1;&#13;&#10;                                                                               sqlred := ''', ' + sql + ''')';                                                                                   &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));     &#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                                       end&#13;&#10;                                                                       else &#13;&#10;                                                                       begin&#13;&#10;                                                                               res2 := 1;&#13;&#10;                                                                               hauteur2 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                               largeur2 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));                                                                   &#13;&#10;                                                                       end;&#13;&#10;                                                                         &#13;&#10;                                                                       // la cadre ne peut pas être retourné d' 1/4 ou de 3/4 mais peut être retourné d'1/2 avec qt=0                                                                                                                                                                                                                                                                                                                                                                &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                   &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0';   &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;                                                                   &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                         end;&#13;&#10;                                       end;                                                                                            &#13;&#10;                                       nextrecord('traitement');                                                                                           &#13;&#10;                               end;    &#13;&#10;                               //result := 1;&#13;&#10;// FIN LARGEURS EGALES                                                                                  &#13;&#10;                         end;                           &#13;&#10;                         &#13;&#10;                           &#13;&#10;                       end;&#13;&#10;&#13;&#10;                       //Vérification de la valeur de res1 et de res2 pour voir si les 2 cadres peuvent être testés&#13;&#10;                       // si oui vérification que les 2 cadres aient été retournés pareillement&#13;&#10;                       //le résultat renvoyé permettra d'envoyer les 2 lignes vers la table ou de passer à l'élément suivant de la requete pour de nouveau tester                                                                                                                                                                                                                                                                                                                                        &#13;&#10;                       if (res1 = 1) and (res2 = 1) then&#13;&#10;                       begin&#13;&#10;                               if largeur1 = largeur2 then&#13;&#10;                               begin&#13;&#10;                                       sql := sqld + sql + sqlred;&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');&#13;&#10;                                         &#13;&#10;                                       result := 1;                                                                                                      &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       result := 0;                                                                                                        &#13;&#10;                               end;&#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin&#13;&#10;                               result := 0;                                                                                      &#13;&#10;                       end;                                 &#13;&#10;                 end;&#13;&#10;&#13;&#10;                 'simple':&#13;&#10;//SIMPLE OUVRANT                       &#13;&#10;                 begin &#13;&#10;                       // traverse présente&#13;&#10;                       // profile réduit&#13;&#10;                       // fichage privilégier fichage en B pour éviter retournement&#13;&#10;                       // si position en A et plus retournable laisser comme ca et mettre qt à 1&#13;&#10;                       // PAS DE SEUILS                        &#13;&#10;                       //vérifier si traverse puis vérifier si réduit&#13;&#10;                       sql := 'select * from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                       replacesql('traitement', sql);&#13;&#10;                       execsql('traitement');&#13;&#10;                       report.getdataset('traitement').close;&#13;&#10;                       report.getdataset('traitement').open;                                                                                                   &#13;&#10;                       firstrecord('traitement');&#13;&#10;                         &#13;&#10;                       sqls := 'insert into traitement_rotox6_' + type_cadre + ' (`ko`, `en`, `po`, `fn`, `fc`, `rb`, `rh`, `pe`, `sa`, `sb`, `sc`, `sd`, '&#13;&#10;                               +'`se`, `eb`, `di`, `mo`, `mu`, `ea`, `fa`, `bc`, `rd`, `qt`) values (';&#13;&#10;                                 &#13;&#10;                       if &#60;traitement.&#34;traverse&#34;&#62; &#60;&#62; '0' then&#13;&#10;                       begin&#13;&#10;                               // traverse horizontale ou verticale &#13;&#10;                               if &#60;traitement.&#34;ver_dim_axe_trav_2&#34;&#62; = 1 then&#13;&#10;                               begin&#13;&#10;                                       // axe traverse retournée pas dans dimension mini et maxi                                                                                                                                                                                                                                        &#13;&#10;                                       // soit les réduits sont bien positionnés soit 1/4 de tour possible si pas excl_dim                                                                                                                                                                                                                                               &#13;&#10;                                       // les réduits sont soit en (C et D) soit en (D et A) soit en A, D, C&#13;&#10;                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                       begin&#13;&#10;                                               if ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))  then&#13;&#10;                                               begin&#13;&#10;                                                       if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                       begin&#13;&#10;                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                            &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       // exclusion pas de retournement possible&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //Si fichage                                                                                                                                                                                                                       &#13;&#10;                                                               if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = 'B') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                               begin&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                                                                                                     &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       // dans tous les autres cas il faut exclure le cadre s'il y a un fichage&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;&#13;&#10;                                                       end;                                                                                                                                  &#13;&#10;                                               end;&#13;&#10;                                                 &#13;&#10;                                               if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                               begin&#13;&#10;                                                       if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                       begin&#13;&#10;                                                               if trim(&#60;traitement.&#34;traverse&#34;&#62;) = 'V' then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if &#60;traitement.&#34;ver_dim_2&#34;&#62; = 0 then&#13;&#10;                                                                               begin                                                                                           &#13;&#10;                                                                                       // reduit en C et traverse Verticale et pas de fichage -- 3/4 de tour                                                                                                                                                                                                                                                                                                 &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               //changer rapport largeur/hauteur                                                                                                                                                                 &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');&#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // exclusion car si 1/4 ou 3/4 de tour dépassement de dimension                                                                                                                                                                                                                                                                                                                        &#13;&#10;                                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                                                                                                            &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                       begin                                                                                   &#13;&#10;                                                                               // reduit en C et traverse Horiontale et pas de fichage -- Positionnement ok                                                                                                                                                                                                                                                                                                                                       &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                 &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //les réduits sont bien positionnés et fichage&#13;&#10;                                                               if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = 'A' then&#13;&#10;                                                               begin &#13;&#10;                                                                     if &#60;traitement.&#34;retourn_dim&#34;&#62; = 1 then&#13;&#10;                                                                     begin&#13;&#10;                                                                             //Exclusion&#13;&#10;                                                                             sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                             replacesql('tables', sql);&#13;&#10;                                                                             execsql('tables');                                                                                   &#13;&#10;                                                                     end&#13;&#10;                                                                     else&#13;&#10;                                                                     begin&#13;&#10;                                                                             // réduit en C, fichage en A, traverse verticale -- 3/4 de tour à faire                                                                                                                                                                                                                                                                                                                                                                                                             &#13;&#10;                                                                             if &#60;traitement.&#34;traverse&#34;&#62; = 'V' then&#13;&#10;                                                                             begin&#13;&#10;                                                                                     if &#60;traitement.&#34;ver_dim_2&#34;&#62; = 0 then&#13;&#10;                                                                                     begin                                                                                                   &#13;&#10;                                                                                             sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                                     //changer rapport largeur/hauteur                                                                                                                                                                             &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                     // profile A                                                             &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                     // profile B                                      &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                     // profile C                                      &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                     // profile D                                      &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                     // profile E                                      &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                     + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                     + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                     + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                             sql := sqls + sql;&#13;&#10;                                                                                             replacesql('tables', sql);&#13;&#10;                                                                                             execsql('tables');&#13;&#10;                                                                                     end&#13;&#10;                                                                                     else&#13;&#10;                                                                                     begin&#13;&#10;                                                                                             // exclusion car si 1/4 ou 3/4 de tour dépassement de dimension                                                                                                                                                                                                                                                                                                                        &#13;&#10;                                                                                             sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                             replacesql('tables', sql);&#13;&#10;                                                                                             execsql('tables');&#13;&#10;                                                                                     end;                                                                                                                                                                                                  &#13;&#10;                                                                             end&#13;&#10;                                                                             else&#13;&#10;                                                                             begin&#13;&#10;                                                                                     sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                             // profile A                                                             &#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                             // profile B                                      &#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                             // profile C                                      &#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                             // profile D                                      &#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                             // profile E                                      &#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                             + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                             + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                             + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                             + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                     sql := sqls + sql;&#13;&#10;                                                                                     replacesql('tables', sql);&#13;&#10;                                                                                     execsql('tables');                                                                                                                                                                            &#13;&#10;                                                                             end;                                                                                         &#13;&#10;                                                                     end;  &#13;&#10;                                                               end;                                                                                                                                                                                                                                                                                                                                                                          &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0)) then&#13;&#10;                                                       begin&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1) and (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                               begin&#13;&#10;                                                                       //faire un demi tour et changer l'axe traverse&#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                                &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       //réduit en A avec traverse et Ver_dim_axe_trav = 1 -- exclusion dans tous les cas                                                                                                                                                                                                                                                                                                            &#13;&#10;                                                                       // exclusion montant fiché pas parralèle au profile réduit&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end;                                                                                                                                                  &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               if ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0)) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1) and (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                                       begin&#13;&#10;                                                                               //faire un 1/2 tour et changer axe traverse&#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));       &#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));&#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                 &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                                     // profile A                                                             &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                     // profile B                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                     // profile C                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                     // profile D                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                     // profile E                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                     + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                     + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                     + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                             sql := sqls + sql;&#13;&#10;                                                                             replacesql('tables', sql);&#13;&#10;                                                                             execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;&#13;&#10;                                                                         &#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin   &#13;&#10;                                                                               //vdat=1 et réduit en B et fichage en D ou sans fichage retourner de 3/4 de tour&#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                     //changer rapport largeur / hauteur                                                                                                                                                                 &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                     // profile A                                                             &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                     // profile B                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                     // profile C                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                     // profile D                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                     // profile E                                      &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                     + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                     + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                     + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                     + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                             sql := sqls + sql;&#13;&#10;                                                                             replacesql('tables', sql);&#13;&#10;                                                                             execsql('tables');                                                                                                                                                                    &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       //exclusion autre cas de réduit                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       &#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end;                                                                                                                                                  &#13;&#10;                                                       end;                                                                                 &#13;&#10;                                               end;                                                                         &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                               begin                                                           &#13;&#10;                                                       //si pas de réduit et pas de fichage positionner normalement&#13;&#10;                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                       begin&#13;&#10;                                                               if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //faire un 1/2 tour pour remettre l'axe traverse correctement                                                                       &#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                                &#13;&#10;&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               if &#60;traitement.&#34;ver_dim_2&#34;&#62; = 0 then&#13;&#10;                                                               begin&#13;&#10;                                                                       // pas de reduit, pas de fichage, traverse Verticale, retourner de 3/4 de tour                                                                                                                                                                                                                                                                                  &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               //changer rapport largeur /hauteur                                                                                                                                                                                                                                                                                                                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                            &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       // exclusion pas possible de retourner le cadre car dépassement de dimension&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                         'A' :&#13;&#10;                                                         begin&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                                       begin                                                                                   &#13;&#10;                                                                               //place qt à 1 car bord fiché en A                                                                                                                                                                                                        &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //retourner de 3/4 de tour pour place bord fiché en B                                                                                                                                                                                                                                                                                                                                    &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       //changer rapport largeur / hauteur                                                                                                                                                                   &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                                                                                                             &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                         &#13;&#10;                                                         'B' :&#13;&#10;                                                         begin&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       // bien positionné et qt à 0 car bord fiché à B&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                         &#13;&#10;                                                         'C':&#13;&#10;                                                         begin&#13;&#10;                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1) and (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       // 1/2 tour et bord fiché vient de C à A donc bien positionné, qt = 1                                                                                                                                                                                                                                                                                             &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;&#13;&#10;                                                         'D':&#13;&#10;                                                         begin&#13;&#10;                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'V') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       // 3/4 de tour et qt = 1&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               //changer rapport largeur / hauteur                                                                                                                                                           &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                                                                                                                     &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') and (&#60;traitement.&#34;retourn_dim&#34;&#62; = 1) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 1/2 tour et changer axe traverse qt =0&#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                                       &#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //tous les autres cas = exclusion&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         else&#13;&#10;                                                         begin&#13;&#10;                                                               // exclusion maximum 1/4 de tour permis dans ce cas&#13;&#10;                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                                                                                                             &#13;&#10;                                                         end;                                                                   &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                       end;                                                                 &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       // traverse mais pas de prob de retournement                                                                                                                                                                                            &#13;&#10;                                       // vérifier les profiles réduits, s'il y en a, s'ils sont bien positionnés&#13;&#10;                                       if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                                       or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                                       begin   &#13;&#10;                                               // Si C ou D -- positionnement ok pas de retournement&#13;&#10;                                               // Si A et traverse V -- 1/4 de tour changer hauteur et largeur                                                          &#13;&#10;                                               // si B -- 1/2 tour&#13;&#10;                                               // si C et traverse V -- 3/4 de tour changer hauteur et largeur&#13;&#10;                                               if ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                               begin&#13;&#10;                                                       if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '') or (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = 'B') then&#13;&#10;                                                       begin&#13;&#10;                                                               if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                       begin&#13;&#10;                                                                               //positionnement ok&#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 1/4 de tour à faire&#13;&#10;                                                                               // qt = 1, ok si ver_dim_2 = 0 et changer axe traverse&#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       //changer rapport largeur/ hauteur                                                                                                                                                                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                       begin&#13;&#10;                                                                               //positionnement ok&#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               // exclusion&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //Exclusion le bord fiché n'est pas parallèle au profile réduit&#13;&#10;                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                   &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;&#13;&#10;                                                 &#13;&#10;                                               if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                               begin&#13;&#10;                                                       if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '') or (&#60;traitement.&#34;bord_fichage&#34;&#62; = 'A') then&#13;&#10;                                                       begin&#13;&#10;                                                               if (&#60;traitement.&#34;traverse&#34;&#62; = 'H') then&#13;&#10;                                                               begin&#13;&#10;                                                                       // position ok mais Qt = 1                                                                                                                                                                                                    &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 3/4 de tour voir si ver_dim_2 = 0 et mettre qt = 1&#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));            &#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_traverse')));&#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       // changer rapport largeur/hauteur                                                                                                                                                                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               // exclusion&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin                                 &#13;&#10;                                                               // exclusion montant fiché pas parralèle aux profiles réduits&#13;&#10;                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                                                                     &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end                                                                       &#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                                       begin                                                                                                                         &#13;&#10;                                                               if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '') or (&#60;traitement.&#34;bord_fichage&#34;&#62; = 'C') then&#13;&#10;                                                               begin&#13;&#10;                                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                       begin                                                                                   &#13;&#10;                                                                               // Si A et traverse H -- 1/2 tour changer axe traverse qt = 1              &#13;&#10;                                                                               hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));&#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                   &#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // 1/4 de tour et qt = 1&#13;&#10;                                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                                         &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               // changer rapport largeur/hauteur                                                                                                                                                                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                                                                                                            &#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // exclusion&#13;&#10;                                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                           &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin                                 &#13;&#10;                                                                       // exclusion montant fiché pas parralèle aux profiles réduits&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                                              &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               if ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '') or (&#60;traitement.&#34;bord_fichage&#34;&#62; = 'D') then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                                               begin                                                                                           &#13;&#10;                                                                                       // si B -- 1/2 tour&#13;&#10;                                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));                                                                                                                          &#13;&#10;                                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                                         &#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');&#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       if &#60;traitement.&#34;retourn_dim&#34;&#62; = 0 then&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               // si reduit en B et traverse verticale -- 3/4 de tour&#13;&#10;                                                                                                 &#13;&#10;                                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                                       // profile A                                                             &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                                       // profile B                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                                       // profile C                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                                       // profile D                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                                       // profile E                                      &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                               sql := sqls + sql;&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                                                                                                            &#13;&#10;                                                                                       end&#13;&#10;                                                                                       else&#13;&#10;                                                                                       begin&#13;&#10;                                                                                               //exclusion&#13;&#10;                                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                                               replacesql('tables', sql);&#13;&#10;                                                                                               execsql('tables');                                                                                                   &#13;&#10;                                                                                       end;                                                                                                 &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin                                 &#13;&#10;                                                                               // exclusion montant fiché pas parralèle aux profiles réduits&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                                              &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       // exclusion montant fiché pas parralèle aux profiles réduits&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                                                                                                     &#13;&#10;                                                               end;                                                                                         &#13;&#10;                                                       end;                                                                                 &#13;&#10;                                               end;                                                                         &#13;&#10;                                       end&#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               //pas de réduits avec traverse                           &#13;&#10;                                               if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                               begin&#13;&#10;                                                       if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                       begin&#13;&#10;                                                               //traverse horizontale et pas de réduit position ok                                                                                                                                                                                                                                      &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';       &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                                                                            &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               //traverse verticale et pas de réduit 1/4 de tour si ver_dim_2 = 0&#13;&#10;                                                               if &#60;traitement.&#34;ver_dim_2&#34;&#62; = 0 then&#13;&#10;                                                               begin&#13;&#10;                                                                       largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));&#13;&#10;                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                         &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               //changer rapport largeur / hauteur                                                                                                                                                           &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';       &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end;                                                                                                                                                  &#13;&#10;                                                       end;                                                                                                                                  &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                         'A':&#13;&#10;                                                         begin&#13;&#10;                                                               if &#60;traitment.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                               begin&#13;&#10;                                                                       // position ok mais qt = 1                                                 &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                    &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';       &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin                                                                                 &#13;&#10;                                                                               // 3/4 de tour&#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       //3/4 de tour la hauteur va en largeur et vice et versa                                                                                                                                                                                                    &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';       &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //exclusion&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end;                                                                                       &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'B':&#13;&#10;                                                         begin&#13;&#10;                                                               if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       // positionnement ok&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';       &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');  &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 1/4 de tour et qt = 1 et changer axe traverse&#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));    &#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       //changer rapport largeur / hauteur                                                                                                                                                                     &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1' + ''')';       &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                     &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //exclusion                                                                                                                                                                            &#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'C':&#13;&#10;                                                         begin&#13;&#10;                                                               if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                               begin&#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));    &#13;&#10;                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                                        &#13;&#10;                                                                                 &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                    &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';       &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                                                                                                                                       &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 1/4 de tour&#13;&#10;                                                                               largeur1 := strtoint(vartostr(report.getdataset('traitement').value('largeur')));    &#13;&#10;                                                                               axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));                                                                                                                        &#13;&#10;                                                                                 &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       //1/4 de tour la hauteur va en largeur et vice et versa                                                                                                                                                                                                    &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(abs(axe_traverse - largeur1)))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';       &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');  &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //exclusion&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                   &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                                                                                                  &#13;&#10;                                                         end;&#13;&#10;                                                           &#13;&#10;                                                         'D':&#13;&#10;                                                         begin&#13;&#10;                                                               if &#60;traitement.&#34;traverse&#34;&#62; = 'H' then&#13;&#10;                                                               begin                                                                           &#13;&#10;                                                                       // 1/2 tour&#13;&#10;                                                                       hauteur1 := strtoint(vartostr(report.getdataset('traitement').value('hauteur')));    &#13;&#10;                                                                       axe_traverse := strtoint(vartostr(report.getdataset('traitement').value('axe_trav')));&#13;&#10;                                                                         &#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                    &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(abs(axe_traverse - hauteur1)))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';       &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');  &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 3/4  de tour et qt = 1                                                                                                                                                                                                                    &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       //changer rapport largeur / hauteur                                                                                                                                                                   &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1' + ''')';       &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               //exclusion&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                            &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                         end;                                                                   &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                       end;                                                                 &#13;&#10;                               end;                                                         &#13;&#10;                       end&#13;&#10;                       else&#13;&#10;                       begin   &#13;&#10;                               //PAS DE TRAVERSE                                    &#13;&#10;                               if (&#60;traitement.&#34;reduit_A&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_B&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_C&#34;&#62; = 1)&#13;&#10;                               or (&#60;traitement.&#34;reduit_D&#34;&#62; = 1) or (&#60;traitement.&#34;reduit_E&#34;&#62; = 1) then&#13;&#10;                               begin   &#13;&#10;                                       // Si D -- positionnement ok pas de retournement&#13;&#10;                                       // Si A -- 1/4 de tour changer hauteur et largeur                                                          &#13;&#10;                                       // si B -- 1/2 tour&#13;&#10;                                       // si C -- 3/4 de tour changer hauteur et largeur                                                                                                                                          &#13;&#10;                                       if ((&#60;traitement.&#34;reduit_D&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0)) then&#13;&#10;                                       begin&#13;&#10;                                               if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                               begin                                                                                            &#13;&#10;                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                               // profile A                                                             &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                               // profile B                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                               // profile C                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                               // profile D                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                               // profile E                                      &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                       sql := sqls + sql;&#13;&#10;                                                       replacesql('tables', sql);&#13;&#10;                                                       execsql('tables');&#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                         'B':&#13;&#10;                                                         begin &#13;&#10;                                                               // position ok reduti en D et fiché en B                                                                                &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                           &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                           &#13;&#10;                                                         end;&#13;&#10;                                                         else&#13;&#10;                                                         begin&#13;&#10;                                                               //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');                                                                   &#13;&#10;                                                         end;                                                                   &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end;                                                         &#13;&#10;                                       end                                                                       &#13;&#10;                                       else&#13;&#10;                                       begin&#13;&#10;                                               if ((&#60;traitement.&#34;reduit_A&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0))&#13;&#10;                                               and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                               begin&#13;&#10;                                                       if trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '' then&#13;&#10;                                                       begin                                                                                                            &#13;&#10;                                                               // Si  A -- 1/2 tour &#13;&#10;                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                       // profile A                                                             &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                       // profile B                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                       // profile C                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                       // profile D                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                       // profile E                                      &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                               sql := sqls + sql;&#13;&#10;                                                               replacesql('tables', sql);&#13;&#10;                                                               execsql('tables');&#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               case trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) of&#13;&#10;                                                                 'C':&#13;&#10;                                                                 begin&#13;&#10;                                                                       if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                       begin&#13;&#10;                                                                               //réduit en A et fichage en C -- 1/4 de tour                                                                                                                                                                                                                                                            &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                       // 1/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                               &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');&#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin&#13;&#10;                                                                               // 1/2 tour et qt = 1                                                                                                                                                                                                          &#13;&#10;                                                                               sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                       // profile A                                                             &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                       // profile B                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                       // profile C                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                       // profile D                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                       // profile E                                      &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                       + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                       + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                       + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                               sql := sqls + sql;&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                                                                                                              &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                                 end;&#13;&#10;                                                                 else&#13;&#10;                                                                 begin&#13;&#10;                                                                       // exclusion montant fiché pas parallèle au profile réduit&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                           &#13;&#10;                                                                 end;                                                                           &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end;                                                                 &#13;&#10;                                               end&#13;&#10;                                               else&#13;&#10;                                               begin&#13;&#10;                                                       if ((&#60;traitement.&#34;reduit_B&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_C&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) then  &#13;&#10;                                                       begin&#13;&#10;                                                               if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '') or (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = 'D') then&#13;&#10;                                                               begin                                                                                                                            &#13;&#10;                                                                       // si B -- 1/2 tour&#13;&#10;                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                               &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                               // profile A                                                             &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                               // profile B                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                               // profile C                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                               // profile D                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                               // profile E                                      &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                       sql := sqls + sql;&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');&#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin   &#13;&#10;                                                                       // exclusion montant fiché pas parallèle au profile réduit&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                 &#13;&#10;                                                               end;                                                                         &#13;&#10;                                                       end&#13;&#10;                                                       else&#13;&#10;                                                       begin&#13;&#10;                                                               if ((&#60;traitement.&#34;reduit_C&#34;&#62; = 1) and (&#60;traitement.&#34;reduit_D&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_B&#34;&#62; = 0) and (&#60;traitement.&#34;reduit_A&#34;&#62; = 0)) &#13;&#10;                                                               and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                               begin&#13;&#10;                                                                       if (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = '') or (trim(&#60;traitement.&#34;bord_fichage&#34;&#62;) = 'A') then&#13;&#10;                                                                       begin&#13;&#10;                                                                               if (&#60;traitement.&#34;retourn_dim&#34;&#62; = 0) and (&#60;traitement.&#34;ver_dim_2&#34;&#62; = 0) then&#13;&#10;                                                                               begin                                                                                           &#13;&#10;                                                                                       // si C et B ou C et traverse V -- 3/4 de tour changer hauteur et largeur&#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                                                                               // 3/4 de tour la hauteur devient la largeur et vice et versa                                                                                                                                                                                                                                               &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');&#13;&#10;                                                                               end&#13;&#10;                                                                               else&#13;&#10;                                                                               begin&#13;&#10;                                                                                       // position correcte mais qt=1&#13;&#10;                                                                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))                                                                                                                                                                                                                                               &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                                                                               // profile A                                                             &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                                                                               // profile B                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                                                                               // profile C                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                                                                               // profile D                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                                                                               // profile E                                      &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                                                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                                                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                                                                               + ''', ''' + '0' + ''', ''' + '1' + ''')';   &#13;&#10;                                                                                       sql := sqls + sql;&#13;&#10;                                                                                       replacesql('tables', sql);&#13;&#10;                                                                                       execsql('tables');                                                                                           &#13;&#10;                                                                               end;                                                                                         &#13;&#10;                                                                       end&#13;&#10;                                                                       else&#13;&#10;                                                                       begin &#13;&#10;                                                                               //exclusion montant fiché non parallèle au profile réduit&#13;&#10;                                                                               sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                               replacesql('tables', sql);&#13;&#10;                                                                               execsql('tables');                                                                           &#13;&#10;                                                                       end;                                                                                 &#13;&#10;                                                               end&#13;&#10;                                                               else&#13;&#10;                                                               begin&#13;&#10;                                                                       //exclusion mauvaise position des réduits ou traverse horizontale retournée&#13;&#10;                                                                       sql := 'delete from simple_ouvrant where recno =' + inttostr(cadre1);&#13;&#10;                                                                       replacesql('tables', sql);&#13;&#10;                                                                       execsql('tables');                                                                                                   &#13;&#10;                                                               end;                                                                                                 &#13;&#10;                                                       end;                                                                                         &#13;&#10;                                               end;                                                                                 &#13;&#10;                                       end;                                                                         &#13;&#10;                               end&#13;&#10;                               else&#13;&#10;                               begin&#13;&#10;                                       //pas de réduits et pas de traverse                                                                                                                                                                                                                           &#13;&#10;                                       sql := '''' + trim(vartostr(report.getdataset('traitement').value('commande')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('lot')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('repere')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('casier')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('code_couleur')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('largeur')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('hauteur')))&#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('axe_trav')))&#13;&#10;                                               // profile A                                                             &#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_A')))&#13;&#10;                                               // profile B                                      &#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_B')))&#13;&#10;                                               // profile C                                      &#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_C')))&#13;&#10;                                               // profile D                                      &#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_D')))&#13;&#10;                                               // profile E                                      &#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('prof_E')))                &#13;&#10;                                               + ''', ''' + trim(vartostr(report.getdataset('traitement').value('percage')))&#13;&#10;                                               + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1' + ''', ''' + '1'&#13;&#10;                                               + ''', ''' + '0' + ''', ''' + trim(vartostr(report.getdataset('traitement').value('codebarre')))&#13;&#10;                                               + ''', ''' + '0' + ''', ''' + '0' + ''')';   &#13;&#10;                                       sql := sqls + sql;&#13;&#10;                                       replacesql('tables', sql);&#13;&#10;                                       execsql('tables');                                                                           &#13;&#10;                               end;                                                                                                  &#13;&#10;                       end;                           &#13;&#10;                         &#13;&#10;                 end;                                 &#13;&#10;               end;                              &#13;&#10;         end;                   &#13;&#10;       end;                 &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;procedure tri_impression(type_cadre: string;);&#13;&#10;var        &#13;&#10;phase, tpligne, tps, flag_tps : integer;&#13;&#10;&#13;&#10;tpa, tpb, tpc, tpd, tpe, tpa2 : string;                                                                                              &#13;&#10;begin&#13;&#10;       // dimension 1                                             &#13;&#10;       // d'abord les seuils et traverses&#13;&#10;       // simples cadres&#13;&#10;       // doubles cadres&#13;&#10;         &#13;&#10;       // dimension 2&#13;&#10;       &#13;&#10;       // doubles cadres&#13;&#10;       // simples cadres&#13;&#10;       // seuils et traverses&#13;&#10;     &#13;&#10;       sql := 'select * from traitement_rotox6_' + type_cadre + ' where traite = 0'; // order by sa, sb, sc, sd, se, rb, rh';&#13;&#10;       replacesql('resultat', sql);&#13;&#10;       execsql('resultat');          &#13;&#10;         &#13;&#10;       firstrecord('resultat');                  &#13;&#10;       &#13;&#10;       phase := 1;&#13;&#10;       tps:=0;&#13;&#10;       if type_cadre = 'dormant' then&#13;&#10;       begin                   &#13;&#10;               // inscription dans le fichier des informations de dormant&#13;&#10;               f := tfilestream.create(chemin+'SR'+codelot+'-'+numlot+'DO.ROT', fmcreate);                          &#13;&#10;       end&#13;&#10;       else&#13;&#10;       begin                   &#13;&#10;               // inscription dans le fichier des informations d'ouvrant                    &#13;&#10;               f := tfilestream.create(chemin+'SR'+codelot+'-'+numlot+'OU.ROT', fmcreate);                          &#13;&#10;       end;&#13;&#10;         &#13;&#10;       while not queryeof('resultat') do&#13;&#10;       begin&#13;&#10;&#13;&#10;               tpa := trim(&#60;resultat.&#34;sa&#34;&#62;);&#13;&#10;               tpb := trim(&#60;resultat.&#34;sb&#34;&#62;);&#13;&#10;               tpc := trim(&#60;resultat.&#34;sc&#34;&#62;);&#13;&#10;               tpd := trim(&#60;resultat.&#34;sd&#34;&#62;);&#13;&#10;               tpe := trim(&#60;resultat.&#34;se&#34;&#62;);&#13;&#10;               tpa2 := trim(&#60;resultat.&#34;sa2&#34;&#62;);                   &#13;&#10;               tpligne := &#60;resultat.&#34;recno&#34;&#62;;&#13;&#10;         &#13;&#10;               //executer les phases&#13;&#10;               flag_tps := ecriture(type_cadre, phase, tpa, tpb, tpc, tpd, tpe, tpa2, tpligne);                          &#13;&#10;&#13;&#10;               if flag_tps = 0 then tps := 0;&#13;&#10;               if flag_tps = 1 then tps := 1;&#13;&#10;                 &#13;&#10;               if tps=0 then inc(phase,1);&#13;&#10;               if tps=1 then phase := phase - 1;&#13;&#10;       end;&#13;&#10;&#13;&#10;       f.free;&#13;&#10;&#13;&#10;       report.getdataset('impr_'+type_cadre).close;&#13;&#10;       report.getdataset('impr_'+type_cadre).open;           &#13;&#10;           &#13;&#10;end;&#13;&#10;          &#13;&#10;&#13;&#10;function ecriture(type_cadre : string; nphase : integer; etpa, etpb, etpc, etpd, etpe, etpa2: string; etpligne : integer;): integer;&#13;&#10;var      &#13;&#10;ligne : string;&#13;&#10;CR : string;&#13;&#10;sepa : string;                                &#13;&#10;begin&#13;&#10;&#13;&#10;       CR := chr(13) + chr(10);                                                                    &#13;&#10;                     &#13;&#10;       sepa := '%';                                   &#13;&#10;       ligne := '';                          &#13;&#10;         &#13;&#10;       case nphase of&#13;&#10;         0:&#13;&#10;         begin&#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where traite = 0'; // order by sa, sb, sc, sd, se, rb, rh';&#13;&#10;                 replacesql('resultat', sql);                                                   &#13;&#10;                 execsql('resultat');          &#13;&#10;                                                                    &#13;&#10;                 report.getdataset('resultat').close;&#13;&#10;                 report.getdataset('resultat').open;&#13;&#10;                 firstrecord('resultat');                                                                         &#13;&#10;                 result := 0;                                                                      &#13;&#10;         end;&#13;&#10;                   &#13;&#10;         1:&#13;&#10;         begin&#13;&#10;                                                                     &#13;&#10;                 //requete pour simple avec traverses                                                                                                    &#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where trim(sa) =''' +trim(etpa) +''' and trim(sb)='''+trim(etpb) &#13;&#10;                       +''' and trim(sc)=''' + trim(etpc) + ''' and trim(sd)=''' + trim(etpd) +''' and trim(se)&#60;&#62;'''' and trim(sa2)='''' and traite=0';&#13;&#10;                  &#13;&#10;                 replacesql('phase1', sql);&#13;&#10;                 execsql('phase1');&#13;&#10;                  &#13;&#10;                 firstrecord('phase1');&#13;&#10;  &#13;&#10;                 while not queryeof('phase1') do&#13;&#10;                 begin&#13;&#10;                         ligne := 'SMK1%KO'+ trim(&#60;phase1.&#34;ko&#34;&#62;) + sepa + 'EN' + trim(&#60;phase1.&#34;en&#34;&#62;) + sepa + 'PO' + trim(&#60;phase1.&#34;po&#34;&#62;) &#13;&#10;                                 + sepa + 'FN' + trim(&#60;phase1.&#34;fn&#34;&#62;) + sepa + 'FC' + inireadstring(fichierini, 'correspondance couleur:' +trim(&#60;phase1.&#34;fc&#34;&#62;), trim(&#60;phase1.&#34;fc&#34;&#62;)) + sepa + 'RB' + trim(&#60;phase1.&#34;rb&#34;&#62;) &#13;&#10;                                 + sepa + 'RH' + trim(&#60;phase1.&#34;rh&#34;&#62;) + sepa + 'PE' + trim(&#60;phase1.&#34;pe&#34;&#62;) + sepa + 'SA' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase1.&#34;sa&#34;&#62;), trim(&#60;phase1.&#34;sa&#34;&#62;)) &#13;&#10;                                 + sepa + 'SB' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase1.&#34;sb&#34;&#62;), trim(&#60;phase1.&#34;sb&#34;&#62;)) + sepa &#13;&#10;                                 + 'SC' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase1.&#34;sc&#34;&#62;), trim(&#60;phase1.&#34;sc&#34;&#62;)) + sepa &#13;&#10;                                 + 'SD' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase1.&#34;sd&#34;&#62;), trim(&#60;phase1.&#34;sd&#34;&#62;))&#13;&#10;                                 + sepa + 'SE' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase1.&#34;se&#34;&#62;), trim(&#60;phase1.&#34;se&#34;&#62;)) + sepa &#13;&#10;                                 + 'EB' + trim(&#60;phase1.&#34;eb&#34;&#62;) + sepa + 'DI' + trim(&#60;phase1.&#34;di&#34;&#62;)&#13;&#10;                                 + sepa + 'MO' + trim(&#60;phase1.&#34;mo&#34;&#62;) + sepa + 'MU' + trim(&#60;phase1.&#34;mu&#34;&#62;) + sepa + 'EA' + trim(&#60;phase1.&#34;ea&#34;&#62;) &#13;&#10;                                 + sepa + 'FA' + trim(&#60;phase1.&#34;fa&#34;&#62;) + sepa + 'BC' + trim(&#60;phase1.&#34;bc&#34;&#62;) + sepa + 'RD' + trim(&#60;phase1.&#34;rd&#34;&#62;) &#13;&#10;                                 + sepa + 'QT' + trim(&#60;phase1.&#34;qt&#34;&#62;) + CR;&#13;&#10;                                           &#13;&#10;                         f.write(ligne, length(ligne));&#13;&#10;  &#13;&#10;                         sql := 'update traitement_rotox6_' + type_cadre +' set traite = 1 where recno=' + inttostr(&#60;phase1.&#34;recno&#34;&#62;);&#13;&#10;                         replacesql('tables', sql);&#13;&#10;                         execsql('tables');&#13;&#10;&#13;&#10;&#13;&#10;                         sql := 'insert into imprime_rotox6_'+type_cadre +' (ko, en, po, fn) values (''' + trim(&#60;phase1.&#34;ko&#34;&#62;) + ''', '''&#13;&#10;                               + codelot + '-' + numlot + ''', ''' +  trim(&#60;phase1.&#34;po&#34;&#62;) + ''', ''' + trim(&#60;phase1.&#34;fn&#34;&#62;)+''')';&#13;&#10;                         replacesql('tables', sql);&#13;&#10;                         execsql('tables');&#13;&#10;                           &#13;&#10;                         nextrecord('phase1');&#13;&#10;                         if not queryeof('phase1') then etpligne := &#60;phase1.&#34;recno&#34;&#62;;                             &#13;&#10;                 end;&#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where traite = 0'; // order by sa, sb, sc, sd, se, rb, rh';&#13;&#10;                 replacesql('resultat', sql);&#13;&#10;                 execsql('resultat');          &#13;&#10;                                                                    &#13;&#10;                 report.getdataset('resultat').close;&#13;&#10;                 report.getdataset('resultat').open;&#13;&#10;                 firstrecord('resultat');&#13;&#10;                   &#13;&#10;                 result := 2;                                                                    &#13;&#10;         end;&#13;&#10;                   &#13;&#10;         2:&#13;&#10;         begin&#13;&#10;                  //requete pour simple sans traverses                                                                                                    &#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where trim(sa) =''' + trim(etpa) +''' and trim(sb)=''' + trim(etpb)   &#13;&#10;                         + ''' and trim(sc)=''' + trim(etpc) +''' and trim(sd)=''' + trim(etpd) +''' and trim(se)='''' and trim(sa2)='''' and traite=0';&#13;&#10;                  &#13;&#10;                 replacesql('phase2', sql);&#13;&#10;                 execsql('phase2');&#13;&#10;                  &#13;&#10;                 firstrecord('phase2');&#13;&#10;                 while not queryeof('phase2') do&#13;&#10;                 begin                   &#13;&#10;                         ligne := 'SMK1%KO'+ trim(&#60;phase2.&#34;ko&#34;&#62;) + sepa + 'EN' + trim(&#60;phase2.&#34;en&#34;&#62;) + sepa + 'PO' + trim(&#60;phase2.&#34;po&#34;&#62;) &#13;&#10;                                 + sepa + 'FN' + trim(&#60;phase2.&#34;fn&#34;&#62;) + sepa + 'FC' + inireadstring(fichierini, 'correspondance couleur:' +trim(&#60;phase2.&#34;fc&#34;&#62;), trim(&#60;phase2.&#34;fc&#34;&#62;)) + sepa + 'RB' + trim(&#60;phase2.&#34;rb&#34;&#62;) &#13;&#10;                                 + sepa + 'RH' + trim(&#60;phase2.&#34;rh&#34;&#62;) + sepa + 'PE' + trim(&#60;phase2.&#34;pe&#34;&#62;) + sepa + 'SA' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase2.&#34;sa&#34;&#62;), trim(&#60;phase2.&#34;sa&#34;&#62;)) &#13;&#10;                                 + sepa + 'SB' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase2.&#34;sb&#34;&#62;), trim(&#60;phase2.&#34;sb&#34;&#62;)) + sepa &#13;&#10;                                 + 'SC' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase2.&#34;sc&#34;&#62;), trim(&#60;phase2.&#34;sc&#34;&#62;)) + sepa &#13;&#10;                                 + 'SD' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase2.&#34;sd&#34;&#62;), trim(&#60;phase2.&#34;sd&#34;&#62;))&#13;&#10;                                 + sepa + 'SE' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase2.&#34;se&#34;&#62;), trim(&#60;phase2.&#34;se&#34;&#62;)) + sepa &#13;&#10;                                 + 'EB' + trim(&#60;phase2.&#34;eb&#34;&#62;) + sepa + 'DI' + trim(&#60;phase2.&#34;di&#34;&#62;)&#13;&#10;                                 + sepa + 'MO' + trim(&#60;phase2.&#34;mo&#34;&#62;) + sepa + 'MU' + trim(&#60;phase2.&#34;mu&#34;&#62;) + sepa + 'EA' + trim(&#60;phase2.&#34;ea&#34;&#62;) &#13;&#10;                                 + sepa + 'FA' + trim(&#60;phase2.&#34;fa&#34;&#62;) + sepa + 'BC' + trim(&#60;phase2.&#34;bc&#34;&#62;) + sepa + 'RD' + trim(&#60;phase2.&#34;rd&#34;&#62;) &#13;&#10;                                 + sepa + 'QT' + trim(&#60;phase2.&#34;qt&#34;&#62;) + CR;&#13;&#10;                                           &#13;&#10;                         f.write(ligne, length(ligne));&#13;&#10;                                 &#13;&#10;                         sql := 'update traitement_rotox6_' + type_cadre +' set traite = 1 where recno=' + inttostr(&#60;phase2.&#34;recno&#34;&#62;);&#13;&#10;                         replacesql('tables', sql);&#13;&#10;                         execsql('tables');&#13;&#10;&#13;&#10;                         sql := 'insert into imprime_rotox6_'+type_cadre +' (ko, en, po, fn) values (''' + trim(&#60;phase2.&#34;ko&#34;&#62;) + ''', '''&#13;&#10;                               + codelot + '-' + numlot + ''', ''' +  trim(&#60;phase2.&#34;po&#34;&#62;) + ''', ''' + trim(&#60;phase2.&#34;fn&#34;&#62;)+''')';&#13;&#10;                         replacesql('tables', sql);                             &#13;&#10;                         execsql('tables');&#13;&#10;                                                                                                                                                              &#13;&#10;                         nextrecord('phase2');&#13;&#10;                         if not queryeof('phase2') then etpligne := &#60;phase2.&#34;recno&#34;&#62;;                                                       &#13;&#10;                 end;&#13;&#10;&#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where traite = 0'; // order by sa, sb, sc, sd, se, rb, rh';&#13;&#10;                 replacesql('resultat', sql);&#13;&#10;                 execsql('resultat');          &#13;&#10;                                                                    &#13;&#10;                 report.getdataset('resultat').close;&#13;&#10;                 report.getdataset('resultat').open;&#13;&#10;                 firstrecord('resultat');&#13;&#10;                   &#13;&#10;                 result := 2;                                            &#13;&#10;         end;     &#13;&#10;                                    &#13;&#10;         3:&#13;&#10;         begin&#13;&#10;                 //requete pour double                                                                                                  &#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where trim(sa) ='''+trim(etpa) + ''' and trim(sb)=''' + trim(etpb)   &#13;&#10;                         + ''' and trim(sc)=''' + trim(etpc) + ''' and trim(sd)=''' +trim(etpd) + ''' and trim(sa2)&#60;&#62;'''' and traite=0';                                            &#13;&#10;                  &#13;&#10;                 replacesql('phase3', sql);&#13;&#10;                 execsql('phase3');&#13;&#10;                  &#13;&#10;                 firstrecord('phase3');&#13;&#10;                           &#13;&#10;                 while not queryeof('phase3') do&#13;&#10;                 begin                   &#13;&#10;                         ligne := 'SMK1%KO'+ trim(&#60;phase3.&#34;ko&#34;&#62;) + sepa + 'EN' + trim(&#60;phase3.&#34;en&#34;&#62;) + sepa + 'PO' + trim(&#60;phase3.&#34;po&#34;&#62;) &#13;&#10;                                 + sepa + 'FN' + trim(&#60;phase3.&#34;fn&#34;&#62;) + sepa + 'FC' + inireadstring(fichierini, 'correspondance couleur:' +trim(&#60;phase3.&#34;fc&#34;&#62;), trim(&#60;phase3.&#34;fc&#34;&#62;)) + sepa + 'RB' + trim(&#60;phase3.&#34;rb&#34;&#62;) &#13;&#10;                                 + sepa + 'RH' + trim(&#60;phase3.&#34;rh&#34;&#62;) + sepa + 'PE' + trim(&#60;phase3.&#34;pe&#34;&#62;) + sepa + 'SA' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sa&#34;&#62;), trim(&#60;phase3.&#34;sa&#34;&#62;)) &#13;&#10;                                 + sepa + 'SB' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sb&#34;&#62;), trim(&#60;phase3.&#34;sb&#34;&#62;)) + sepa &#13;&#10;                                 + 'SC' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sc&#34;&#62;), trim(&#60;phase3.&#34;sc&#34;&#62;)) + sepa &#13;&#10;                                 + 'SD' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sd&#34;&#62;), trim(&#60;phase3.&#34;sd&#34;&#62;))&#13;&#10;                                 + sepa + 'SE' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;se&#34;&#62;), trim(&#60;phase3.&#34;se&#34;&#62;)) + sepa &#13;&#10;                                 + 'EB' + trim(&#60;phase3.&#34;eb&#34;&#62;) + sepa + 'DI' + trim(&#60;phase3.&#34;di&#34;&#62;)&#13;&#10;                                 + sepa + 'MO' + trim(&#60;phase3.&#34;mo&#34;&#62;) + sepa + 'MU' + trim(&#60;phase3.&#34;mu&#34;&#62;) + sepa + 'EA' + trim(&#60;phase3.&#34;ea&#34;&#62;) &#13;&#10;                                 + sepa + 'FA' + trim(&#60;phase3.&#34;fa&#34;&#62;) + sepa + 'BC' + trim(&#60;phase3.&#34;bc&#34;&#62;) + sepa + 'RD' + trim(&#60;phase3.&#34;rd&#34;&#62;) &#13;&#10;                                 + sepa + 'QT' + trim(&#60;phase3.&#34;qt&#34;&#62;) &#13;&#10;                                 + sepa + 'KO' + trim(&#60;phase3.&#34;ko2&#34;&#62;) + sepa + 'EN' + trim(&#60;phase3.&#34;en2&#34;&#62;) + sepa + 'PO' + trim(&#60;phase3.&#34;po2&#34;&#62;)&#13;&#10;                                 + sepa + 'FN' + trim(&#60;phase3.&#34;fn2&#34;&#62;) + sepa + 'FC' + trim(&#60;phase3.&#34;fc2&#34;&#62;) + sepa + 'RB' + trim(&#60;phase3.&#34;rb2&#34;&#62;) &#13;&#10;                                 + sepa + 'RH' + trim(&#60;phase3.&#34;rh2&#34;&#62;) + sepa + 'PE' + trim(&#60;phase3.&#34;pe2&#34;&#62;) + sepa + 'SA' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sa2&#34;&#62;), trim(&#60;phase3.&#34;sa2&#34;&#62;)) &#13;&#10;                                 + sepa + 'SB' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sb2&#34;&#62;), trim(&#60;phase3.&#34;sb2&#34;&#62;)) + sepa &#13;&#10;                                 + 'SC' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sc2&#34;&#62;), trim(&#60;phase3.&#34;sc2&#34;&#62;)) + sepa &#13;&#10;                                 + 'SD' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;sd2&#34;&#62;), trim(&#60;phase3.&#34;sd2&#34;&#62;))&#13;&#10;                                 + sepa + 'SE' + inireadstring(fichierini, 'correspondance profile:' +trim(&#60;phase3.&#34;se2&#34;&#62;), trim(&#60;phase3.&#34;se2&#34;&#62;)) + sepa &#13;&#10;                                 + 'EB' + trim(&#60;phase3.&#34;eb2&#34;&#62;) + sepa + 'DI' + trim(&#60;phase3.&#34;di2&#34;&#62;)&#13;&#10;                                 + sepa + 'MO' + trim(&#60;phase3.&#34;mo2&#34;&#62;) + sepa + 'MU' + trim(&#60;phase3.&#34;mu2&#34;&#62;) + sepa + 'EA' + trim(&#60;phase3.&#34;ea2&#34;&#62;) &#13;&#10;                                 + sepa + 'FA' + trim(&#60;phase3.&#34;fa2&#34;&#62;) + sepa + 'BC' + trim(&#60;phase3.&#34;bc2&#34;&#62;) + sepa + 'RD' + trim(&#60;phase3.&#34;rd2&#34;&#62;) &#13;&#10;                                 + sepa + 'QT' + trim(&#60;phase3.&#34;qt2&#34;&#62;) + CR;&#13;&#10;                                           &#13;&#10;                         f.write(ligne, length(ligne));&#13;&#10;  &#13;&#10;                         sql := 'update traitement_rotox6_' + type_cadre +' set traite = 1 where recno=' + inttostr(&#60;phase3.&#34;recno&#34;&#62;);&#13;&#10;                         replacesql('tables', sql);&#13;&#10;                         execsql('tables');&#13;&#10;&#13;&#10;                         sql := 'insert into imprime_rotox6_'+type_cadre +' (ko, en, po, fn, ko2, en2, po2, fn2) values (''' + trim(&#60;phase3.&#34;ko&#34;&#62;) + ''', '''&#13;&#10;                               + codelot + '-' + numlot + ''', ''' +  trim(&#60;phase3.&#34;po&#34;&#62;) + ''', ''' + trim(&#60;phase3.&#34;fn&#34;&#62;)+''', ''' + trim(&#60;phase3.&#34;ko2&#34;&#62;) &#13;&#10;                               + ''', ''' + codelot + '-' + numlot + ''', ''' +  trim(&#60;phase3.&#34;po2&#34;&#62;) + ''', ''' + trim(&#60;phase3.&#34;fn2&#34;&#62;)+''')';&#13;&#10;                         replacesql('tables', sql);&#13;&#10;                         execsql('tables');                             &#13;&#10;                                   &#13;&#10;                         nextrecord('phase3');&#13;&#10;                         if not queryeof('phase3') then etpligne := &#60;phase3.&#34;recno&#34;&#62;;                                                                                                                                                              &#13;&#10;                 end;&#13;&#10;&#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where traite = 0'; // order by sa, sb, sc, sd, se, rb, rh';&#13;&#10;                 replacesql('resultat', sql);&#13;&#10;                 execsql('resultat');          &#13;&#10;                                                                    &#13;&#10;                 report.getdataset('resultat').close;&#13;&#10;                 report.getdataset('resultat').open;&#13;&#10;                 firstrecord('resultat');&#13;&#10;                   &#13;&#10;                 result := 2;                                            &#13;&#10;         end;    &#13;&#10;                   &#13;&#10;         4:&#13;&#10;         begin&#13;&#10;                 sql := 'select * from traitement_rotox6_' + type_cadre + ' where traite = 0'; // order by sa, sb, sc, sd, se, rb, rh';&#13;&#10;                 replacesql('resultat', sql);&#13;&#10;                 execsql('resultat');          &#13;&#10;                                               &#13;&#10;                 report.getdataset('resultat').close;&#13;&#10;                 report.getdataset('resultat').open;&#13;&#10;                 firstrecord('resultat');&#13;&#10;                           &#13;&#10;                 result := 1;                                                                          &#13;&#10;         end;                           &#13;&#10;       end;                 &#13;&#10;end;          &#13;&#10;  &#13;&#10;&#13;&#10;  &#13;&#10;begin&#13;&#10;       fichierini := '.\rotox6.ini';&#13;&#10;    &#13;&#10;       chemin := inireadstring(fichierini, 'chemin de base:chemin', '.\');&#13;&#10;       cheminreseau := inireadstring(fichierini, 'chemin reseau:chemin', '.\');&#13;&#10;        &#13;&#10;       chemin := verif(chemin);&#13;&#10;       forcedirectories(chemin);&#13;&#10;          &#13;&#10;       if cheminreseau &#60;&#62; '.\' then &#13;&#10;       begin&#13;&#10;              cheminreseau := verif(cheminreseau);&#13;&#10;              forcedirectories(cheminreseau);           &#13;&#10;       end;&#13;&#10;       firstrecord('lot');&#13;&#10;      &#13;&#10;       if &#60;lot.&#34;code&#34;&#62; &#60;&#62; '' then codelot := copy(&#60;lot.&#34;code&#34;&#62;, length(&#60;lot.&#34;code&#34;&#62;)-3, 4) else codelot:='';&#13;&#10;       numlot := trim(&#60;lot.&#34;lot&#34;&#62;);&#13;&#10;&#13;&#10;       init_table();                          &#13;&#10;       //procédure qui remplit les tables de traitement                                                                                                                 &#13;&#10;       fill_rotox_6('dormant');&#13;&#10;       fill_rotox_6('ouvrant');                                                                                                 &#13;&#10;&#13;&#10;       //TRAITEMENT DES DORMANTS&#13;&#10;         &#13;&#10;       report.getdataset('dormant').close;&#13;&#10;       report.getdataset('dormant').open;&#13;&#10;       flag := 0;&#13;&#10;       condition :='';                                        &#13;&#10;       firstrecord('dormant');             &#13;&#10;       while not queryeof('dormant') do&#13;&#10;       begin&#13;&#10;               nligne := &#60;dormant.&#34;recno&#34;&#62;;&#13;&#10;               //procédure qui supprimera de la table de traitement les cadres ayant un seuil avec une traverse verticale soudée                   &#13;&#10;               flag := seuil_meneau('dormant');&#13;&#10;               if flag = 1 then&#13;&#10;               begin&#13;&#10;                       condition := condition + inttostr(&#60;dormant.&#34;recno&#34;&#62;) +', ';                                                                                                                                                                                          &#13;&#10;               end&#13;&#10;               else&#13;&#10;               begin&#13;&#10;                       // procédure pour répertorier les cadres avec Seuils en A et Seuils en C&#13;&#10;                       flag := verif_seuil('dormant', 'A');&#13;&#10;                       if flag = 1 then&#13;&#10;                       begin   &#13;&#10;                               sql := 'update `rotox6_dormant` set `SeuilA`=1 where `recno` = ' + inttostr(&#60;dormant.&#34;recno&#34;&#62;);&#13;&#10;                               replacesql('tables', sql);&#13;&#10;                               execsql('tables');                                                            &#13;&#10;                       end;                                 &#13;&#10;                       flag := verif_seuil('dormant', 'C');&#13;&#10;                       if flag = 1 then&#13;&#10;                       begin   &#13;&#10;                               sql := 'update `rotox6_dormant` set `SeuilC`=1 where `recno` = ' + inttostr(&#60;dormant.&#34;recno&#34;&#62;);&#13;&#10;                               replacesql('tables', sql);&#13;&#10;                               execsql('tables');                                                            &#13;&#10;                       end;&#13;&#10;                       //procédure pour répertorier les profiles réduits&#13;&#10;                       verif_prof_reduit('dormant', nligne);                                                       &#13;&#10;                                                          &#13;&#10;               end;&#13;&#10;               nextrecord('dormant');                                                                      &#13;&#10;       end;&#13;&#10;       if condition &#60;&#62; '' then &#13;&#10;       begin&#13;&#10;               condition := copy(condition, 1, length(condition)-2);&#13;&#10;               sql := 'delete from rotox6_dormant where `recno` in (' + condition + ')';&#13;&#10;               replacesql('tables', sql);&#13;&#10;               execsql('tables');                   &#13;&#10;       end;                                  &#13;&#10;&#13;&#10;       // TRAITEMENT DES OUVRANTS                                                       &#13;&#10;         &#13;&#10;       report.getdataset('ouvrant').close;&#13;&#10;       report.getdataset('ouvrant').open;&#13;&#10;       flag := 0;&#13;&#10;       condition :='';                                        &#13;&#10;       firstrecord('ouvrant');             &#13;&#10;       while not queryeof('ouvrant') do&#13;&#10;       begin&#13;&#10;               nligne := &#60;ouvrant.&#34;recno&#34;&#62;;                            &#13;&#10;               //pas de seuils dans les ouvrants&#13;&#10;               //procédure pour répertorier les profiles réduits&#13;&#10;               verif_prof_reduit('ouvrant', nligne);&#13;&#10;                                                                 &#13;&#10;               nextrecord('ouvrant');                                                                      &#13;&#10;       end;                                                                &#13;&#10;&#13;&#10;                                                                                                                                                                                          &#13;&#10;       sql := 'drop table if exists `simple_dormant`, `simple_ouvrant`, `double_dormant`, `double_ouvrant`';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;         &#13;&#10;       //dormant : simple cadre= cadre avec seuil ou avec traverse ou comportant un profile réduit avant test double cadre                                                                                                                         &#13;&#10;       sql := 'create table if not exists simple_dormant select * from `rotox6_dormant` where `SeuilA`=1 or `SeuilC`=1 or '&#13;&#10;               +'`traverse`&#60;&#62;''0'' or `reduit_A`=1 or `reduit_B`=1 or `reduit_C`=1 or `reduit_D`=1 or `reduit_E`=1';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;         &#13;&#10;       //dormant : double tous les autres cadres avant test                      &#13;&#10;       sql := 'create table if not exists double_dormant select * from `rotox6_dormant` where `recno` not in (select recno from '&#13;&#10;               +'`simple_dormant`)';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');                                                                           &#13;&#10;         &#13;&#10;       //ouvrant : simple cadre = cadre avec traverse avant test double cadre           &#13;&#10;       sql := 'create table if not exists simple_ouvrant select * from `rotox6_ouvrant` where `traverse`&#60;&#62;''0''';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;&#13;&#10;       //ouvrant : double cadre = tous les autres cadres           &#13;&#10;       sql := 'create table if not exists double_ouvrant select * from `rotox6_ouvrant` where `recno` not in (select recno from '&#13;&#10;               +'`simple_ouvrant`)';&#13;&#10;       replacesql('tables', sql);&#13;&#10;       execsql('tables');&#13;&#10;         &#13;&#10;       // procédure qui va pré-traiter les simples cadres et les doubles cadres&#13;&#10;       // si les conditions ne sont pas remplies pour qu'un cadre soit en double assemblage il sera passé en simple cadre,&#13;&#10;       // ajouté à la table simple dormant/ouvrant puis supprimé de la table double dormant/ouvrant                                                                                                                                                                                                              &#13;&#10;       double_cadre('dormant');         &#13;&#10;       simple_cadre('dormant');&#13;&#10;         &#13;&#10;       double_cadre('ouvrant');           &#13;&#10;       simple_cadre('ouvrant');&#13;&#10;&#13;&#10;       tri_impression('dormant');&#13;&#10;       tri_impression('ouvrant');                                                               &#13;&#10;                                                                &#13;&#10;end.          " StoreInDFM="false" OnStopReport="frxReportOnStopReport" OnReportPrint="frxReportOnReportPrint" PropData="044C65667403D10203546F70031B0108446174617365747301010C3100000020446174615365743D225F6465745F646F726D616E742220446174615365744E616D653D226465745F646F726D616E742200010C3100000020446174615365743D225F6465745F6F757672616E742220446174615365744E616D653D226465745F6F757672616E742200010C2900000020446174615365743D225F646F726D616E742220446174615365744E616D653D22646F726D616E742200010C3700000020446174615365743D225F646F75626C655F646F726D616E742220446174615365744E616D653D22646F75626C655F646F726D616E742200010C3700000020446174615365743D225F646F75626C655F6F757672616E742220446174615365744E616D653D22646F75626C655F6F757672616E742200010C3900000020446174615365743D225F666963686167655F6F757672616E742220446174615365744E616D653D22666963686167655F6F757672616E742200010C2B00000020446174615365743D225F685F6567616C65732220446174615365744E616D653D22685F6567616C65732200010C2D00000020446174615365743D225F686C5F6567616C65732220446174615365744E616D653D22686C5F6567616C65732200010C3300000020446174615365743D225F696D70725F646F726D616E742220446174615365744E616D653D22696D70725F646F726D616E742200010C3300000020446174615365743D225F696D70725F6F757672616E742220446174615365744E616D653D22696D70725F6F757672616E742200010C2B00000020446174615365743D225F6C5F6567616C65732220446174615365744E616D653D226C5F6567616C65732200010C2100000020446174615365743D225F6C6F742220446174615365744E616D653D226C6F742200010C3100000020446174615365743D225F6D656E7569735F646966662220446174615365744E616D653D226D656E7569735F646966662200010C3500000020446174615365743D225F6D656E7569735F6567616C65732220446174615365744E616D653D226D656E7569735F6567616C65732200010C2900000020446174615365743D225F6F757672616E742220446174615365744E616D653D226F757672616E742200010C3900000020446174615365743D225F706572636167655F646F726D616E742220446174615365744E616D653D22706572636167655F646F726D616E742200010C3900000020446174615365743D225F706572636167655F6F757672616E742220446174615365744E616D653D22706572636167655F6F757672616E742200010C2700000020446174615365743D225F7068617365312220446174615365744E616D653D227068617365312200010C2700000020446174615365743D225F7068617365322220446174615365744E616D653D227068617365322200010C2700000020446174615365743D225F7068617365332220446174615365744E616D653D227068617365332200010C2B00000020446174615365743D225F726573756C7461742220446174615365744E616D653D22726573756C7461742200010C3700000020446174615365743D225F73696D706C655F646F726D616E742220446174615365744E616D653D2273696D706C655F646F726D616E742200010C3700000020446174615365743D225F73696D706C655F6F757672616E742220446174615365744E616D653D2273696D706C655F6F757672616E742200010C2700000020446174615365743D225F7461626C65732220446174615365744E616D653D227461626C65732200010C2F00000020446174615365743D225F7472616974656D656E742220446174615365744E616D653D227472616974656D656E74220000095661726961626C657301010C10000000204E616D653D2220436861727365742200010C1E000000204E616D653D22414E53495F43484152534554222056616C75653D22302200010C21000000204E616D653D2244454641554C545F43484152534554222056616C75653D22312200010C20000000204E616D653D2253594D424F4C5F43484152534554222056616C75653D22322200010C1E000000204E616D653D224D41435F43484152534554222056616C75653D2237372200010C23000000204E616D653D2253484946544A495F43484152534554222056616C75653D223132382200010C23000000204E616D653D2248414E4745554C5F43484152534554222056616C75653D223132392200010C22000000204E616D653D2248414E47554C5F43484152534554222056616C75653D223132392200010C21000000204E616D653D224A4F4841425F43484152534554222056616C75653D223133302200010C22000000204E616D653D224742323331325F43484152534554222056616C75653D223133342200010C27000000204E616D653D224348494E455345424947355F43484152534554222056616C75653D223133362200010C21000000204E616D653D22475245454B5F43484152534554222056616C75653D223136312200010C23000000204E616D653D225455524B4953485F43484152534554222056616C75653D223136322200010C26000000204E616D653D22564945544E414D4553455F43484152534554222056616C75653D223136332200010C22000000204E616D653D224845425245575F43484152534554222056616C75653D223137372200010C22000000204E616D653D224152414249435F43484152534554222056616C75653D223137382200010C22000000204E616D653D2242414C5449435F43484152534554222056616C75653D223138362200010C23000000204E616D653D225255535349414E5F43484152534554222056616C75653D223230342200010C20000000204E616D653D22544841495F43484152534554222056616C75653D223232322200010C26000000204E616D653D22454153544555524F50455F43484152534554222056616C75653D223233382200010C1F000000204E616D653D224F454D5F43484152534554222056616C75653D223235352200010C0F000000204E616D653D222057696E50726F2200010C20000000204E616D653D22544F444159222056616C75653D2231322F30342F323031302200010C1C000000204E616D653D224E4F57222056616C75653D2231333A34383A34312200010C15000000204E616D653D22544142222056616C75653D22092200010C25000000204E616D653D22575055534552222056616C75653D2241646D696E6973747261746575722200010C1F000000204E616D653D22575056455253494F4E222056616C75653D22382E312E302200010C22000000204E616D653D2257505256455253494F4E222056616C75653D22382E302E322E372200010C1A000000204E616D653D224D4158504C4953222056616C75653D223130220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" ResetPageNumbers="true" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="140" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="_impr_dormant" DataSetName="impr_dormant" RowCount="0">
      <TfrxMemoView Name="impr_dormantko" Left="0" Top="0" Width="162,51979" Height="18,89765" ShowHint="false" DataField="ko" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_dormant.&#34;ko&#34;]"/>
      <TfrxMemoView Name="impr_dormantpo" Left="162,51979" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" DataField="po" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_dormant.&#34;po&#34;]"/>
      <TfrxMemoView Name="impr_dormantfn" Left="257,00804" Top="0" Width="102,04731" Height="18,89765" ShowHint="false" DataField="fn" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_dormant.&#34;fn&#34;]"/>
      <TfrxMemoView Name="Memo17" Left="359,05535" Top="0" Width="162,51979" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_dormant.&#34;ko2&#34;]"/>
      <TfrxMemoView Name="Memo18" Left="521,57514" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_dormant.&#34;po2&#34;]"/>
      <TfrxMemoView Name="Memo19" Left="616,06339" Top="0" Width="102,04731" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_dormant.&#34;fn2&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" Height="18,89765" Left="0" Top="100" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="0" Top="0" Width="162,51979" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Commande"/>
      <TfrxMemoView Name="Memo2" Left="359,05535" Top="0" Width="162,51968503937" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Commande"/>
      <TfrxMemoView Name="Memo3" Left="257,00804" Top="0" Width="102,04731" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Casier"/>
      <TfrxMemoView Name="Memo4" Left="616,06339" Top="0" Width="102,047244094488" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Casier"/>
      <TfrxMemoView Name="Memo5" Left="162,51979" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="RepÃ¨re"/>
      <TfrxMemoView Name="Memo6" Left="521,57514" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="RepÃ¨re"/>
    </TfrxHeader>
    <TfrxPageHeader Name="PageHeader1" Height="22,67718" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="impr_dormanten" Left="0" Top="0" Width="381,73253" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="false" Text="Ordre Lot Dormant          Lot nÂ°: [impr_ouvrant.&#34;en&#34;]"/>
    </TfrxPageHeader>
  </TfrxReportPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" ResetPageNumbers="true" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageHeader Name="PageHeader2" Height="22,67718" Left="0" Top="16" Width="718,1107">
      <TfrxMemoView Name="Memo16" Left="0" Top="0" Width="381,73253" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="false" Text="Ordre Lot Ouvrant          Lot nÂ°: [impr_ouvrant.&#34;en&#34;]"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData2" Height="18,89765" Left="0" Top="140" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="_impr_ouvrant" DataSetName="impr_ouvrant" RowCount="0">
      <TfrxMemoView Name="Memo7" Left="0" Top="0" Width="162,51979" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_ouvrant.&#34;ko&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="162,51979" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_ouvrant.&#34;po&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="257,00804" Top="0" Width="102,04731" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_ouvrant.&#34;fn&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="359,05535" Top="0" Width="162,51979" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_ouvrant.&#34;ko2&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="521,57514" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_ouvrant.&#34;po2&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="616,06339" Top="0" Width="102,04731" Height="18,89765" ShowHint="false" DataSet="_impr_dormant" DataSetName="impr_dormant" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="[impr_ouvrant.&#34;fn2&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header2" Height="18,89765" Left="0" Top="100" Width="718,1107">
      <TfrxMemoView Name="Memo13" Left="0" Top="0" Width="162,51979" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Commande"/>
      <TfrxMemoView Name="Memo14" Left="359,05535" Top="0" Width="162,51968503937" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Commande"/>
      <TfrxMemoView Name="Memo15" Left="257,00804" Top="0" Width="102,04731" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Casier"/>
      <TfrxMemoView Name="Memo20" Left="616,06339" Top="0" Width="102,047244094488" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="Casier"/>
      <TfrxMemoView Name="Memo21" Left="162,51979" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="RepÃ¨re"/>
      <TfrxMemoView Name="Memo22" Left="521,57514" Top="0" Width="94,48825" Height="18,89765" ShowHint="false" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text="RepÃ¨re"/>
    </TfrxHeader>
  </TfrxReportPage>
</TfrxReport>

[I]fr3=1
[C]lniptyoc7=2CBCED024EBF88212F64E334984A2D7D
[C]title=Driver soudeuse 6 têtes Rotox
[End of REPORT]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  0]
[C]database=db
[C]datasource=%DSN%
[C]name=Database1
[M]params=13
%AUTOLOGIN%

[C]report=ROTOX_6TETES 2.1
[C]type=D
[I]typedb=9
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  1]
[C]database=db
[I]line=1
[C]name=lot
[M]params=61
select code, lot, lot as code_lot from lot where lot = :order
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  2]
[C]database=db
[C]datasource=ds_det_ouvrant
[I]line=2
[C]name=percage_ouvrant
[M]params=228
select u.code, u.`position` from usglot u
inner join detlot d on u.lot=d.lot and u.ligne=d.ligne
where d.lot = :c_lot and trim(d.chassis) = :chassis and left(trim(code), 8) in ('P-U-PIVG', 'P-U-PIVD') and d.casier<>d.casierdrm
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  3]
[C]database=db
[I]line=3
[C]name=tables
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  4]
[C]database=db
[C]datasource=ds_det_ouvrant
[I]line=4
[C]name=fichage_ouvrant
[M]params=429
select d.chassis, 
case d.position 
when 1 then 'D'
when 2 then 'B'
when 3 then 'C'
when 4 then 'A'
when 5 then 'E'
when 6 then 'E'
end sens, 
u.code, u.position from usglot u inner join detlot d on d.lot=u.lot and d.ligne=u.ligne
where d.lot = :c_lot and d.chassis = :chassis and d.ligne = :ligne and left(trim(u.code), 7) in ('P-U-PFD', 'P-U-PFT') and (d.casier <> d.casierdrm)
order by d.position, u.ligne, u.numero
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  5]
[C]database=db
[I]line=5
[C]name=dormant
[M]params=43
select * from rotox6_dormant order by recno
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  6]
[C]database=db
[I]line=6
[C]name=ouvrant
[M]params=43
select * from rotox6_ouvrant order by recno
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  7]
[C]database=db
[C]datasource=ds_det_dormant
[I]line=7
[C]name=percage_dormant
[M]params=227
select u.code, u.`position` from usglot u
inner join detlot d on u.lot=d.lot and u.ligne=d.ligne
where d.lot = :c_lot and trim(d.chassis) = :chassis and left(trim(code), 8) in ('P-U-PIVG', 'P-U-PIVD') and d.casier=d.casierdrm
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  8]
[C]database=db
[I]line=8
[C]name=traitement
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1  9]
[C]database=db
[I]line=9
[C]name=menuis_egales
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 10]
[C]database=db
[I]line=10
[C]name=resultat
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 11]
[C]database=db
[I]line=11
[C]name=phase1
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 12]
[C]database=db
[I]line=12
[C]name=phase2
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 13]
[C]database=db
[I]line=13
[C]name=phase3
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 14]
[C]database=db
[I]line=14
[C]name=impr_dormant
[M]params=36
select * from imprime_rotox6_dormant
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 15]
[C]database=db
[I]line=15
[C]name=impr_ouvrant
[M]params=36
select * from imprime_rotox6_ouvrant
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 16]
[C]database=db
[I]line=16
[C]name=hl_egales
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 17]
[C]database=db
[I]line=17
[C]name=h_egales
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 18]
[C]database=db
[I]line=18
[C]name=l_egales
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 19]
[C]database=db
[I]line=19
[C]name=det_ouvrant
[M]params=625
select d.lot, d.lot c_lot, d.commande, d.chassis, d.casier % 50000 as casier, d.casier, d.casierdrm, d.teinteint, d.dim*10 as dim, d.position, d.profil, d.codebarre, d.ligne, 
dt.forme, d.scie, (d.axetrav * 10) axetrav, (lcadre * 10) lcadre, (hcadre * 10) hcadre, d.angle1, d.angle2
from detlot d 
inner join detail dt on dt.commande=d.commande and dt.numero=d.chassis
inner join profil p on p.code=d.profil and p.categorie=1
where d.lot = :order and d.instruct='C' and d.position in (1,2,3,4,5,6) and dt.forme=0 and d.casier <> d.casierdrm 
and d.angle1 in (45,90,300) and d.angle2 in (45,90,300)
order by d.codebarre
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 20]
[C]database=db
[I]line=20
[C]name=menuis_diff
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 21]
[C]database=db
[I]line=21
[C]name=det_dormant
[M]params=624
select d.lot, d.lot c_lot, d.commande, d.chassis, d.casier % 50000 as casier, d.casier, d.casierdrm, d.teinteint, d.dim*10 as dim, d.position, d.profil, d.codebarre, d.ligne, 
dt.forme, d.scie, (d.axetrav * 10) axetrav, (lcadre * 10) lcadre, (hcadre * 10) hcadre, d.angle1, d.angle2
from detlot d 
inner join detail dt on dt.commande=d.commande and dt.numero=d.chassis
inner join profil p on p.code=d.profil and p.categorie=1
where d.lot = :order and d.instruct='C' and d.position in (1,2,3,4,5,6) and dt.forme=0 and d.casier = d.casierdrm 
and d.angle1 in (45,90,300) and d.angle2 in (45,90,300)
order by d.codebarre
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 22]
[C]database=db
[I]line=22
[C]name=double_dormant
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 23]
[C]database=db
[I]line=23
[C]name=double_ouvrant
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 24]
[C]database=db
[I]line=24
[C]name=simple_ouvrant
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=ROTOX_6TETES 2.1 25]
[C]database=db
[I]line=25
[C]name=simple_dormant
[C]report=ROTOX_6TETES 2.1
[C]type=Q
[End of REPORTQRY]
