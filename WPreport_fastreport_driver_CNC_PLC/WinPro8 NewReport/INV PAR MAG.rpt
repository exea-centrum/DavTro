[Record REPORT]
[CODE=INV PAR MAG]
[C]code=INV PAR MAG
[M]descriptio=628
Version 2.0Multilingue
WPReport.dll v8.0.1.6
WinPro v8.0.1.67
Commentaires plus bas  \/
++++ Améliorations / Différences++++
->Lors de l'impression de l'inventaire article par article, l'impression WinPro de départ imprimait 3 lignes par article. Les infos ont été ramenées sur un seule ligne pour économiser de la place et supprimer une ligne inutile.
-> Dans l'impression standard, un tri sur le code article est opéré par défaut même lorsqu'on choisit de ne pas trier sur ce critère. Dans mon implémentation, j'ai choisi de ne pas le faire pour des raisons de cohérence avec les choix de tris possibles pour ce rapport.
[M]design=67620
<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.1.28" DotMatrixReport="false" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Par défaut" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39184,4149580671" ReportOptions.Description.Text="" ReportOptions.Name="INV PAR MAG" ReportOptions.LastChange="39184,4149580671" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;tot, total, totgrp : extended;&#13;&#10;tris       : string;&#13;&#10;  &#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;    &#13;&#10;function isblank (chaine : string) : boolean;&#13;&#10;begin&#13;&#10;  if (length(trim(chaine)) &#62; 0) then             &#13;&#10;     Result := false  &#13;&#10;  else&#13;&#10;     Result := true;&#13;&#10;end;                      &#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;&#13;&#10;function stockok : boolean;&#13;&#10;begin&#13;&#10;                                  &#13;&#10;  if (RadioButton10.Checked and (&#60;Stock.&#34;qte&#34;&#62; &#60; 0.0)) then&#13;&#10;      Result := true             &#13;&#10;  else             &#13;&#10;     if (RadioButton11.Checked) then&#13;&#10;         Result := true    &#13;&#10;     else          &#13;&#10;        if (RadioButton12.Checked and (&#60;Stock.&#34;qte&#34;&#62; &#62; 0.0)) then&#13;&#10;           Result := true&#13;&#10;        else                           &#13;&#10;           Result := false;&#13;&#10;    &#13;&#10;end;            &#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   // Si les conditions de stock sont remplies                                                                                               &#13;&#10;   if stockok then&#13;&#10;   begin               &#13;&#10;                    &#13;&#10;      if not (RadioButton5.Checked) then                               // si pas coché &#34;non valorisé&#34;                                        &#13;&#10;      begin              &#13;&#10;            &#13;&#10;          if RadioButton6.Checked then                                //si coché &#34;prix d'achat&#34;                            &#13;&#10;          begin                                    &#13;&#10;             Articlepv1.Text := &#60;Article.&#34;pafb&#34;&#62;;                                                                                           &#13;&#10;             tot := &#60;Article.&#34;pafb&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;&#13;&#10;          end&#13;&#10;          else&#13;&#10;          begin&#13;&#10;             if RadioButton7.Checked then                               // si coché dernier pr                                                   &#13;&#10;             begin&#13;&#10;                if &#60;Article.&#34;prcourant&#34;&#62; &#62; 0.0 then                       //si prcourant                             &#13;&#10;                begin&#13;&#10;                   Articlepv1.Text := &#60;Article.&#34;prcourant&#34;&#62;;                                                                                           &#13;&#10;                   tot := &#60;Article.&#34;prcourant&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;                                                                        &#13;&#10;                end&#13;&#10;                else&#13;&#10;                begin&#13;&#10;                   if &#60;Article.&#34;prtarif&#34;&#62; &#62; 0.0 then                      //sinon si pr tarif                                         &#13;&#10;                   begin                             &#13;&#10;                      Articlepv1.Text := &#60;Article.&#34;prtarif&#34;&#62;;&#13;&#10;                      tot := &#60;Article.&#34;prtarif&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;&#13;&#10;                   end&#13;&#10;                   else&#13;&#10;                   begin&#13;&#10;                      Articlepv1.Text := &#60;Article.&#34;pafb&#34;&#62;;              //sinon PA                                                                                                                  &#13;&#10;                      tot := &#60;Article.&#34;pafb&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;                                                                                    &#13;&#10;                   end;                           &#13;&#10;                end;                        &#13;&#10;             end&#13;&#10;             else&#13;&#10;             begin                                                          //si coché PR tarif                                      &#13;&#10;                if &#60;Article.&#34;prtarif&#34;&#62; &#62; 0.0 then                           //si PR tarif                                                                                  &#13;&#10;                begin&#13;&#10;                   Articlepv1.Text := &#60;Article.&#34;prtarif&#34;&#62;;                                                                                           &#13;&#10;                   tot := &#60;Article.&#34;prtarif&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;                                                                        &#13;&#10;                end&#13;&#10;                else&#13;&#10;                begin&#13;&#10;                   if &#60;Article.&#34;prcourant&#34;&#62; &#62; 0.0 then&#13;&#10;                   begin                             &#13;&#10;                      Articlepv1.Text := FormatFloat('0.000',&#60;Article.&#34;prcourant&#34;&#62;);           //sinon si PR courant                                             &#13;&#10;                      tot := &#60;Article.&#34;prcourant&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;&#13;&#10;                   end&#13;&#10;                   else&#13;&#10;                   begin&#13;&#10;                      Articlepv1.Text := &#60;Article.&#34;pafb&#34;&#62;;               //sinon PA                                                                                                              &#13;&#10;                      tot := &#60;Article.&#34;pafb&#34;&#62; * &#60;Stock.&#34;qte&#34;&#62;;                                                                                    &#13;&#10;                   end;                           &#13;&#10;                end;                                                                            &#13;&#10;             end;&#13;&#10;          end;  &#13;&#10;// Remplissage des 2 premiers champs                                                                                       &#13;&#10;&#13;&#10;          if ((CheckBox2.Tag&#60;&#62;1) and (CheckBox3.Tag&#60;&#62;1) and (CheckBox6.Tag&#60;&#62;1)) then&#13;&#10;          begin&#13;&#10;             Articledescriptio.Text := &#60;Article.&#34;local&#34;&#62;;&#13;&#10;             Articlecode.Text := &#60;Article.&#34;code&#34;&#62; + ' ' + &#60;Article.&#34;descriptio&#34;&#62;;&#13;&#10;               &#13;&#10;          end&#13;&#10;          else&#13;&#10;          begin&#13;&#10;             Articledescriptio.Text := &#60;Article.&#34;descriptio&#34;&#62;;&#13;&#10;             Articlecode.Text := &#60;Article.&#34;code&#34;&#62;;  &#13;&#10;          end;  &#13;&#10;        &#13;&#10;              &#13;&#10;          total := total + tot;&#13;&#10;                                    &#13;&#10;      end&#13;&#10;      else                                                                            // sinon (si coché &#34;non valorisé&#34; )                                                                       &#13;&#10;      begin&#13;&#10;       // Si affichage article par article                                                                                         &#13;&#10;         if ((CheckBox2.Tag&#60;&#62;1) and (CheckBox3.Tag&#60;&#62;1) and (CheckBox6.Tag&#60;&#62;1)) then&#13;&#10;         begin&#13;&#10;            Articledescriptio.Text := &#60;Article.&#34;local&#34;&#62;;&#13;&#10;            Articlecode.Text := &#60;Article.&#34;code&#34;&#62; + ' ' + &#60;Article.&#34;descriptio&#34;&#62;;&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin&#13;&#10;            Articledescriptio.Text := &#60;Article.&#34;descriptio&#34;&#62;;&#13;&#10;            Articlecode.Text := &#60;Article.&#34;code&#34;&#62;;  &#13;&#10;         end;                   &#13;&#10;                   &#13;&#10;      end;&#13;&#10;&#13;&#10;        &#13;&#10;      if not CheckBox5.Checked then                                                                   &#13;&#10;         MasterData1.Visible := true;&#13;&#10;   end                            &#13;&#10;   else&#13;&#10;   begin&#13;&#10;      MasterData1.Visible := false;                       &#13;&#10;   end;&#13;&#10;&#13;&#10;&#13;&#10;   totgrp := totgrp + tot;                                                                                 &#13;&#10;     &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure Memo8OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Memo8.Text := FormatFloat('0.000',tot);                                                                    &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure Memo11OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Memo11.Text := FormatFloat('0.000',total);                                     &#13;&#10;end;&#13;&#10;  &#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   ReplaceSQL('Categ','Select code, descriptio from categ');                                 &#13;&#10;   FirstRecord('Categ');  &#13;&#10;   while not QueryEof('Categ') do&#13;&#10;   begin&#13;&#10;      ComboBox1.Items.Add(&#60;Categ.&#34;code&#34;&#62;);&#13;&#10;      NextRecord('Categ');                                                           &#13;&#10;   end;    &#13;&#10;                             &#13;&#10;   ReplaceSQL('Categ','Select code from local');&#13;&#10;   FirstRecord('Categ');  &#13;&#10;   while not QueryEof('Categ') do&#13;&#10;   begin                                              &#13;&#10;      ComboBox2.Items.Add(&#60;Categ.&#34;code&#34;&#62;);&#13;&#10;      NextRecord('Categ');                                                           &#13;&#10;   end;       &#13;&#10;   &#13;&#10;   DialogPage1.Caption := Translate('IDS_INVENTEMPLACEMENT','');      //dialog box title&#13;&#10;&#13;&#10;   GroupBox1.Caption := Translate('IDS_CRITERES_SELECTION','');             //GroupBoxes                                                 &#13;&#10;   GroupBox2.Caption := Translate('IDS_CRITERES_TRI','');&#13;&#10;   GroupBox3.Caption := Translate('IDS_FOURNISSEUR_PRINCIPAL','');&#13;&#10;   GroupBox4.Caption := Translate('IDS_ARTICLE_FOURNISSEUR','');&#13;&#10;&#13;&#10;   Label1.Caption := Translate('IDS_ARTICLE_DE','');                                 //Labels                                                                                                               &#13;&#10;   Label2.Caption := Translate('DOC_JUSQUE','');&#13;&#10;   Label3.Caption := Translate('IDS_CATEGORIE','');&#13;&#10;   Label4.Caption := Translate('IDS_FOURNISSEUR_PRINCIPAL','');&#13;&#10;   Label5.Caption := Translate('IDS_MAGASIN','');&#13;&#10;&#13;&#10;   CheckBox1.Caption := Translate('IDS_ARTICLE','');                              //CheckBoxes                        &#13;&#10;   CheckBox2.Caption := Translate('IDS_CATEGORIEARTICLE','');&#13;&#10;   CheckBox3.Caption := Translate('IDS_FOURNISSEUR_PRINCIPAL','');&#13;&#10;   CheckBox4.Caption := Translate('IDS_ARTICLE_FOURNISSEUR','');&#13;&#10;   CheckBox5.Caption := Translate('IDS_TOTAL_SEULEMENT','');&#13;&#10;   CheckBox6.Caption := Translate('IDS_MAGASIN','');       &#13;&#10;&#13;&#10;   RadioButton5.Caption := Translate('IDS_NON_VALORISE','');                         //RadioButtons                            &#13;&#10;   RadioButton6.Caption := Translate('IDS_PRIXACHAT','');&#13;&#10;   RadioButton7.Caption := Translate('IDS_DERNIER_PRIX_REVIENT','');&#13;&#10;   RadioButton8.Caption := Translate('IDS_PRIX_REVIENT_TARIF','');     &#13;&#10;   RadioButton10.Caption := Translate('IDS_STOCK_INFERIEUR_A_0','');&#13;&#10;   RadioButton11.Caption := Translate('IDS_TOUS_LES_ARTICLES','');&#13;&#10;   RadioButton12.Caption := Translate('IDS_STOCK_SUPERIEUR_0','');       &#13;&#10;&#13;&#10;   BitBtn1.Caption := Translate('IDS_OK','');&#13;&#10;   BitBtn2.Caption := Translate('IDS_CANCEL','');       &#13;&#10;     &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure SpeedButton1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Edit1.Text := Browse(Edit1.Text,'Article');                                                &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure SpeedButton2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Edit2.Text := Browse(Edit2.Text,'Article');  &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;&#13;&#10;procedure SpeedButton3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Edit3.Text := Browse(Edit3.Text,'Fournisseur');  &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure CheckBox1OnClick(Sender: TfrxCheckBoxControl);&#13;&#10;var&#13;&#10;   tmp, t : integer;                                                          &#13;&#10;begin&#13;&#10;    tmp:=0;&#13;&#10;     t:=Sender.Tag;                                                             &#13;&#10;         &#13;&#10;       if CheckBox1.Checked=true then                       &#13;&#10;          tmp:=tmp+1;     &#13;&#10;       &#13;&#10;       if CheckBox2.Checked then                &#13;&#10;          tmp:=tmp+1;&#13;&#10;      &#13;&#10;       if CheckBox3.Checked then                &#13;&#10;          tmp:=tmp+1;&#13;&#10;                &#13;&#10;       if CheckBox4.Checked then                &#13;&#10;          tmp:=tmp+1;&#13;&#10;       &#13;&#10;       if CheckBox6.Checked then&#13;&#10;          tmp:=tmp+1;      &#13;&#10;             &#13;&#10;&#13;&#10;       if Sender.Checked then                   &#13;&#10;          Sender.Tag:=tmp                             &#13;&#10;       else&#13;&#10;       begin                           &#13;&#10;          Sender.Tag:=0;&#13;&#10;                                     &#13;&#10;          if (CheckBox1.Tag&#62;t)then&#13;&#10;          begin&#13;&#10;             CheckBox1.Tag:=CheckBox1.Tag-1                                                        &#13;&#10;          end;                    &#13;&#10;          if (CheckBox2.Tag&#62;t) then&#13;&#10;          begin&#13;&#10;             CheckBox2.Tag:=CheckBox2.Tag-1                  &#13;&#10;          end;&#13;&#10;          &#13;&#10;          if (CheckBox3.Tag&#62;t)then&#13;&#10;          begin&#13;&#10;             CheckBox3.Tag:=CheckBox3.Tag-1                                                                 &#13;&#10;          end;&#13;&#10;         &#13;&#10;          if (CheckBox4.Tag&#62;t) then&#13;&#10;          begin&#13;&#10;             CheckBox4.Tag:=CheckBox4.Tag-1                                                                 &#13;&#10;          end;&#13;&#10;&#13;&#10;          if (CheckBox6.Tag&#62;t) then&#13;&#10;          begin&#13;&#10;             CheckBox6.Tag:=CheckBox6.Tag-1                                                                 &#13;&#10;          end;              &#13;&#10;       end;                 &#13;&#10;  &#13;&#10;      NumerosOrdre;&#13;&#10;end;&#13;&#10;&#13;&#10;//+++++++++++++++++++ Numeros d'ordre des tris +++++++++++++++                                                                                                                                 &#13;&#10;  &#13;&#10;procedure NumerosOrdre;  &#13;&#10;begin&#13;&#10;       if CheckBox1.Tag=0 then&#13;&#10;          Edit5.Text:=''    &#13;&#10;       else&#13;&#10;          Edit5.Text:=IntToStr(CheckBox1.Tag);&#13;&#10;       &#13;&#10;       if CheckBox2.Tag=0 then&#13;&#10;          Edit6.Text:=''   &#13;&#10;       else   &#13;&#10;          Edit6.Text:=IntToStr(CheckBox2.Tag);&#13;&#10;       &#13;&#10;       if CheckBox3.Tag=0 then&#13;&#10;          Edit7.Text:=''&#13;&#10;       else   &#13;&#10;          Edit7.Text:=IntToStr(CheckBox3.Tag);&#13;&#10;       &#13;&#10;       if CheckBox4.Tag=0 then      &#13;&#10;          Edit8.Text:=''      &#13;&#10;       else    &#13;&#10;          Edit8.Text:=IntToStr(CheckBox4.Tag);           &#13;&#10;&#13;&#10;       if CheckBox6.Tag=0 then&#13;&#10;          Edit4.Text:=''      &#13;&#10;       else    &#13;&#10;          Edit4.Text:=IntToStr(CheckBox6.Tag);           &#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;//+++++++++++++++++++  Ordre des tris dans requête SQL  ++++++++++++++++&#13;&#10;&#13;&#10;procedure OrdreTris;&#13;&#10;var&#13;&#10;   tri : array[1..5] of string;&#13;&#10;   i : integer;                               &#13;&#10;begin&#13;&#10;   if CheckBox1.Tag&#62;0 then     &#13;&#10;      tri[CheckBox1.Tag] := 'a.code';&#13;&#10;   if CheckBox2.Tag&#62;0 then       &#13;&#10;      tri[CheckBox2.Tag] := 'a.categorie';&#13;&#10;   if CheckBox3.Tag&#62;0 then       &#13;&#10;      tri[CheckBox3.Tag] := 'a.codefou';&#13;&#10;   if CheckBox4.Tag&#62;0 then       &#13;&#10;      tri[CheckBox4.Tag] := 'a.artfou';&#13;&#10;   if CheckBox6.Tag&#62;0 then       &#13;&#10;      tri[CheckBox6.Tag] := 's.local';&#13;&#10;        &#13;&#10;   if length(trim(tri[1]))&#62;0 then                                                                    &#13;&#10;   tri[1] := ' Order by ' + tri[1];&#13;&#10;   &#13;&#10;   for i:=2 to 5 do&#13;&#10;   begin&#13;&#10;      if length(trim(tri[i]))&#62;0 then        &#13;&#10;         tri[i] := ' ,' + tri[i];&#13;&#10;   end;             &#13;&#10;       &#13;&#10;   tris:=tri[1] + tri[2] + tri[3] + tri[4] + tri[5];                                 &#13;&#10;     &#13;&#10;end;&#13;&#10;  &#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++       &#13;&#10;&#13;&#10;procedure BitBtn1OnClick(Sender: TfrxComponent);&#13;&#10;var &#13;&#10;   sql1 : string;&#13;&#10;   strs : Array[1..5] of String;                                                         &#13;&#10;   compl : string;&#13;&#10;   inv : string  ;&#13;&#10;   from : string;&#13;&#10;   i : Integer;                               &#13;&#10;&#13;&#10;begin&#13;&#10;   sql1 := 'Select a.code, a.descriptio, a.categorie, a.unite, a.prtarif, a.prcourant, af.pafb, af.codefou, s.local From article a left join artfou af on a.codefou=af.codefou and a.code=af.article left join stock s on a.code=s.article ';&#13;&#10;         &#13;&#10;   if not (isblank(Edit1.Text)) then&#13;&#10;      strs[1] := ' a.code&#62;''' + Edit1.Text+'''';                                  &#13;&#10;   if not (isblank(Edit2.Text)) then&#13;&#10;      strs[2] := ' a.code&#60;''' + Edit2.Text+'''';                                  &#13;&#10;   if not (isblank(ComboBox1.Text)) then&#13;&#10;      strs[3] := ' a.categorie=''' + ComboBox1.Text + '''';                                  &#13;&#10;   if not (isblank(Edit3.Text)) then&#13;&#10;      strs[4] := ' a.codefou=''' + Edit3.Text + '''';                                  &#13;&#10;   if not (isblank(ComboBox2.Text)) then&#13;&#10;      strs[5] := ' s.local=''' + ComboBox2.Text + '''';                                  &#13;&#10;   &#13;&#10;   compl := '';       &#13;&#10;   &#13;&#10;   for i:=1 to 5 do&#13;&#10;   begin                                                         //Construction du &#34;Where&#34;                                                    &#13;&#10;      if isblank(compl) then&#13;&#10;         compl := strs[i]&#13;&#10;      else&#13;&#10;         if not (isblank(strs[i])) then                                     &#13;&#10;            compl := compl + ' and' +  strs[i];&#13;&#10;   end;  &#13;&#10;     &#13;&#10;   if not (isblank(compl)) then&#13;&#10;   begin                 &#13;&#10;      sql1 := sql1 + ' where' + compl;&#13;&#10;&#13;&#10;   end;                  &#13;&#10;      &#13;&#10;   OrdreTris;&#13;&#10;&#13;&#10;      &#13;&#10;   sql1 := sql1 + tris;&#13;&#10;                                       &#13;&#10;        &#13;&#10;   ReplaceSQL('Article',sql1);                           &#13;&#10;&#13;&#10;                                                         &#13;&#10;   if CheckBox2.Tag=1 then                                     // Cette section gère le premier groupe de rupture&#13;&#10;      GroupHeader1.Condition := 'Article.&#34;categorie&#34;'         //  GroupHeader1                             &#13;&#10;   else                                             &#13;&#10;      if CheckBox3.Tag=1 then                                                   &#13;&#10;         GroupHeader1.Condition := 'Article.&#34;codefou&#34;'&#13;&#10;      else&#13;&#10;         GroupHeader1.Condition := 'Article.&#34;local&#34;';  &#13;&#10;                            &#13;&#10;   if CheckBox2.Tag=2 then                                     // Cette section gère le deuxième groupe de rupture&#13;&#10;      GroupHeader2.Condition := 'Article.&#34;categorie&#34;'         //  GroupHeader2         &#13;&#10;   else                                             &#13;&#10;      if CheckBox3.Tag=2 then                                                   &#13;&#10;         GroupHeader2.Condition := 'Article.&#34;codefou&#34;'&#13;&#10;      else&#13;&#10;         GroupHeader2.Condition := 'Article.&#34;local&#34;';  &#13;&#10;&#13;&#10;   if CheckBox2.Tag=3 then                                     // Cette section gère le troisième groupe de rupture&#13;&#10;      GroupHeader3.Condition := 'Article.&#34;categorie&#34;'         //  GroupHeader3         &#13;&#10;   else                                             &#13;&#10;      if CheckBox3.Tag=3 then                                                   &#13;&#10;         GroupHeader3.Condition := 'Article.&#34;codefou&#34;'&#13;&#10;      else&#13;&#10;         GroupHeader3.Condition := 'Article.&#34;local&#34;';&#13;&#10;                                                   &#13;&#10;&#13;&#10;// Utilisation des Tags des GroupHeaders pour savoir s'il faut les afficher ou pas                                                                                                &#13;&#10;  &#13;&#10;   if (CheckBox2.Tag=1) or (CheckBox3.Tag=1) or (CheckBox6.Tag=1) then    //si une des 3 conditions de rupture est en première place                                                                                                                                                                                                                                                               &#13;&#10;   begin &#13;&#10;      GroupHeader1.Tag := 1;  &#13;&#10;//      GroupFooter1.Tag := 1;          &#13;&#10;   end                   &#13;&#10;   else&#13;&#10;   begin               &#13;&#10;      GroupHeader1.Tag := 0;  &#13;&#10;  //    GroupFooter1.Tag := 0;          &#13;&#10;   end;&#13;&#10;     &#13;&#10;   if ((CheckBox2.Tag=2) or (CheckBox3.Tag=2) or (CheckBox6.Tag=2)) then     //si une des 3 conditions de rupture est en deuxième place                &#13;&#10;   begin     &#13;&#10;      if GroupHeader1.Tag=1 then                                           //et si la première bande est visible                                                                                               &#13;&#10;         GroupHeader2.Tag := 1   &#13;&#10;      else &#13;&#10;         GroupHeader2.Tag := 0;  &#13;&#10;   end                                       &#13;&#10;   else&#13;&#10;   begin                            &#13;&#10;      GroupHeader2.Tag := 0;  &#13;&#10;   end;                                &#13;&#10;&#13;&#10;   if ((CheckBox2.Tag=3) or (CheckBox3.Tag=3) or (CheckBox6.Tag=3)) then   //si une des 3 conditions de rupture est en troisième place                 &#13;&#10;   begin     &#13;&#10;      if GroupHeader1.Tag=1 then                       &#13;&#10;         GroupHeader3.Tag := 1&#13;&#10;      else&#13;&#10;         GroupHeader3.Tag := 0;&#13;&#10;   end                              &#13;&#10;   else&#13;&#10;   begin               &#13;&#10;      GroupHeader3.Tag := 0;             &#13;&#10;   end;                                &#13;&#10;&#13;&#10;&#13;&#10;// Changement de mise en page pour affichage article par article                                                                                                                                                                                   &#13;&#10;   if ((CheckBox2.Tag&#60;&#62;1) and (CheckBox3.Tag&#60;&#62;1) and (CheckBox6.Tag&#60;&#62;1)) then&#13;&#10;   begin&#13;&#10;      // Mise en forme s'il ne faut pas valoriser                                                                     &#13;&#10;      if RadioButton5.Checked then&#13;&#10;      begin&#13;&#10;         Memo2.Width := Memo2.Width + (2*(Memo3.width/3)) + Memo6.Width + Memo7.Width ;&#13;&#10;         Memo2.Text := Translate('DOC_CODE','') + ' ' + Translate('IDS_ET','') + ' ' + Translate('IDS_LIBELLE','');&#13;&#10;         Memo3.Width := Memo3.Width / 3;                                         &#13;&#10;         Memo3.Left := Memo3.Left + (2*Memo3.Width) + Memo6.Width + Memo7.Width ;   &#13;&#10;         Memo3.Text := Translate('IDS_EMPLACEMENT','');&#13;&#10;         Memo4.Left := Memo4.Left + Memo6.Width + Memo7.Width ;   &#13;&#10;         Memo6.Visible := false;&#13;&#10;         Memo7.Visible := false;&#13;&#10;&#13;&#10;         Articlecode.Width := Memo2.Width;&#13;&#10;         Articledescriptio.Width := Memo3.Width;&#13;&#10;         Articledescriptio.Left := Memo3.Left;                                                       &#13;&#10;         Stockqte.Left := Memo4.Left;&#13;&#10;         Articlepv1.Visible := false;                                      &#13;&#10;         Memo8.Visible := false;                       &#13;&#10;           &#13;&#10;      end&#13;&#10;      else  // Mise en forme s'il faut valoriser                                                      &#13;&#10;      begin&#13;&#10;        &#13;&#10;       //en-tête&#13;&#10;         Memo3.Width := Memo3.Width / 3;                                         &#13;&#10;         Memo3.Left := Memo3.Left + (2*Memo3.Width);&#13;&#10;         Memo3.Text := Translate('IDS_EMPLACEMENT','');&#13;&#10;         Memo2.Width := Memo2.Width + (2*Memo3.Width);&#13;&#10;         Memo2.Text := Translate('DOC_CODE','') + ' ' + Translate('IDS_ET','') + ' ' + Translate('IDS_LIBELLE','');&#13;&#10;                &#13;&#10;         Articlecode.Width := Articlecode.Width + (2*Memo3.Width);   &#13;&#10;         Articledescriptio.Width := Articledescriptio.Width - (2*Memo3.Width);                                                                                      &#13;&#10;         Articledescriptio.Left := Articledescriptio.Left + (2*Memo3.Width);&#13;&#10;&#13;&#10;      end;                &#13;&#10;   end&#13;&#10;   else&#13;&#10;   begin&#13;&#10;      // Mise en forme s'il ne faut pas valoriser                                                                     &#13;&#10;      if RadioButton5.Checked then&#13;&#10;      begin                        &#13;&#10;         // En-tête                     &#13;&#10;         Memo3.Width := Memo3.Width + Memo6.Width + Memo7.Width;&#13;&#10;         Memo3.Text := Translate('IDS_LEBELLE','');&#13;&#10;         Memo4.Left := Memo4.Left + Memo6.Width + Memo7.Width ;   &#13;&#10;         Memo6.Visible := false;&#13;&#10;         Memo7.Visible := false;&#13;&#10;&#13;&#10;         Articledescriptio.Width := Memo3.Width;&#13;&#10;         Stockqte.Left := Memo4.Left;&#13;&#10;         Articlepv1.Visible := false;                                      &#13;&#10;         Memo8.Visible := false;                       &#13;&#10;           &#13;&#10;      end;  &#13;&#10;            &#13;&#10;   end;             &#13;&#10;&#13;&#10;//+++++++  Messages de debogage  ++++++++                                                                                                                     &#13;&#10;//   ShowMessage('Requête SQL1: '+ sql1);&#13;&#10;&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure PageHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;// Total seulement                                                                                &#13;&#10;   if CheckBox5.Checked then&#13;&#10;   begin               &#13;&#10;      PageHeader1.Visible := false;&#13;&#10;      MasterData1.Visible := false;&#13;&#10;      //ReportSummary1.Visible := false;&#13;&#10;      //PageFooter1.Visible := false                                                                  &#13;&#10;   end;&#13;&#10;// Mise en page si non valorisé                                     &#13;&#10;(*   if (RadioButton5.Checked) then&#13;&#10;   begin                                                  &#13;&#10;      Memo6.Visible := false;&#13;&#10;      Memo7.Visible := false;&#13;&#10;      Memo4.Left := Memo4.Left + Memo6.Width + Memo7.Width;                                                                                            &#13;&#10;      Memo5.Left := Memo5.Left + Memo6.Width + Memo7.Width;&#13;&#10;      Memo3.Width := Memo3.Width + Memo6.Width + Memo7.Width;&#13;&#10;&#13;&#10;      Memo8.Visible := false;&#13;&#10;      Articlepv1.Visible := false;&#13;&#10;      Articleunite.Left := Articleunite.Left + Articlepv1.Width + Memo8.Width;&#13;&#10;      Stockqte.Left := Stockqte.Left + Articlepv1.Width + Memo8.Width;&#13;&#10;      Articledescriptio.Width := Articledescriptio.Width + Articlepv1.Width + Memo8.Width;                                                                          &#13;&#10;          &#13;&#10;   end; *)                    &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;&#13;&#10;procedure GroupHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin    &#13;&#10;   // Si la bande doit etre visible                                                                         &#13;&#10;   if GroupHeader1.Tag=1 then&#13;&#10;   begin&#13;&#10;   // S'il s'agit d'exécuter la rupture sur le fournisseur...                                                                                                                                                                            &#13;&#10;      if GroupHeader1.Condition='Article.&#34;codefou&#34;' then&#13;&#10;      begin&#13;&#10;         if not (isblank(&#60;Fourn.&#34;code&#34;&#62;) and isblank(&#60;Fourn.&#34;nom&#34;&#62;)) then           &#13;&#10;         begin                                  &#13;&#10;            Articlecodefou.Text := 'Fournisseur ' + &#60;Fourn.&#34;code&#34;&#62; + ': ' + &#60;Fourn.&#34;nom&#34;&#62;;&#13;&#10;            Articlecodefou1.Text := &#60;Fourn.&#34;nom&#34;&#62;;&#13;&#10;            GroupHeader1.Visible := true;&#13;&#10;            GroupFooter1.Visible := true;                                                                          &#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin&#13;&#10;            GroupHeader1.Visible := false;&#13;&#10;            GroupFooter1.Visible := false;                &#13;&#10;         end;                   &#13;&#10;      end&#13;&#10;      else          &#13;&#10;      begin&#13;&#10;         // ... ou la catégorie...                                                               &#13;&#10;         if GroupHeader1.Condition='Article.&#34;categorie&#34;' then&#13;&#10;         begin                     &#13;&#10;            if not (isblank(&#60;Cat.&#34;code&#34;&#62;) and isblank(&#60;Cat.&#34;descriptio&#34;&#62;)) then           &#13;&#10;            begin                                  &#13;&#10;               Articlecodefou.Text := 'Categorie ' + &#60;Cat.&#34;code&#34;&#62; + ': ' + &#60;Cat.&#34;descriptio&#34;&#62;;&#13;&#10;               Articlecodefou1.Text := &#60;Cat.&#34;code&#34;&#62;;&#13;&#10;               GroupHeader1.Visible := true;&#13;&#10;               GroupFooter1.Visible := true;                &#13;&#10;            end&#13;&#10;            else&#13;&#10;            begin&#13;&#10;               GroupHeader1.Visible := false;&#13;&#10;               GroupFooter1.Visible := false;                &#13;&#10;            end;&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin             &#13;&#10;            // ... ou l'emplacement de stock.                                                                                  &#13;&#10;            if not (isblank(&#60;Local.&#34;code&#34;&#62;) and isblank(&#60;Local.&#34;descriptio&#34;&#62;)) then&#13;&#10;            begin&#13;&#10;               Articlecodefou.Text := 'Magasin ' + &#60;Local.&#34;code&#34;&#62; + ': ' + &#60;Local.&#34;descriptio&#34;&#62;;&#13;&#10;               Articlecodefou1.Text := &#60;Local.&#34;code&#34;&#62;;&#13;&#10;               GroupHeader1.Visible := true;&#13;&#10;               GroupFooter1.Visible := true;                                                                &#13;&#10;            end&#13;&#10;            else&#13;&#10;            begin&#13;&#10;               GroupHeader1.Visible := false;&#13;&#10;               GroupFooter1.Visible := false;                                                                &#13;&#10;            end;                        &#13;&#10;         end;                 &#13;&#10;      end;&#13;&#10;      totgrp:= 0.0;&#13;&#10;   end;                     &#13;&#10;       &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;    &#13;&#10;procedure GroupHeader2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   &#13;&#10;   // Si la bande doit etre visible                                                                         &#13;&#10;   if GroupHeader2.Tag=1 then&#13;&#10;   begin&#13;&#10;   // S'il s'agit d'exécuter la rupture sur le fournisseur...                                                                                                                                                                            &#13;&#10;      if GroupHeader2.Condition='Article.&#34;codefou&#34;' then&#13;&#10;      begin&#13;&#10;         if not (isblank(&#60;Fourn.&#34;code&#34;&#62;) and isblank(&#60;Fourn.&#34;nom&#34;&#62;)) then           &#13;&#10;         begin                                  &#13;&#10;            Memo12.Text := 'Fournisseur ' + &#60;Fourn.&#34;code&#34;&#62; + ': ' + &#60;Fourn.&#34;nom&#34;&#62;;&#13;&#10;            GroupHeader2.Visible := true;&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin&#13;&#10;            GroupHeader2.Visible := false;&#13;&#10;         end;                   &#13;&#10;      end&#13;&#10;      else          &#13;&#10;      begin&#13;&#10;         // ... ou la catégorie...                                                               &#13;&#10;         if GroupHeader2.Condition='Article.&#34;categorie&#34;' then&#13;&#10;         begin                     &#13;&#10;            if not (isblank(&#60;Cat.&#34;code&#34;&#62;) and isblank(&#60;Cat.&#34;descriptio&#34;&#62;)) then           &#13;&#10;            begin                                  &#13;&#10;               Memo12.Text := 'Categorie ' + &#60;Cat.&#34;code&#34;&#62; + ': ' + &#60;Cat.&#34;descriptio&#34;&#62;;&#13;&#10;               GroupHeader2.Visible := true;&#13;&#10;            end&#13;&#10;            else&#13;&#10;            begin&#13;&#10;               GroupHeader2.Visible := false;&#13;&#10;            end;&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin             &#13;&#10;            // ... ou l'emplacement de stock.                                                                                  &#13;&#10;            if not (isblank(&#60;Local.&#34;code&#34;&#62;) and isblank(&#60;Local.&#34;descriptio&#34;&#62;)) then&#13;&#10;            begin&#13;&#10;               Memo12.Text := 'Magasin ' + &#60;Local.&#34;code&#34;&#62; + ': ' + &#60;Local.&#34;descriptio&#34;&#62;;&#13;&#10;               GroupHeader2.Visible := true;&#13;&#10;            end&#13;&#10;            else&#13;&#10;            begin&#13;&#10;               GroupHeader2.Visible := false;&#13;&#10;            end;                        &#13;&#10;         end;                 &#13;&#10;      end;&#13;&#10;   &#13;&#10;   end;&#13;&#10;     &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure GroupFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   Memo13.Text := FormatFloat('0.000',totgrp);                                                   &#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++&#13;&#10;  &#13;&#10;procedure GroupHeader3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;   // Si la bande doit etre visible                                                                         &#13;&#10;   if GroupHeader3.Tag=1 then&#13;&#10;   begin&#13;&#10;   // S'il s'agit d'exécuter la rupture sur le fournisseur...                                                                                                                                                                            &#13;&#10;      if GroupHeader3.Condition='Article.&#34;codefou&#34;' then&#13;&#10;      begin&#13;&#10;         if not (isblank(&#60;Fourn.&#34;code&#34;&#62;) and isblank(&#60;Fourn.&#34;nom&#34;&#62;)) then           &#13;&#10;         begin                                  &#13;&#10;            Memo14.Text := 'Fournisseur ' + &#60;Fourn.&#34;code&#34;&#62; + ': ' + &#60;Fourn.&#34;nom&#34;&#62;;&#13;&#10;            GroupHeader3.Visible := true;&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin&#13;&#10;            GroupHeader3.Visible := false;&#13;&#10;         end;                   &#13;&#10;      end&#13;&#10;      else          &#13;&#10;      begin&#13;&#10;         // ... ou la catégorie...                                                               &#13;&#10;         if GroupHeader3.Condition='Article.&#34;categorie&#34;' then&#13;&#10;         begin                     &#13;&#10;            if not (isblank(&#60;Cat.&#34;code&#34;&#62;) and isblank(&#60;Cat.&#34;descriptio&#34;&#62;)) then           &#13;&#10;            begin                                  &#13;&#10;               Memo14.Text := 'Categorie ' + &#60;Cat.&#34;code&#34;&#62; + ': ' + &#60;Cat.&#34;descriptio&#34;&#62;;&#13;&#10;               GroupHeader3.Visible := true;&#13;&#10;            end&#13;&#10;            else&#13;&#10;            begin&#13;&#10;               GroupHeader3.Visible := false;&#13;&#10;            end;&#13;&#10;         end&#13;&#10;         else&#13;&#10;         begin             &#13;&#10;            // ... ou l'emplacement de stock.                                                                                  &#13;&#10;            if not (isblank(&#60;Local.&#34;code&#34;&#62;) and isblank(&#60;Local.&#34;descriptio&#34;&#62;)) then&#13;&#10;            begin&#13;&#10;               Memo14.Text := 'Magasin ' + &#60;Local.&#34;code&#34;&#62; + ': ' + &#60;Local.&#34;descriptio&#34;&#62;;&#13;&#10;               GroupHeader3.Visible := true;&#13;&#10;            end&#13;&#10;            else&#13;&#10;            begin&#13;&#10;               GroupHeader3.Visible := false;&#13;&#10;            end;         &#13;&#10;         end;                 &#13;&#10;      end;&#13;&#10;&#13;&#10;      if GroupHeader3.Condition = 'Article.&#34;code&#34;' then&#13;&#10;      begin&#13;&#10;         Memo14.Text := &#60;Article.&#34;code&#34;&#62; + ' ' + &#60;Article.&#34;descriptio&#34;&#62;;&#13;&#10;         totgrp := 0;                                     &#13;&#10;      end;                &#13;&#10;   &#13;&#10;   end;&#13;&#10;end;&#13;&#10;&#13;&#10;//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  &#13;&#10;&#13;&#10;                            &#13;&#10;begin&#13;&#10;   total := 0;                     &#13;&#10;end." PropData="044C65667403D10203546F70031B0108446174617365747301010C2900000020446174615365743D225F41727469636C652220446174615365744E616D653D2241727469636C652200010C2100000020446174615365743D225F4361742220446174615365744E616D653D224361742200010C2500000020446174615365743D225F43617465672220446174615365744E616D653D2243617465672200010C2500000020446174615365743D225F466F75726E2220446174615365744E616D653D22466F75726E2200010C2500000020446174615365743D225F4C6F63616C2220446174615365744E616D653D224C6F63616C2200010C2900000020446174615365743D225F536F63696574652220446174615365744E616D653D22536F63696574652200010C2500000020446174615365743D225F53746F636B2220446174615365744E616D653D2253746F636B220000095661726961626C657301010C10000000204E616D653D2220436861727365742200010C1E000000204E616D653D22414E53495F43484152534554222056616C75653D22302200010C21000000204E616D653D2244454641554C545F43484152534554222056616C75653D22312200010C20000000204E616D653D2253594D424F4C5F43484152534554222056616C75653D22322200010C1E000000204E616D653D224D41435F43484152534554222056616C75653D2237372200010C23000000204E616D653D2253484946544A495F43484152534554222056616C75653D223132382200010C23000000204E616D653D2248414E4745554C5F43484152534554222056616C75653D223132392200010C22000000204E616D653D2248414E47554C5F43484152534554222056616C75653D223132392200010C21000000204E616D653D224A4F4841425F43484152534554222056616C75653D223133302200010C22000000204E616D653D224742323331325F43484152534554222056616C75653D223133342200010C27000000204E616D653D224348494E455345424947355F43484152534554222056616C75653D223133362200010C21000000204E616D653D22475245454B5F43484152534554222056616C75653D223136312200010C23000000204E616D653D225455524B4953485F43484152534554222056616C75653D223136322200010C26000000204E616D653D22564945544E414D4553455F43484152534554222056616C75653D223136332200010C22000000204E616D653D224845425245575F43484152534554222056616C75653D223137372200010C22000000204E616D653D224152414249435F43484152534554222056616C75653D223137382200010C22000000204E616D653D2242414C5449435F43484152534554222056616C75653D223138362200010C23000000204E616D653D225255535349414E5F43484152534554222056616C75653D223230342200010C20000000204E616D653D22544841495F43484152534554222056616C75653D223232322200010C26000000204E616D653D22454153544555524F50455F43484152534554222056616C75653D223233382200010C1F000000204E616D653D224F454D5F43484152534554222056616C75653D223235352200010C0F000000204E616D653D222057696E50726F2200010C20000000204E616D653D22544F444159222056616C75653D2232322F30352F323030372200010C1C000000204E616D653D224E4F57222056616C75653D2231303A31353A33302200010C15000000204E616D653D22544142222056616C75653D22092200010C25000000204E616D653D22575055534552222056616C75653D2241646D696E697374726174657572220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" PaperWidth="215,9" PaperHeight="279,4" PaperSize="1" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxPageHeader Name="PageHeader1" Height="49,13389" Left="0" Top="16" Width="740,409927" OnBeforePrint="PageHeader1OnBeforePrint">
      <TfrxMemoView Name="Societenom" Left="0" Top="0" Width="453,5436" Height="22,67718" DataField="nom" DataSet="_Societe" DataSetName="Societe" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="false" VAlign="vaBottom" Text="[Societe.&#34;nom&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="453,5436" Top="0" Width="287,24428" Height="22,67718" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="8" HAlign="haRight" ParentFont="false" VAlign="vaBottom" Text="[Translate('IDS_INVENTAIRE','')]"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="30,23624" Width="128,50402" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Translate('DOC_CODE','')]"/>
      <TfrxMemoView Name="Memo3" Left="128,50402" Top="30,23624" Width="324,78757" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Translate('IDS_LIBELLE','')]"/>
      <TfrxMemoView Name="Memo4" Left="453,29159" Top="30,23624" Width="90,92919" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Translate('IDS_STOCK','')]"/>
      <TfrxMemoView Name="Memo6" Left="544,03185" Top="30,23624" Width="83,37013" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Translate('IDS_PRIXUNITE','')]"/>
      <TfrxMemoView Name="Memo7" Left="627,40198" Top="30,23624" Width="112,3859" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Translate('DOC_TOTAL','')]"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="256" Width="740,409927" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="_Article" DataSetName="Article" RowCount="0" Stretched="true">
      <TfrxMemoView Name="Articlecode" Left="0" Top="0" Width="128,50402" Height="18,89765" StretchMode="smMaxHeight" AllowExpressions="false" DataSet="_Article" DataSetName="Article" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="false" Text=""/>
      <TfrxMemoView Name="Articledescriptio" Left="128,50402" Top="0" Width="324,78757" Height="18,89765" StretchMode="smMaxHeight" AllowExpressions="false" DataSet="_Article" DataSetName="Article" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text=""/>
      <TfrxMemoView Name="Stockqte" Left="453,29159" Top="0" Width="90,92919" Height="18,89765" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" Text="[Stock.&#34;qte&#34;]"/>
      <TfrxMemoView Name="Articlepv1" Left="544,03185" Top="0" Width="83,37013" Height="18,89765" StretchMode="smMaxHeight" DataSet="_Article" DataSetName="Article" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" Text=""/>
      <TfrxMemoView Name="Memo8" Left="627,40198" Top="0" Width="112,3859" Height="18,89765" OnBeforePrint="Memo8OnBeforePrint" StretchMode="smMaxHeight" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2f" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" Text=""/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="24" Left="0" Top="504" Width="740,409927">
      <TfrxMemoView Name="Page" Left="168" Top="8" Width="571,78788" Height="16" Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="2" Frame.Typ="4" HAlign="haRight" ParentFont="false" Text="[Page]"/>
      <TfrxMemoView Name="TODAY" Left="0" Top="8" Width="168" Height="16" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="2" Frame.Typ="4" ParentFont="false" Text="[TODAY]"/>
    </TfrxPageFooter>
    <TfrxReportSummary Name="ReportSummary1" Height="22,67718" Left="0" Top="460" Width="740,409927">
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="128,50402" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text="[Translate('DOC_TOTAL','')]"/>
      <TfrxMemoView Name="Memo10" Left="128,50402" Top="0" Width="498,89796" Height="18,89765" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="false" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo11" Left="627,40198" Top="0" Width="112,3859" Height="18,89765" OnBeforePrint="Memo11OnBeforePrint" Color="16428987" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haRight" ParentFont="false" VAlign="vaCenter" Text=""/>
    </TfrxReportSummary>
    <TfrxGroupHeader Name="GroupHeader1" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="0" Height="32" Left="0" ParentFont="false" Top="124" Visible="false" Width="740,409927" OnBeforePrint="GroupHeader1OnBeforePrint" Condition=".&#34;&#34;">
      <TfrxMemoView Name="Articlecodefou" Left="0" Top="8" Width="740" Height="24" Color="16641775" DataSet="_Article" DataSetName="Article" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="false" Text=""/>
    </TfrxGroupHeader>
    <TfrxGroupHeader Name="GroupHeader2" Height="20" Left="0" Top="176" Visible="false" Width="740,409927" OnBeforePrint="GroupHeader2OnBeforePrint" Condition=".&#34;&#34;">
      <TfrxMemoView Name="Memo12" Left="0" Top="4" Width="740" Height="16" StretchMode="smActualHeight" Color="16641775" DataSet="_Cat" DataSetName="Cat" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="false" Text=""/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter2" Height="20" Left="0" Top="336" Visible="false" Width="740,409927"/>
    <TfrxGroupFooter Name="GroupFooter1" Height="24" Left="0" Top="376" Visible="false" Width="740,409927" OnBeforePrint="GroupFooter1OnBeforePrint">
      <TfrxMemoView Name="Articlecodefou1" Left="0" Top="4" Width="627" Height="16" DataSet="_Article" DataSetName="Article" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="false" Text=""/>
      <TfrxMemoView Name="Memo13" Left="627,4" Top="4" Width="113" Height="16" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="false" Text=""/>
    </TfrxGroupFooter>
    <TfrxGroupHeader Name="GroupHeader3" Height="20" Left="0" Top="216" Visible="false" Width="740,409927" OnBeforePrint="GroupHeader3OnBeforePrint" Condition=".&#34;&#34;">
      <TfrxMemoView Name="Memo14" Left="0" Top="4" Width="740" Height="16" Color="16641775" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="false" Text=""/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter3" Height="20" Left="0" Top="296" Visible="false" Width="740,409927"/>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Inventaire général" Height="454" Left="436" Top="132" Width="510" OnActivate="DialogPage1OnActivate">
    <TfrxGroupBoxControl Name="GroupBox1" Left="12" Top="12" Width="313" Height="221" Caption="Critères de sélection" Color="-16777201">
      <TfrxEditControl Name="Edit1" Left="124" Top="24" Width="145" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxEditControl Name="Edit2" Left="124" Top="52" Width="145" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxComboBoxControl Name="ComboBox1" Left="124" Top="80" Width="169" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
      <TfrxEditControl Name="Edit3" Left="124" Top="108" Width="145" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxLabelControl Name="Label1" Left="4" Top="28" Width="120" Height="13" Alignment="taRightJustify" AutoSize="false" Caption="Article de " Color="-16777201"/>
      <TfrxLabelControl Name="Label2" Left="4" Top="56" Width="120" Height="13" Alignment="taRightJustify" AutoSize="false" Caption=" à " Color="-16777201"/>
      <TfrxLabelControl Name="Label3" Left="4" Top="84" Width="118" Height="13" Alignment="taRightJustify" AutoSize="false" Caption="Catégorie " Color="-16777201"/>
      <TfrxLabelControl Name="Label4" Left="4" Top="112" Width="118" Height="13" Alignment="taRightJustify" AutoSize="false" Caption="Fournisseur principal" Color="-16777201"/>
      <TfrxLabelControl Name="Label5" Left="4" Top="140" Width="118" Height="13" Alignment="taRightJustify" AutoSize="false" Caption="Magasin " Color="-16777201"/>
      <TfrxSpeedButtonControl Name="SpeedButton1" Left="269" Top="24" Width="21" Height="21" GroupIndex="0" Glyph.PropData="04446174610A1604000012040000424D1204000000000000360000002800000011000000130000000100180000000000DC030000C40E0000C40E0000000000000000000088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C100" Layout="blGlyphBottom" OnClick="SpeedButton1OnClick"/>
      <TfrxSpeedButtonControl Name="SpeedButton2" Left="269" Top="52" Width="21" Height="21" GroupIndex="0" Glyph.PropData="04446174610A1604000012040000424D1204000000000000360000002800000011000000130000000100180000000000DC030000C40E0000C40E0000000000000000000088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C100" Layout="blGlyphBottom" OnClick="SpeedButton2OnClick"/>
      <TfrxSpeedButtonControl Name="SpeedButton3" Left="269" Top="108" Width="21" Height="21" GroupIndex="0" Glyph.PropData="04446174610A1604000012040000424D1204000000000000360000002800000011000000130000000100180000000000DC030000C40E0000C40E0000000000000000000088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C100000000000000000000000000000000000000000000000000000000000000000000000000000088B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C10088B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C188B9C100" Layout="blGlyphBottom" OnClick="SpeedButton3OnClick"/>
      <TfrxComboBoxControl Name="ComboBox2" Left="124" Top="136" Width="145" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox2" Left="12" Top="236" Width="157" Height="173" Caption="Critères de tri" Color="-16777201">
      <TfrxEditControl Name="Edit5" Left="4" Top="20" Width="17" Height="21" Enabled="false" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="true"/>
      <TfrxEditControl Name="Edit6" Left="4" Top="48" Width="17" Height="21" Enabled="false" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="true"/>
      <TfrxEditControl Name="Edit7" Left="4" Top="76" Width="17" Height="21" Enabled="false" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxEditControl Name="Edit8" Left="4" Top="132" Width="17" Height="21" Enabled="false" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxCheckBoxControl Name="CheckBox1" Left="24" Top="24" Width="129" Height="17" Caption="Article" Color="-16777201" OnClick="CheckBox1OnClick"/>
      <TfrxCheckBoxControl Name="CheckBox2" Left="24" Top="52" Width="129" Height="17" Caption="Catégories d'articles" Color="-16777201" OnClick="CheckBox1OnClick"/>
      <TfrxCheckBoxControl Name="CheckBox3" Left="24" Top="80" Width="129" Height="17" Caption="Fournisseur principal" Color="-16777201" OnClick="CheckBox1OnClick"/>
      <TfrxCheckBoxControl Name="CheckBox4" Left="24" Top="136" Width="129" Height="17" Caption="Référence fournisseur" Color="-16777201" OnClick="CheckBox1OnClick"/>
      <TfrxEditControl Name="Edit4" Left="4" Top="104" Width="17" Height="21" Enabled="false" Color="-16777211" MaxLength="0" PasswordChar="0"/>
      <TfrxCheckBoxControl Name="CheckBox6" Left="24" Top="108" Width="129" Height="17" Caption="Magasin" Color="-16777201" OnClick="CheckBox1OnClick"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox3" Left="172" Top="236" Width="153" Height="173" Caption="Valorisation" Color="-16777201">
      <TfrxRadioButtonControl Name="RadioButton5" Left="12" Top="20" Width="133" Height="17" Caption="Non valorisé" TabStop="false" Color="-16777201"/>
      <TfrxRadioButtonControl Name="RadioButton6" Left="12" Top="44" Width="133" Height="17" Caption="Prix d'achat" Checked="true" Color="-16777201"/>
      <TfrxRadioButtonControl Name="RadioButton7" Left="12" Top="68" Width="133" Height="17" Caption="Dernier prix de revient" TabStop="false" Color="-16777201"/>
      <TfrxRadioButtonControl Name="RadioButton8" Left="12" Top="92" Width="133" Height="17" Caption="Prix de revient tarif" TabStop="false" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox4" Left="328" Top="12" Width="161" Height="221" Caption="Options inventaire" Color="-16777201">
      <TfrxRadioButtonControl Name="RadioButton10" Left="16" Top="24" Width="141" Height="17" Caption="Stock inférieur à zéro" TabStop="false" Color="-16777201"/>
      <TfrxRadioButtonControl Name="RadioButton11" Left="16" Top="52" Width="141" Height="17" Caption="Tous les articles" Checked="true" Color="-16777201"/>
      <TfrxRadioButtonControl Name="RadioButton12" Left="16" Top="128" Width="141" Height="17" Caption="Stock supérieur à  0" TabStop="false" Color="-16777201"/>
      <TfrxCheckBoxControl Name="CheckBox5" Left="16" Top="156" Width="97" Height="17" Caption="Total seulement" Color="-16777201"/>
      <TfrxRadioButtonControl Name="RadioButton1" Left="16" Top="88" Width="141" Height="17" Caption="Stock sup. ou égal 0" TabStop="false" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxBitBtnControl Name="BitBtn1" Left="376" Top="272" Width="75" Height="25" Glyph.PropData="04446174610AE2010000DE010000424DDE01000000000000760000002800000024000000120000000100040000000000680100000000000000000000100000000000000000000000000080000080000000808000800000008000800080800000C0C0C000808080000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF003333333333333333333333333333333333330000333333333333333333333333F3333333333300003333344333333333333333388F3333333333000033334224333333333333338338F3333333330000333422224333333333333833338F3333333300003342222224333333333383333338F3333333000034222A22224333333338F338F3338F33333300003222A3A2224333333338F3838F338F33333300003A2A333A222433333338F83338F338F33333000033A33333A222433333338333338F338F33330000333333333A222433333333333338F338F33300003333333333A222433333333333338F338F33000033333333333A222433333333333338F338F30000333333333333A222433333333333338F338F00003333333333333A224333333333333338F38F000033333333333333A223333333333333338F830000333333333333333A3333333333333333383300003333333333333333333333333333333333330000" Kind="bkOK" Caption="OK" ModalResult="1" NumGlyphs="2" OnClick="BitBtn1OnClick"/>
    <TfrxBitBtnControl Name="BitBtn2" Left="376" Top="328" Width="75" Height="25" Glyph.PropData="04446174610AE2010000DE010000424DDE01000000000000760000002800000024000000120000000100040000000000680100000000000000000000100000000000000000000000000080000080000000808000800000008000800080800000C0C0C000808080000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00333333333333333333333333333333333333000033338833333333333333333F3333333333330000333911833333983333333388F333333F333300003339111833391183333338F38F333F88F33300003339111183911118333338F338F3F8338F3300003333911118111118333338F3338F833338F3000033333911111111833333338F33383333F8330000333333911111183333333338F333333F833300003333333111118333333333338F3333383333000033333339111183333333333338F33383333300003333339111118333333333333833338F333300003333391118111833333333338333338F333300003333911183911183333333383338F338F333000033339118333911183333338F33838F338F33000033333913333391113333338FF83338F338F300003333333333333919333333388333338FFF83000033333333333333333333333333333338883300003333333333333333333333333333333333330000" Kind="bkCancel" Caption="Annuler" ModalResult="2" NumGlyphs="2"/>
  </TfrxDialogPage>
</TfrxReport>

[I]fr3=1
[C]title=Impression inventaire par magasin
[End of REPORT]
[Record REPORTQRY]
[REPORT=INV PAR MAG       0]
[C]database=DB1
[C]datasource=odbc_mysql
[C]name=DB1
[M]params=31
user name=root
password=test

[C]report=INV PAR MAG
[C]type=D
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       1]
[C]database=DB1
[I]line=1
[C]name=Article
[M]params=225
Select a.code, a.descriptio, a.categorie, a.unite, a.prtarif, a.prcourant, af.pafb, af.codefou, s.local  
From article a left join artfou af on a.codefou=af.codefou and a.code=af.article left join stock s on a.code=s.article
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       2]
[C]database=DB1
[C]datasource=ds_Article
[I]line=2
[C]name=Stock
[M]params=101
Select s.article, sum(s.qte) as qte, s.local
From stock s
Where s.article=:code
Group by s.article
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       3]
[C]database=DB1
[I]line=3
[C]name=Societe
[M]params=25
Select nom 
From societe
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       4]
[C]database=DB1
[I]line=4
[C]name=Categ
[M]params=28
Select descriptio from categ
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       5]
[C]database=DB1
[C]datasource=ds_Article
[I]line=5
[C]name=Fourn
[M]params=49
Select code, nom
From fourn
Where code=:codefou
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       6]
[C]database=DB1
[C]datasource=ds_Article
[I]line=6
[C]name=Cat
[M]params=56
Select code, descriptio from categ where code=:categorie
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
[Record REPORTQRY]
[REPORT=INV PAR MAG       7]
[C]database=DB1
[C]datasource=ds_Article
[I]line=7
[C]name=Local
[M]params=57
Select  code, descriptio
from local
where code = :local
[C]report=INV PAR MAG
[C]type=Q
[End of REPORTQRY]
